<!DOCTYPE html>
<html lang="en" aria-theme="light">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Vitra AI – Herbal Medicine Hub</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet"/>

 <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
   rel="stylesheet"
  />
  <script
    defer
    src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"
  ></script>
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <script defer src="https://kit.fontawesome.com/a2e8f1b6b1.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>


  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


 <style>
   
:root {
  /* --------------------------------------------------
     COLOR PALETTE
     -------------------------------------------------- */
  /* Brand colors */
  --color-primary: #2a6f4e;
  --color-primary-hover: #256443;
  --color-secondary: #8e6c4b;
  --color-secondary-hover: #7a5b42;
  --color-tertiary: #d4c7a2;

  /* Neutral grays */
  --color-gray-100: #f7f7f7;
  --color-gray-200: #ededed;
  --color-gray-300: #dddddd;
  --color-gray-400: #cccccc;
  --color-gray-500: #aaaaaa;
  --color-gray-600: #666666;
  --color-gray-700: #444444;
  --color-gray-800: #2b2b2b;
  --color-gray-900: #1e1e1e;

  /* Semantic */
  --color-success: #3c8d46;
  --color-warning: #d69d1a;
  --color-danger:  #c53030;
  --color-info:    #3182ce;

  /* Background & text */
  --color-bg:      #ffffff;
  --color-bg-alt:  var(--color-gray-100);
  --color-text:    #333333;
  --color-text-muted: #666666;
  --color-border:  var(--color-gray-300);

  /* Toast */
  --toast-bg:     var(--color-primary);
  --toast-text:   #ffffff;

  /* --------------------------------------------------
     SPACING SCALE
     -------------------------------------------------- */
  --spacer-xxs: 0.125rem;  /* 2px */
  --spacer-xs:  0.25rem;   /* 4px */
  --spacer-sm:  0.5rem;    /* 8px */
  --spacer-md:  1rem;      /* 16px */
  --spacer-lg:  1.5rem;    /* 24px */
  --spacer-xl:  2rem;      /* 32px */
  --spacer-xxl:3rem;       /* 48px */


  /* --------------------------------------------------
     TYPOGRAPHY
     -------------------------------------------------- */
  --font-family-sans: 'Montserrat', 'Helvetica Neue', Arial, sans-serif;
  --font-family-mono: 'Courier New', Courier, monospace;

  --font-weight-light: 300;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-bold: 700;

  --font-size-base: 1rem;            /* 16px */
  --font-size-sm:   0.875rem;        /* 14px */
  --font-size-lg:   1.125rem;        /* 18px */
  --font-size-xl:   1.5rem;          /* 24px */
  --font-size-2xl:  2rem;            /* 32px */
  --font-size-3xl:  2.5rem;          /* 40px */

  --line-height-base: 1.5;
  --line-height-heading: 1.2;

  /* --------------------------------------------------
     BORDER & RADIUS
     -------------------------------------------------- */
  --border-width: 1px;
  --border-radius-sm: 0.25rem;  /* 4px */
  --border-radius-md: 0.5rem;   /* 8px */
  --border-radius-lg: 1rem;     /* 16px */
  --border-radius-pill: 50rem;

  /* --------------------------------------------------
     SHADOWS
     -------------------------------------------------- */
  --shadow-xs:  0 1px 2px rgba(0,0,0,0.05);
  --shadow-sm:  0 2px 4px rgba(0,0,0,0.08);
  --shadow-md:  0 4px 8px rgba(0,0,0,0.1);
  --shadow-lg:  0 6px 16px rgba(0,0,0,0.15);
  --shadow-xl:  0 8px 24px rgba(0,0,0,0.2);

  /* --------------------------------------------------
     TRANSITIONS
     -------------------------------------------------- */
  --transition-fast: 0.15s ease-in-out;
  --transition-base: 0.3s ease-in-out;
  --transition-slow: 0.5s ease-in-out;

  /* --------------------------------------------------
     BREAKPOINTS
     -------------------------------------------------- */
  --breakpoint-sm: 480px;
  --breakpoint-md: 768px;
  --breakpoint-lg: 1024px;
  --breakpoint-xl: 1280px;

  /* --------------------------------------------------
     Z-INDEX LAYERS
     -------------------------------------------------- */
  --z-index-dropdown:   1000;
  --z-index-sticky:     1020;
  --z-index-fixed:      1030;
  --z-index-modal-backdrop: 1040;
  --z-index-modal:      1050;
  --z-index-toast:      1060;
  --z-index-tooltip:    1070;
}


/* Dark mode flips */
:root.dark {
  --color-bg:      var(--color-gray-900);
  --color-bg-alt:  var(--color-gray-800);
  --color-text:    #ececec;
  --color-text-muted: #bbbbbb;
  --color-border:  var(--color-gray-700);
  --toast-bg:      var(--color-secondary);
}
/* ---------------------------------------------
   2. GLOBAL RESET & BASE STYLES
   --------------------------------------------- */

/* Box sizing & inherit fonts */
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  font-family: var(--font-family-sans);
  transition: background var(--transition-base), color var(--transition-base), border-color var(--transition-base), box-shadow var(--transition-base);
}

/* Remove default list styles */
ul, ol {
  list-style: none;
}

/* Remove default fieldset & legend styling */
fieldset, legend {
  border: none;
}

/* Reset images and videos */
img, picture, video, canvas, svg {
  display: block;
  max-width: 100%;
  height: auto;
}

/* Anchor link reset */
a {
  color: inherit;
  text-decoration: none;
  cursor: pointer;
}
a:hover, a:focus {
  text-decoration: underline;
}

/* Form elements reset */
button, input, select, textarea {
  font-family: var(--font-family-sans);
  background: none;
  border: none;
  outline: none;
  color: inherit;
}

/* Remove button default styles */
button {
  cursor: pointer;
}
button:disabled {
  cursor: not-allowed;
  opacity: 0.6;
}

/* Base html & body */
html {
  font-size: var(--font-size-base);
  line-height: var(--line-height-base);
  scroll-behavior: smooth;
}
body {
  background-color: var(--color-bg);
  color: var(--color-text);
  min-height: 100vh;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Text selection */
::selection {
  background-color: var(--color-primary);
  color: #fff;
}

/* Headings */
h1, h2, h3, h4, h5, h6 {
  color: var(--color-text);
  line-height: var(--line-height-heading);
  margin-bottom: var(--spacer-md);
  font-weight: var(--font-weight-bold);
}
h1 { font-size: var(--font-size-3xl); }
h2 { font-size: var(--font-size-2xl); }
h3 { font-size: var(--font-size-xl); }
h4 { font-size: var(--font-size-lg); }
h5 { font-size: var(--font-size-base); }
h6 { font-size: var(--font-size-sm); }

/* Paragraphs */
p {
  margin-bottom: var(--spacer-md);
  line-height: var(--line-height-base);
}

/* Utility classes */
.hidden { display: none !important; }
.sr-only {
  position: absolute; width: 1px; height: 1px;
  padding: 0; margin: -1px; overflow: hidden;
  clip: rect(0,0,0,0); white-space: nowrap; border: 0;
}
.text-center { text-align: center !important; }
.text-right  { text-align: right  !important; }
.text-left   { text-align: left   !important; }

/* Containers */
.container {
  width: 100%;
  max-width: var(--breakpoint-xl);
  margin-inline: auto;
  padding-inline: var(--spacer-md);
}

.mt-xs { margin-top: var(--spacer-xs) !important; }
.mt-sm { margin-top: var(--spacer-sm) !important; }
.mt-md { margin-top: var(--spacer-md) !important; }
.mt-lg { margin-top: var(--spacer-lg) !important; }
.mt-xl { margin-top: var(--spacer-xl) !important; }

.mb-xs { margin-bottom: var(--spacer-xs) !important; }
.mb-sm { margin-bottom: var(--spacer-sm) !important; }
.mb-md { margin-bottom: var(--spacer-md) !important; }
.mb-lg { margin-bottom: var(--spacer-lg) !important; }
.mb-xl { margin-bottom: var(--spacer-xl) !important; }

.flex { display: flex !important; }
.inline-flex { display: inline-flex !important; }
.items-center { align-items: center !important; }
.justify-center { justify-content: center !important; }
.gap-xs { gap: var(--spacer-xs) !important; }
.gap-sm { gap: var(--spacer-sm) !important; }
.gap-md { gap: var(--spacer-md) !important; }
.gap-lg { gap: var(--spacer-lg) !important; }

.btn-link {
  background: none;
  border: none;
  color: var(--color-primary);
  padding: 0;
  font-weight: var(--font-weight-medium);
}
.btn-link:hover {
  color: var(--color-primary-hover);
  text-decoration: underline;
}

aside#sidebar {
  position: fixed;
  top: 0; left: 0; bottom: 0;
  width: 250px;
  background-color: var(--color-bg-alt);
  border-right: var(--border-width) solid var(--color-border);
  padding: var(--spacer-lg) 0;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  box-shadow: var(--shadow-sm);
  transition: width var(--transition-base), transform var(--transition-base);
  z-index: var(--z-index-fixed);
}

aside#sidebar.collapsed {
  width: 80px;
}

/* Logo area */
aside#sidebar .logo {
  display: flex;
  align-items: center;
  gap: var(--spacer-sm);
  padding: 0 var(--spacer-lg);
}
aside#sidebar .logo svg {
  width: 2rem;
  height: 2rem;
  fill: var(--color-primary);
  transition: transform var(--transition-base), fill var(--transition-base);
}
aside#sidebar .logo:hover svg {
  transform: rotate(-10deg) scale(1.1);
}
aside#sidebar .logo-text {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-bold);
  color: var(--color-text);
  white-space: nowrap;
}
aside#sidebar.collapsed .logo-text {
  display: none;
}

/* Nav links */
aside#sidebar nav {
  margin-top: var(--spacer-xl);
  display: flex;
  flex-direction: column;
}
aside#sidebar nav a {
  display: flex;
  align-items: center;
  gap: var(--spacer-sm);
  padding: var(--spacer-sm) var(--spacer-lg);
  color: var(--color-text-muted);
  font-size: var(--font-size-base);
  border-left: var(--border-width) solid transparent;
  transition: background var(--transition-fast), border-color var(--transition-fast), color var(--transition-fast);
}
aside#sidebar nav a:hover,
aside#sidebar nav a.active {
  background-color: var(--color-gray-200);
  border-color: var(--color-primary);
  color: var(--color-text);
}
aside#sidebar nav a i {
  font-size: 1.25rem;
}
aside#sidebar.collapsed nav a {
  justify-content: center;
}
aside#sidebar.collapsed nav a span {
  display: none;
}

/* Collapsed tooltips */
aside#sidebar.collapsed nav a {
  position: relative;
}
aside#sidebar.collapsed nav a::after {
  content: attr(aria-label);
  position: absolute;
  left: 100%;
  top: 50%;
  transform: translateY(-50%);
  background-color: var(--color-bg);
  color: var(--color-text);
  padding: var(--spacer-xs) var(--spacer-sm);
  border-radius: var(--border-radius-sm);
  box-shadow: var(--shadow-sm);
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity var(--transition-fast);
}
aside#sidebar.collapsed nav a:hover::after {
  opacity: 1;
}
aside#sidebar.collapsed ~ main {
  margin-left: 80px;
}

   #shrinkBtn {
  background: none;
  border: none;
  font-size: 1.5rem;
  color: var(--color-text-muted);
  padding: var(--spacer-sm);
  align-self: center;
  transition: color var(--transition-fast), transform var(--transition-fast);
}
#shrinkBtn:hover {
  color: var(--color-text);
  transform: scale(1.1);
}
#shrinkBtn i {
  transition: transform var(--transition-base);
}
aside#sidebar.collapsed #shrinkBtn i {
  transform: rotate(180deg);
}


header {
  position: fixed;
  top: 0;
  left: 250px;
  right: 0;
  height: 60px;
  background-color: var(--color-bg);
  border-bottom: var(--border-width) solid var(--color-border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--spacer-lg);
  box-shadow: var(--shadow-xs);
  transition: left var(--transition-base), background var(--transition-base);
  z-index: var(--z-index-sticky);
}

header h1 {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
}

.hamburger {
  display: none;
  font-size: 1.5rem;
  color: var(--color-text-muted);
  cursor: pointer;
  transition: color var(--transition-base), transform var(--transition-base);
}
.hamburger:hover {
  color: var(--color-text);
  transform: scale(1.1);
}

.theme-toggle {
  font-size: 1.5rem;
  color: var(--color-text-muted);
  cursor: pointer;
  transition: color var(--transition-base), transform var(--transition-base);
}
.theme-toggle:hover {
  color: var(--color-secondary);
  transform: rotate(20deg);
}
.theme-toggle.fa-sun {
  color: var(--color-secondary);
}
main {
  margin-left: 250px;
  transition: margin-left var(--transition-base);
}

   @media (max-width: var(--breakpoint-lg)) {
  .hamburger {
    display: inline-block;
  }
  header {
    left: 0;
  }
  aside#sidebar {
    transform: translateX(-100%);
  }
  aside#sidebar.open {
    transform: translateX(0);
  }
}
section.module.hero-module {
  position: relative;
  background-color: var(--color-bg-alt);
  padding: var(--spacer-xxl) var(--spacer-lg);
  overflow: hidden;
}

.hero-inner {
  display: flex;
  align-items: center;
  justify-content: space-between;
  max-width: var(--breakpoint-xl);
  margin: 0 auto;
  gap: var(--spacer-lg);
}

.hero-content {
  flex: 1;
  z-index: 2;
}

.hero-content h1 {
  font-size: var(--font-size-3xl);
  font-weight: var(--font-weight-bold);
  color: var(--color-primary);
  margin-bottom: var(--spacer-md);
  display: flex;
  align-items: center;
  gap: var(--spacer-sm);
}

.hero-content .hero-subtitle {
  font-size: var(--font-size-lg);
  color: var(--color-text-muted);
  margin-bottom: var(--spacer-lg);
  line-height: var(--line-height-base);
}

.hero-actions {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacer-sm);
}

.hero-actions .btn-primary,
.hero-actions .btn-secondary,
.hero-actions .btn-tertiary {
  display: inline-flex;
  align-items: center;
  gap: var(--spacer-xs);
  padding: var(--spacer-sm) var(--spacer-md);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-medium);
  border-radius: var(--border-radius-pill);
  border: var(--border-width) solid transparent;
  cursor: pointer;
  transition: background var(--transition-fast), color var(--transition-fast), transform var(--transition-base);
}

.btn-primary {
  background-color: var(--color-primary);
  color: #fff;
}
.btn-primary:hover {
  background-color: var(--color-primary-hover);
  transform: translateY(-2px);
}

.btn-secondary {
  background-color: var(--color-secondary);
  color: #fff;
}
.btn-secondary:hover {
  background-color: var(--color-secondary-hover);
  transform: translateY(-2px);
}

.btn-tertiary {
  background-color: transparent;
  color: var(--color-primary);
  border-color: var(--color-primary);
}
.btn-tertiary:hover {
  background-color: var(--color-primary);
  color: #fff;
}

/* Hero image styling */
.hero-image {
  flex: 1;
  text-align: center;
  z-index: 2;
}
.hero-image img {
  max-width: 100%;
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-lg);
  transition: transform var(--transition-base);
}
.hero-image img:hover {
  transform: scale(1.02);
}

/* Decorative background icons */
.hero-bg-icon {
  position: absolute;
  font-size: 4rem;
  color: var(--color-primary);
  opacity: 0.1;
  pointer-events: none;
  transition: opacity var(--transition-base), transform var(--transition-base);
}
.hero-bg-icon:hover {
  opacity: 0.2;
  transform: scale(1.1);
}

/* Specific icon placements */
.hero-bg-icon.fa-seedling  { top: 8%;  left: 7%; }
.hero-bg-icon.fa-leaf      { top: 5%;  right: 9%; }
.hero-bg-icon.fa-flask     { bottom: 10%; left: 12%; }
.hero-bg-icon.fa-stethoscope { bottom: 8%; right: 15%; }
.hero-bg-icon.fa-chart-line  { top: 45%; left: 45%; }

/* Responsive adjustments */
@media (max-width: var(--breakpoint-md)) {
  .hero-inner {
    flex-direction: column-reverse;
    text-align: center;
  }
  .hero-content h1 {
    font-size: var(--font-size-2xl);
    justify-content: center;
  }
  .hero-content .hero-subtitle {
    font-size: var(--font-size-base);
  }
  .hero-bg-icon {
    font-size: 3rem;
  }
}
/* ---------------------------------------------
   5. MODULE STYLES: AI Plant Scanner
   --------------------------------------------- */
#hero–identifier {
  background-color: var(--color-gray-100);
  border-top: 4px solid var(--color-primary);
  padding: var(--spacer-xxl) var(--spacer-lg);
  position: relative;
  overflow: hidden;
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-sm);
  margin-top: var(--spacer-xl);
}

#hero–identifier::before {
  content: '\f06e';
  font-family: 'Font Awesome 6 Free';
  font-weight: 900;
  position: absolute;
  font-size: 8rem;
  color: var(--color-primary);
  opacity: 0.05;
  bottom: -1rem;
  left: -2rem;
}

#hero–identifier h2 {
  display: flex;
  align-items: center;
  gap: var(--spacer-sm);
  font-size: var(--font-size-2xl);
  color: var(--color-primary);
  margin-bottom: var(--spacer-md);
}

#hero–identifier .desc {
  color: var(--color-text-muted);
  margin-bottom: var(--spacer-lg);
  font-size: var(--font-size-base);
}

/* Form wrapper */
#iden-form {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: var(--spacer-md);
  background: #fff;
  padding: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
}

/* Textarea & file input */
#iden-form textarea,
#iden-form input[type="file"] {
  width: 100%;
  padding: var(--spacer-sm);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--border-radius-pill);
  resize: vertical;
  font-size: var(--font-size-base);
  line-height: var(--line-height-base);
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
}

#iden-form textarea:focus,
#iden-form input[type="file"]:focus {
  border-color: var(--color-primary);
  box-shadow: var(--shadow-sm);
}

/* Submit button */
#iden-form button[type="submit"] {
  background-color: var(--color-secondary);
  color: #fff;
  border: none;
  padding: var(--spacer-sm) var(--spacer-lg);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-medium);
  border-radius: var(--border-radius-pill);
  box-shadow: var(--shadow-sm);
  transition: background var(--transition-fast), transform var(--transition-fast);
}
#iden-form button[type="submit"]:hover {
  background-color: var(--color-secondary-hover);
  transform: translateY(-2px);
}

/* Hint text */
#hero–identifier .hint {
  grid-column: 1 / -1;
  font-size: var(--font-size-sm);
  color: var(--color-text-muted);
}

/* Preview image */
#idenPreview {
  grid-column: 1 / -1;
  max-width: 200px;
  margin-top: var(--spacer-sm);
  border-radius: var(--border-radius-md);
  border: var(--border-width) solid var(--color-secondary);
  box-shadow: var(--shadow-xs);
}

/* Clear link */
#idenClear a {
  color: var(--color-secondary);
  font-size: var(--font-size-sm);
  text-decoration: underline;
}
#idenClear a:hover {
  color: var(--color-secondary-hover);
}

/* Result panel */
#idenResult {
  grid-column: 1 / -1;
  background: #fff;
  padding: var(--spacer-lg);
  margin-top: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-sm);
  position: relative;
}

#idenResult .close-btn {
  position: absolute;
  top: var(--spacer-sm);
  right: var(--spacer-sm);
  background: none;
  font-size: 1.25rem;
  color: var(--color-text-muted);
  cursor: pointer;
}
#idenResult .close-btn:hover {
  color: var(--color-primary);
}

#idenResult .result-content {
  font-size: var(--font-size-base);
  line-height: var(--line-height-base);
  color: var(--color-text);
}

/* Tool row buttons */
#idenResult .tool-row {
  margin-top: var(--spacer-md);
  display: flex;
  gap: var(--spacer-sm);
}
#idenResult .tool-row button {
  width: 2.5rem; height: 2.5rem;
  border: none;
  border-radius: var(--border-radius-pill);
  background: var(--color-secondary);
  color: #fff;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 1rem;
  box-shadow: var(--shadow-xs);
  transition: background var(--transition-fast), transform var(--transition-fast);
}
#idenResult .tool-row button:hover {
  background: var(--color-secondary-hover);
  transform: scale(1.1);
}

/* Dark-mode overrides */
:root.dark #iden-form,
:root.dark #idenResult {
  background: var(--color-gray-800);
}
:root.dark #iden-form textarea,
:root.dark #iden-form input[type="file"] {
  background: var(--color-gray-900);
  border-color: var(--color-gray-700);
  color: var(--color-text);
}
:root.dark #idenResult .result-content {
  color: var(--color-text);
}

/* Responsive */
@media (max-width: var(--breakpoint-md)) {
  #iden-form {
    grid-template-columns: 1fr;
  }
  #iden-form button[type="submit"] {
    width: 100%;
  }
}
/* ---------------------------------------------
   5.2 MODULE STYLES: Symptom Checker
   --------------------------------------------- */
#hero-symptom {
  background-color: var(--color-gray-100);
  border-top: 4px solid var(--color-secondary);
  padding: var(--spacer-xxl) var(--spacer-lg);
  position: relative;
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-sm);
  margin-top: var(--spacer-xl);
}

#hero-symptom::before {
  content: '\f3c5';
  font-family: 'Font Awesome 6 Free';
  font-weight: 900;
  position: absolute;
  font-size: 8rem;
  color: var(--color-secondary);
  opacity: 0.05;
  top: 1rem;
  left: 1rem;
}

#hero-symptom h2 {
  display: flex;
  align-items: center;
  gap: var(--spacer-sm);
  font-size: var(--font-size-2xl);
  color: var(--color-secondary);
  margin-bottom: var(--spacer-md);
}

#hero-symptom .desc {
  color: var(--color-text-muted);
  margin-bottom: var(--spacer-lg);
  font-size: var(--font-size-base);
}

/* Symptom form wrapper */
.sym-form {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: var(--spacer-lg);
  background: #fff;
  padding: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
}

/* Field labels */
.sym-form .field label {
  font-weight: var(--font-weight-medium);
  margin-bottom: var(--spacer-xs);
  color: var(--color-text);
}

/* Textarea, select, number input */
.sym-form textarea,
.sym-form select,
.sym-form input[type="number"] {
  width: 100%;
  padding: var(--spacer-sm) var(--spacer-md);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--border-radius-pill);
  font-size: var(--font-size-base);
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
}

.sym-form textarea:focus,
.sym-form select:focus,
.sym-form input[type="number"]:focus {
  border-color: var(--color-secondary);
  box-shadow: var(--shadow-sm);
}

/* Severity slider */
.range-field {
  position: relative;
}
.range-field input[type="range"] {
  width: 100%;
  accent-color: var(--color-secondary);
}
.range-field #sevValue {
  position: absolute;
  top: 50%;
  right: var(--spacer-sm);
  transform: translateY(-50%);
  font-weight: var(--font-weight-bold);
  color: var(--color-secondary);
}

/* “Other” text input */
.other-input {
  display: none;
  width: 100%;
  padding: var(--spacer-sm) var(--spacer-md);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--border-radius-pill);
  margin-top: var(--spacer-xs);
}

/* Submit button */
.sym-form button[type="submit"] {
  grid-column: 1 / -1;
  justify-self: start;
  background-color: var(--color-secondary);
  color: #fff;
  padding: var(--spacer-sm) var(--spacer-xl);
  border: none;
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-medium);
  border-radius: var(--border-radius-pill);
  box-shadow: var(--shadow-sm);
  transition: background var(--transition-fast), transform var(--transition-fast);
}
.sym-form button[type="submit"]:hover {
  background-color: var(--color-secondary-hover);
  transform: translateY(-2px);
}

/* Response panel */
.sym-response {
  background: #fff;
  padding: var(--spacer-lg);
  margin-top: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
  position: relative;
}

.sym-response .close-btn {
  position: absolute;
  top: var(--spacer-sm);
  right: var(--spacer-sm);
  background: none;
  font-size: 1.25rem;
  color: var(--color-text-muted);
  cursor: pointer;
}
.sym-response .close-btn:hover {
  color: var(--color-secondary);
}

.sym-response .result-content {
  font-size: var(--font-size-base);
  color: var(--color-text);
  line-height: var(--line-height-base);
}

/* Tool row */
.sym-response .tool-row {
  margin-top: var(--spacer-md);
  display: flex;
  gap: var(--spacer-sm);
}
.sym-response .tool-row button {
  width: 2.5rem; height: 2.5rem;
  border: none;
  border-radius: var(--border-radius-pill);
  background: var(--color-secondary);
  color: #fff;
  display: inline-flex; align-items: center; justify-content: center;
  transition: background var(--transition-fast), transform var(--transition-fast);
}
.sym-response .tool-row button:hover {
  background: var(--color-secondary-hover);
  transform: scale(1.1);
}

/* Dark mode overrides */
:root.dark .sym-form,
:root.dark .sym-response {
  background: var(--color-gray-800);
}
:root.dark .sym-form textarea,
:root.dark .sym-form select,
:root.dark .sym-form input[type="number"] {
  background: var(--color-gray-900);
  border-color: var(--color-gray-700);
  color: var(--color-text);
}
:root.dark .sym-response .result-content {
  color: var(--color-text);
}

/* Responsive */
@media (max-width: var(--breakpoint-md)) {
  .sym-form {
    grid-template-columns: 1fr;
  }
  .sym-form button[type="submit"] {
    width: 100%;
  }
}
/* ---------------------------------------------
   5.3 MODULE STYLES: Cultural Knowledge
   --------------------------------------------- */
#hero–cultural {
  background-color: var(--color-gray-100);
  border-top: 4px solid var(--color-secondary);
  padding: var(--spacer-xxl) var(--spacer-lg);
  position: relative;
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-sm);
  margin-top: var(--spacer-xl);
}

#hero–cultural::before {
  content: '\f2e8';
  font-family: 'Font Awesome 6 Free';
  font-weight: 900;
  position: absolute;
  font-size: 8rem;
  color: var(--color-secondary);
  opacity: 0.05;
  bottom: 0;
  right: var(--spacer-lg);
}

#hero–cultural h2 {
  display: flex;
  align-items: center;
  gap: var(--spacer-sm);
  font-size: var(--font-size-2xl);
  color: var(--color-secondary);
  margin-bottom: var(--spacer-md);
}

#hero–cultural .desc {
  color: var(--color-text-muted);
  margin-bottom: var(--spacer-lg);
  font-size: var(--font-size-base);
}

/* Input wrapper */
.culture-input-wrapper {
  display: flex;
  max-width: 700px;
  background: #fff;
  border-radius: var(--border-radius-md);
  overflow: hidden;
  box-shadow: var(--shadow-xs);
}

.culture-input-wrapper input[type="text"] {
  flex: 1;
  padding: var(--spacer-sm) var(--spacer-md);
  border: var(--border-width) solid var(--color-border);
  font-size: var(--font-size-base);
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
}

.culture-input-wrapper input[type="text"]:focus {
  border-color: var(--color-secondary);
  box-shadow: var(--shadow-sm);
}

.culture-input-wrapper .btn-culture {
  background-color: var(--color-secondary);
  color: #fff;
  border: none;
  padding: var(--spacer-sm) var(--spacer-xl);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-medium);
  border-radius: 0 var(--border-radius-md) var(--border-radius-md) 0;
  box-shadow: var(--shadow-xs);
  transition: background var(--transition-fast), transform var(--transition-fast);
}

.culture-input-wrapper .btn-culture:hover {
  background-color: var(--color-secondary-hover);
  transform: translateY(-2px);
}

/* Result panel */
#cultureResult {
  background: #fff;
  padding: var(--spacer-lg);
  margin-top: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
  position: relative;
}

#cultureResult .close-btn {
  position: absolute;
  top: var(--spacer-sm);
  right: var(--spacer-sm);
  background: none;
  font-size: 1.25rem;
  color: var(--color-text-muted);
  cursor: pointer;
}
#cultureResult .close-btn:hover {
  color: var(--color-secondary);
}

#cultureResult .result-content {
  font-size: var(--font-size-base);
  color: var(--color-text);
  line-height: var(--line-height-base);
}

/* Dark mode overrides */
:root.dark .culture-input-wrapper,
:root.dark #cultureResult {
  background: var(--color-gray-800);
}
:root.dark .culture-input-wrapper input[type="text"] {
  background: var(--color-gray-900);
  border-color: var(--color-gray-700);
  color: var(--color-text);
}
:root.dark #cultureResult .result-content {
  color: var(--color-text);
}

/* Responsive */
@media (max-width: var(--breakpoint-md)) {
  .culture-input-wrapper {
    flex-direction: column;
  }
  .culture-input-wrapper .btn-culture,
  .culture-input-wrapper input[type="text"] {
    width: 100%;
    border-radius: var(--border-radius-md);
  }
}
#hero–safety {
  background-color: var(--color-gray-100);
  border-top: 4px solid var(--color-primary);
  padding: var(--spacer-xxl) var(--spacer-lg);
  position: relative;
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-sm);
  margin-top: var(--spacer-xl);
}

#hero–safety::before {
  content: '\f shield-alt';
  content: '\f3ed';
  font-family: 'Font Awesome 6 Free';
  font-weight: 900;
  position: absolute;
  font-size: 8rem;
  color: var(--color-primary);
  opacity: 0.05;
  top: -1rem;
  right: 1rem;
}

#hero–safety h2 {
  display: flex;
  align-items: center;
  gap: var(--spacer-sm);
  font-size: var(--font-size-2xl);
  color: var(--color-primary);
  margin-bottom: var(--spacer-md);
}

#hero–safety .desc {
  color: var(--color-text-muted);
  margin-bottom: var(--spacer-lg);
  font-size: var(--font-size-base);
}

/* Form wrapper */
#safety-form {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)) auto;
  gap: var(--spacer-sm);
  background: #fff;
  padding: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
  align-items: end;
}

/* Input fields */
#safety-form input {
  width: 100%;
  padding: var(--spacer-sm) var(--spacer-md);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--border-radius-pill);
  font-size: var(--font-size-base);
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
}
#safety-form input:focus {
  border-color: var(--color-primary);
  box-shadow: var(--shadow-sm);
}

/* Submit button */
#safety-form button[type="submit"] {
  background-color: var(--color-primary);
  color: #fff;
  border: none;
  padding: var(--spacer-sm) var(--spacer-xl);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-medium);
  border-radius: var(--border-radius-pill);
  box-shadow: var(--shadow-sm);
  transition: background var(--transition-fast), transform var(--transition-fast);
}
#safety-form button[type="submit"]:hover {
  background-color: var(--color-primary-hover);
  transform: translateY(-2px);
}

/* Hint text */
#hero–safety .hint {
  grid-column: 1 / -1;
  font-size: var(--font-size-sm);
  color: var(--color-text-muted);
}

/* Result panel */
#safetyResult {
  background: #fff;
  padding: var(--spacer-lg);
  margin-top: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
  position: relative;
}

#safetyResult .close-btn {
  position: absolute;
  top: var(--spacer-sm);
  right: var(--spacer-sm);
  background: none;
  font-size: 1.25rem;
  color: var(--color-text-muted);
  cursor: pointer;
}
#safetyResult .close-btn:hover {
  color: var(--color-primary);
}

#safetyResult .result-content {
  font-size: var(--font-size-base);
  color: var(--color-text);
  line-height: var(--line-height-base);
}

/* Tool row */
#safetyResult .tool-row {
  margin-top: var(--spacer-md);
  display: flex;
  gap: var(--spacer-sm);
}
#safetyResult .tool-row button {
  width: 2.5rem; height: 2.5rem;
  border: none;
  border-radius: var(--border-radius-pill);
  background: var(--color-secondary);
  color: #fff;
  display: inline-flex; align-items: center; justify-content: center;
  transition: background var(--transition-fast), transform var(--transition-fast);
}
#safetyResult .tool-row button:hover {
  background: var(--color-secondary-hover);
  transform: scale(1.1);
}

/* Dark mode overrides */
:root.dark #safety-form,
:root.dark #safetyResult {
  background: var(--color-gray-800);
}
:root.dark #safety-form input {
  background: var(--color-gray-900);
  border-color: var(--color-gray-700);
  color: var(--color-text);
}
:root.dark #safetyResult .result-content {
  color: var(--color-text);
}

/* Responsive */
@media (max-width: var(--breakpoint-md)) {
  #safety-form {
    grid-template-columns: 1fr;
  }
  #safety-form button[type="submit"] {
    width: 100%;
  }
}
#hero–chat {
  background-color: var(--color-gray-100);
  border-top: 4px solid var(--color-secondary);
  padding: var(--spacer-xxl) var(--spacer-lg);
  position: relative;
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-sm);
  margin-top: var(--spacer-xl);
  display: flex;
  flex-direction: column;
  gap: var(--spacer-md);
}

#hero–chat > .chat-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

#hero–chat h2 {
  font-size: var(--font-size-2xl);
  color: var(--color-secondary);
  display: flex;
  align-items: center;
  gap: var(--spacer-sm);
}

.chat-controls button {
  background: none;
  border: none;
  color: var(--color-text-muted);
  font-size: 1.25rem;
  margin-left: var(--spacer-sm);
  cursor: pointer;
  transition: color var(--transition-fast), transform var(--transition-fast);
}
.chat-controls button:hover {
  color: var(--color-secondary);
  transform: scale(1.1);
}

/* Chat box */
.chat-box {
  background-color: #ffffff;
  border-radius: var(--border-radius-md);
  padding: var(--spacer-md);
  height: 300px;
  overflow-y: auto;
  box-shadow: inset 0 2px 6px rgba(0,0,0,0.05);
  display: flex;
  flex-direction: column;
  gap: var(--spacer-sm);
}

/* Message bubbles */
.chat-box .user-msg,
.chat-box .bot-msg {
  max-width: 75%;
  padding: var(--spacer-sm) var(--spacer-md);
  position: relative;
  line-height: var(--line-height-base);
}

.chat-box .bot-msg {
  align-self: flex-start;
  background-color: var(--color-bg);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--border-radius-md) var(--border-radius-md) var(--border-radius-md) 0;
  color: var(--color-text);
}

.chat-box .user-msg {
  align-self: flex-end;
  background-color: var(--color-secondary);
  color: #fff;
  border-radius: var(--border-radius-md) var(--border-radius-md) 0 var(--border-radius-md);
}

/* Timestamps */
.chat-box .timestamp {
  font-size: var(--font-size-sm);
  color: var(--color-text-muted);
  position: absolute;
  bottom: -1.2rem;
  right: var(--spacer-sm);
}

/* Input row */
.chat-input-row {
  display: flex;
  gap: var(--spacer-sm);
}
.chat-input-row input {
  flex: 1;
  padding: var(--spacer-sm) var(--spacer-md);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--border-radius-pill);
  font-size: var(--font-size-base);
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
}
.chat-input-row input:focus {
  border-color: var(--color-secondary);
  box-shadow: var(--shadow-sm);
}
.chat-input-row button {
  background-color: var(--color-secondary);
  border: none;
  border-radius: var(--border-radius-pill);
  width: 3rem; height: 3rem;
  display: flex; align-items: center; justify-content: center;
  color: #fff;
  font-size: 1.25rem;
  box-shadow: var(--shadow-sm);
  transition: transform var(--transition-fast), background var(--transition-fast);
}
.chat-input-row button:hover {
  transform: scale(1.1);
  background-color: var(--color-secondary-hover);
}

/* ---------------------------------------------
   5.6 MODULE STYLES: Chat History Modal
   --------------------------------------------- */
.history-modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: var(--z-index-modal-backdrop);
}
.history-content {
  background-color: var(--color-bg);
  padding: var(--spacer-xl);
  border-radius: var(--border-radius-lg);
  width: 90%;
  max-width: 600px;
  max-height: 80%;
  overflow-y: auto;
  box-shadow: var(--shadow-lg);
  position: relative;
  z-index: var(--z-index-modal);
}
.history-content h3 {
  margin-top: 0;
  color: var(--color-secondary);
  font-size: var(--font-size-xl);
  margin-bottom: var(--spacer-md);
}

/* History table (borderless look) */
.history-table {
  width: 100%;
  border-collapse: collapse;
}
.history-table thead tr {
  background: transparent;
}
.history-table thead th {
  text-align: left;
  font-weight: var(--font-weight-medium);
  padding: var(--spacer-xs) var(--spacer-sm);
  color: var(--color-text-muted);
}
.history-table tbody tr {
  border-bottom: none;
}
.history-table tbody td {
  padding: var(--spacer-xs) var(--spacer-sm);
  color: var(--color-text);
}
.history-table tbody tr:nth-child(even) {
  background-color: var(--color-gray-100);
}

/* Delete & Clear buttons */
.history-actions {
  display: flex;
  justify-content: flex-end;
  gap: var(--spacer-sm);
  margin-top: var(--spacer-md);
}
.history-actions button {
  padding: var(--spacer-sm) var(--spacer-md);
  font-size: var(--font-size-sm);
  border: none;
  border-radius: var(--border-radius-pill);
  cursor: pointer;
  transition: background var(--transition-fast), transform var(--transition-fast);
}
.history-actions .clear-history {
  background-color: var(--color-danger);
  color: #fff;
}
.history-actions .clear-history:hover {
  background-color: darken(var(--color-danger), 10%);
  transform: translateY(-1px);
}
.history-actions .close-history {
  background-color: var(--color-border);
}
.history-actions .close-history:hover {
  background-color: var(--color-gray-400);
  transform: translateY(-1px);
}

/* Dark-mode overrides */
:root.dark .history-content {
  background-color: var(--color-gray-800);
}
:root.dark .history-table tbody tr:nth-child(even) {
  background-color: var(--color-gray-700);
}
#formulations {
  background-color: var(--color-gray-100);
  border-top: 4px solid var(--color-primary);
  padding: var(--spacer-xxl) var(--spacer-lg);
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-sm);
  margin-top: var(--spacer-xl);
}
#formulations h2 {
  color: var(--color-primary);
}
#formulations .desc {
  color: var(--color-text-muted);
  margin-bottom: var(--spacer-lg);
}
#pf-form {
  display: grid;
  gap: var(--spacer-md);
  background: #fff;
  padding: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
}
#pf-form select,
#pf-form input[type="number"],
#pf-form input[type="text"] {
  padding: var(--spacer-sm) var(--spacer-md);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--border-radius-pill);
  font-size: var(--font-size-base);
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
}
#pf-form select:focus,
#pf-form input:focus {
  border-color: var(--color-primary);
  box-shadow: var(--shadow-sm);
}
#pf-form button[type="submit"] {
  background: var(--color-primary);
  color: #fff;
  padding: var(--spacer-sm) var(--spacer-xl);
  border-radius: var(--border-radius-pill);
  box-shadow: var(--shadow-sm);
  transition: background var(--transition-fast), transform var(--transition-fast);
}
#pf-form button:hover {
  background: var(--color-primary-hover);
  transform: translateY(-2px);
}
#pfResult {
  background: #fff;
  padding: var(--spacer-lg);
  margin-top: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
  position: relative;
}
#pfResult .result-content { color: var(--color-text); }
#pfResult .hint { font-size: var(--font-size-sm); color: var(--color-text-muted); }

#research {
  background-color: var(--color-gray-100);
  border-top: 4px solid var(--color-secondary);
  padding: var(--spacer-xxl) var(--spacer-lg);
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-sm);
  margin-top: var(--spacer-xl);
}
#research h2 { color: var(--color-secondary); }
#research .desc { color: var(--color-text-muted); margin-bottom: var(--spacer-lg); }
#research-form {
  display: flex;
  gap: var(--spacer-sm);
  background: #fff;
  padding: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
}
#research-form input {
  flex: 1;
  padding: var(--spacer-sm) var(--spacer-md);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--border-radius-pill);
}
#research-form button {
  background: var(--color-secondary);
  color: #fff;
  padding: var(--spacer-sm) var(--spacer-xl);
  border-radius: var(--border-radius-pill);
  box-shadow: var(--shadow-sm);
}
#researchResults {
  background: #fff;
  padding: var(--spacer-lg);
  margin-top: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
}

#inventory {
  background-color: var(--color-gray-100);
  border-top: 4px solid var(--color-primary);
  padding: var(--spacer-xxl) var(--spacer-lg);
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-sm);
  margin-top: var(--spacer-xl);
}
#inventory h2 { color: var(--color-primary); }
#inventory .desc { color: var(--color-text-muted); margin-bottom: var(--spacer-lg); }
#inventory-form {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacer-sm);
  background: #fff;
  padding: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
  align-items: center;
}
#inventory-form select,
#inventory-form input {
  padding: var(--spacer-sm) var(--spacer-md);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--border-radius-pill);
}
#inventory-form button {
  background: var(--color-primary);
  color: #fff;
  padding: var(--spacer-sm) var(--spacer-xl);
  border-radius: var(--border-radius-pill);
  box-shadow: var(--shadow-sm);
}
#inventoryResult {
  background: #fff;
  padding: var(--spacer-lg);
  margin-top: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
}

#genetics {
  background-color: var(--color-gray-100);
  border-top: 4px solid var(--color-secondary);
  padding: var(--spacer-xxl) var(--spacer-lg);
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-sm);
  margin-top: var(--spacer-xl);
}
#genetics h2 { color: var(--color-secondary); }
#genetics .desc { color: var(--color-text-muted); margin-bottom: var(--spacer-lg); }
#genetics-form {
  display: flex;
  gap: var(--spacer-sm);
  background: #fff;
  padding: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
}
#genetics-form input[type="file"] {
  padding: var(--spacer-sm);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--border-radius-pill);
}
#geneticResult {
  background: #fff;
  padding: var(--spacer-lg);
  margin-top: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
}

#dosage {
  background-color: var(--color-gray-100);
  border-top: 4px solid var(--color-primary);
  padding: var(--spacer-xxl) var(--spacer-lg);
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-sm);
  margin-top: var(--spacer-xl);
}
#dosage h2 { color: var(--color-primary); }
#dosage .desc { color: var(--color-text-muted); margin-bottom: var(--spacer-lg); }
#dose-form {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacer-sm);
  background: #fff;
  padding: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
}
#dose-form input, #dose-form select {
  padding: var(--spacer-sm) var(--spacer-md);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--border-radius-pill);
}
#dose-form button {
  background: var(--color-secondary);
  color: #fff;
  padding: var(--spacer-sm) var(--spacer-xl);
  border-radius: var(--border-radius-pill);
  box-shadow: var(--shadow-sm);
}
#dosageResult {
  background: #fff;
  padding: var(--spacer-lg);
  margin-top: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
}

#interaction, #roi {
  background-color: var(--color-gray-100);
  padding: var(--spacer-xxl) var(--spacer-lg);
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-sm);
  margin-top: var(--spacer-xl);
}
#interaction h2, #roi h2 {
  color: var(--color-primary);
}
#interaction-form, #roi-form {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacer-sm);
  background: #fff;
  padding: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
}
#interaction-form select,
#roi-form select,
#interaction-form input,
#roi-form input {
  padding: var(--spacer-sm) var(--spacer-md);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--border-radius-pill);
}
#interaction-form button,
#roi-form button {
  background: var(--color-primary);
  color: #fff;
  padding: var(--spacer-sm) var(--spacer-xl);
  border-radius: var(--border-radius-pill);
  box-shadow: var(--shadow-sm);
}
#interactionResult,
#roiResult {
  background: #fff;
  padding: var(--spacer-lg);
  margin-top: var(--spacer-lg);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
}

#analytics {
  background-color: var(--color-gray-100);
  border-top: 4px solid var(--color-secondary);
  padding: var(--spacer-xxl) var(--spacer-lg);
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-sm);
  margin-top: var(--spacer-xl);
}
#analytics .charts {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px,1fr));
  gap: var(--spacer-lg);
  margin-bottom: var(--spacer-lg);
}
.chart-card {
  background: #fff;
  padding: var(--spacer-md);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
}
.chart-card canvas {
  width: 100% !important;
  height: 180px !important;
}
.chart-card figcaption {
  font-size: var(--font-size-sm);
  color: var(--color-text-muted);
  margin-top: var(--spacer-xs);
}

/* ---------------------------------------------
   5.14 MODULE STYLES: Meet a Herbal Health Expert
   --------------------------------------------- */
.meet-module {
  background: linear-gradient(135deg, var(--color-secondary), var(--color-primary));
  color: #fff;
  border-radius: var(--border-radius-lg);
  padding: var(--spacer-xxl) var(--spacer-lg);
  display: flex;
  align-items: center;
  gap: var(--spacer-lg);
  margin-top: var(--spacer-xl);
}
.meet-module .meet-icon {
  font-size: 4rem;
  opacity: 0.3;
}
.meet-module .meet-text h2 {
  font-size: var(--font-size-2xl);
  margin-bottom: var(--spacer-sm);
}
.meet-module .btn-schedule {
  background: #fff;
  color: var(--color-primary);
  font-weight: var(--font-weight-medium);
  padding: var(--spacer-sm) var(--spacer-xl);
  border-radius: var(--border-radius-pill);
  box-shadow: var(--shadow-sm);
}
.meet-module .btn-schedule:hover {
  background: var(--color-primary-hover);
  color: #fff;
}

/* ---------------------------------------------
   5.15 SUPPORT: Toasts, Spinners & CATCH-ALL
   --------------------------------------------- */
.spinner {
 width: 1.25em; height: 1.25em;
  border: 3px solid var(--color-gray-300);
  border-top-color: var(--color-secondary);
  border-radius: 50%;
  animation: spin 0.8s ease-in-out infinite;
  box-shadow: var(--shadow-xs);
}

/* Toast */
.copy-toast {
  position: fixed;
  bottom: var(--spacer-lg);
  right: var(--spacer-lg);
  background-color: var(--toast-bg);
  color: var(--toast-text);
  padding: var(--spacer-sm) var(--spacer-md);
  border-radius: var(--border-radius-pill);
  box-shadow: var(--shadow-lg);
  z-index: var(--z-index-toast);
  animation: slideIn 0.3s ease, fadeOut 0.3s ease 1.2s forwards;
}
@keyframes slideIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes fadeOut {
  to { opacity: 0; }
}

/* Catch-all transition on all modules */
section.module, .chart-card, .meet-module {
  transition: transform var(--transition-fast), box-shadow var(--transition-fast);
}
section.module:hover, .chart-card:hover, .meet-module:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}


:root.dark {
  background-color: var(--color-gray-900);
}
:root.dark section.module,
:root.dark .chart-card,
:root.dark .meet-module {
  background-color: var(--color-gray-800);
  box-shadow: 0 2px 8px rgba(0,0,0,0.5);
}
:root.dark input, :root.dark select, :root.dark textarea {
  background-color: var(--color-gray-900);
  border-color: var(--color-gray-700);
  color: var(--color-text);
}
:root.dark button, :root.dark .btn-primary, :root.dark .btn-secondary, :root.dark .btn-tertiary {
  color: #fff;
}

   .dark section.module,
.dark .chart-card,
.dark .meet-module {
  background-color: var(--color-bg-alt) !important;
 }
.dark .response {
background: var(--color-gray-800) !important;
 }
   
@media (max-width: var(--breakpoint-md)) {
  /* Stack modules */
  section.module {
    padding: var(--spacer-lg);
    margin: var(--spacer-xl) 0;
  }
  /* Sidebar hidden, header fixed */
  aside#sidebar, header { display: none; }
  /* Full-width buttons */
  .btn-primary, .btn-secondary, .btn-tertiary, button { width: 100%; }
  /* Chat adjustments */
  .chat-box { height: 200px; }
  /* Form inputs full width */
  #pf-form, #research-form, #inventory-form, #interaction-form, #roi-form, #dose-form {
    flex-direction: column;
  }
}

 @media (max-width: 414px) {
   html { font-size: 14px; } /* slightly smaller text */
   main { margin-left: 0; padding: var(--spacer-md); }
     aside#sidebar { display: none; }
  header {
    display: flex;
    position: fixed;
    top: 0; left: 0; right: 0;
    z-index: var(--z-index-sticky);
 }

   /* Buttons full width */
   .btn-primary, .btn-secondary, .btn-tertiary, button {
     width: 100%; text-align: center;
   }

   /* Hero images smaller */
   .hero-image img {
     max-width: 90%;
   }

   /* Reduce chat height */
   .chat-box { height: 180px; }

   .sym-form,
   #iden-form
   {
     grid-template-columns: 1fr !important;
   }
 }

   /* replace your existing .spinner rule with: */
.spinner {
  display: inline-block;
  width: 2em;
  height: 2em;
  border: 3px solid var(--color-gray-300);
  border-top-color:   var(--color-secondary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  box-shadow: var(--shadow-xs);
  margin: var(--spacer-md) auto;        /* center horizontally */
}
.response .spinner {
  background: rgba(0,0,0,0.05);          /* light backdrop */
  padding: var(--spacer-sm);
  border-radius: var(--border-radius-lg);
  display: block;
}
@keyframes spin {
  to { transform: rotate(360deg); }
}

   #research-form {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: var(--spacer-sm);
  background: var(--color-bg);
  padding: var(--spacer-md);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
  align-items: center;
}

#research-form input,
#research-form button {
  font-size: var(--font-size-base);
  padding: var(--spacer-sm) var(--spacer-md);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--border-radius-pill);
}

#research-form input {
  border-right: none;
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}

#research-form button {
  background: var(--color-secondary);
  color: #fff;
  border-left: none;
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
  cursor: pointer;
  transition: background var(--transition-fast);
}
#research-form button:hover {
  background: var(--color-secondary-hover);
}

/* On phones, stack */
@media (max-width: 480px) {
  #research-form {
    grid-template-columns: 1fr;
  }
  #research-form input,
  #research-form button {
    border-radius: var(--border-radius-pill);
    border: var(--border-width) solid var(--color-border);
  }
}
   .btn-export {
  display: inline-block;
  margin: var(--spacer-lg) auto;
  padding: var(--spacer-sm) var(--spacer-xl);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-medium);
  background: var(--color-primary);
  color: #fff;
  border-radius: var(--border-radius-pill);
  box-shadow: var(--shadow-sm);
  text-align: center;
  transition: background var(--transition-fast), transform var(--transition-fast);
}
.btn-export:hover {
  background: var(--color-primary-hover);
  transform: translateY(-2px);
}

/* full-width on small screens */
@media (max-width: 480px) {
  .btn-export {
    width: 100%;
  }
}
   .interaction-form {
  display: grid;
  grid-template-columns: repeat(auto-fit,minmax(140px,1fr)) auto;
  gap: var(--spacer-sm);
  background: var(--color-bg-alt);
  padding: var(--spacer-md);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-xs);
  align-items: end;
}

.interaction-form .field {
  display: flex;
  flex-direction: column;
}

.interaction-form label {
  margin-bottom: var(--spacer-xs);
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
}

.interaction-form select {
  padding: var(--spacer-sm) var(--spacer-md);
  border: var(--border-width) solid var(--color-border);
  border-radius: var(--border-radius-pill);
  font-size: var(--font-size-base);
}

.interaction-form .action button {
  background: var(--color-secondary);
  color: #fff;
  padding: var(--spacer-sm) var(--spacer-lg);
  border: none;
  border-radius: var(--border-radius-pill);
  cursor: pointer;
  transition: background var(--transition-fast);
}
.interaction-form .action button:hover {
  background: var(--color-secondary-hover);
}

/* mobile: stack */
@media (max-width: 480px) {
  .interaction-form {
    grid-template-columns: 1fr;
  }
}
   /* prevent text loss on small screens */
section.module {
  overflow-wrap: break-word;
  word-break: break-word;
}

/* ensure forms never exceed width */
form, .chart-card, .meet-module {
  max-width: 100%;
}

/* unified padding on small */
@media (max-width: 414px) {
  section.module {
    padding: var(--spacer-lg);
    margin: var(--spacer-xl) 0;
  }
}
   :root.dark {
  --color-module-bg: var(--color-gray-800);
  --color-form-bg:   var(--color-gray-800);
  --color-input-bg:  var(--color-gray-900);
  --color-border:    var(--color-gray-700);
}

section.module,
.chart-card,
.meet-module,
.interaction-form,
#research-form,
#iden-form,
.sym-form {
  background: var(--color-module-bg) !important;
}

input, select, textarea, button {
  background: var(--color-input-bg) !important;
  border-color: var(--color-border) !important;
  color: var(--color-text) !important;
}

.chat-box {
  background: var(--color-module-bg) !important;
}

.copy-toast {
  background: var(--toast-bg) !important;
}
   
 </style>


</head>

<body>
  <aside id="sidebar">
    <div class="logo">
      <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" fill="var(--primary)">
        <polygon points="10,10 25,90 50,40 75,90 90,10 65,10 50,70 35,10"/>
      </svg>
      <span class="logo-text">Vitra AI</span>
    </div>
    <nav role="navigation">
           <a href="dashboard.html"><i class="fas fa-tachometer-alt"></i><span>Dashboard</span></a>
      <a href="herbal.html" id="link-herbal" class="active">
        <i class="fas fa-seedling"></i>
        <span>Herbal Medicine</span>
      </a>
      <a href="psychology.html">
        <i class="fas fa-brain"></i>
        <span>Psychology &amp; Mental Health</span>
      </a>
      <a href="dietetics.html">
        <i class="fas fa-utensils"></i>
        <span>Dietetics</span>
      </a>
      <a href="epharmacy.html">
        <i class="fas fa-prescription-bottle-alt"></i>
        <span>E-Pharmacy</span>
      </a>
      <a href="consult.html">
        <i class="fas fa-calendar-check"></i>
        <span>Consultation Booking</span>
      </a>
    </nav>
    <button id="shrinkBtn" aria-label="Toggle sidebar">
      <i class="fas fa-angle-double-left"></i>
    </button>
  </aside>

  <header>
    <div style="display:flex; align-items:center; gap:1rem;">
      <i id="hamburger" class="fas fa-bars hamburger" aria-label="Toggle navigation"></i>
      <h1>Herbal Medicine Hub</h1>
    </div>
    <div>
      <i id="themeToggle" class="fas fa-moon theme-toggle" aria-label="Toggle theme"></i>
    </div>
  </header>

  <main role="main">
    <section id="hero" class="module hero-module">
      <div class="hero-inner">
        <div class="hero-content">
          <h1><i class="fas fa-seedling"></i> Empower Your Herbal Journey</h1>
          <p class="hero-subtitle">
            Explore our AI-powered toolkit to identify plants, analyze symptoms, discover cultural wisdom, and manage inventory—all in one place.
          </p>
          <div class="hero-actions">
            <a href="#hero–identifier" class="btn-primary">
              <i class="fas fa-camera"></i> Scan a Plant
            </a>
            <a href="#hero-symptom" class="btn-secondary">
              <i class="fas fa-notes-medical"></i> Check Symptoms
            </a>
            <a href="#hero–chat" class="btn-tertiary">
              <i class="fas fa-comments"></i> Chat with Herbalist
            </a>
          </div>
        </div>
        <div class="hero-image">
          <img src="herbs.webp" alt="Assortment of medicinal herbs">
        </div>
      </div>
      <i class="fas fa-seedling hero-bg-icon" style="top: 8%; left: 7%;"></i>
      <i class="fas fa-leaf     hero-bg-icon" style="top: 5%; right: 9%;"></i>
      <i class="fas fa-flask    hero-bg-icon" style="bottom: 10%; left: 12%;"></i>
      <i class="fas fa-stethoscope hero-bg-icon" style="bottom: 8%; right: 15%;"></i>
      <i class="fas fa-chart-line  hero-bg-icon" style="top: 45%; left: 45%;"></i>
    </section>

    <section id="hero–identifier" class="module">
      <h2><i class="fas fa-camera"></i> AI Plant Scanner</h2>
      <p class="desc">
        Upload a photo of a leaf, flower, or entire plant, or describe it in text. Our AI will identify the species and provide medicinal uses, precautions, and regional information.
      </p>
      <form id="iden-form">
        <textarea id="idenDesc" rows="2" placeholder="Or describe your plant here…"></textarea>
        <input type="file" accept="image/*" aria-label="Upload plant image" onchange="previewImage(this)"/>
        <button type="submit">Identify Plant</button>
        <div class="hint">Use a clear, well-lit close-up of the plant part. Supported image types: JPG, PNG.</div>
      </form>
      <img id="idenPreview" alt="Plant preview" style="max-width:200px; margin-top:1rem; display:none;"/>
      <div id="idenClear" style="display:none; margin-top:.5rem;">
        <a href="#" onclick="clearPreview(); return false;">Remove Image</a>
      </div>
      <div id="idenResult" class="response" role="status" aria-live="polite" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
      </div>
    </section>

 <section id="hero-symptom" class="module">
  <h2><i class="fas fa-notes-medical"></i> Symptom Checker</h2>
  <p class="desc">
    Describe your symptoms and duration, choose severity, and our AI will recommend herbs, dosages, and precautions.
  </p>
  <form id="sym-form" class="sym-form">
    <div class="field">
      <label for="symInput">Your Symptoms</label>
      <textarea
        id="symInput"
        required
        placeholder="e.g. headache, nausea…"
      ></textarea>
    </div>

    <div class="field">
      <label for="symCategories">Category</label>
      <select id="symCategories" multiple size="4" required>
        <option disabled>Select category…</option>
        <option value="pain">Pain</option>
        <option value="digestive">Digestive</option>
        <option value="respiratory">Respiratory</option>
        <option value="stress">Stress</option>
        <option value="sleep">Sleep</option>
        <option value="energy">Energy</option>
        <option value="immune">Immune</option>
        <option value="skin">Skin</option>
        <option value="mental">Mental</option>
        <option value="cardio">Cardiovascular</option>
        <option value="Other">Other</option>
      </select>
      <input
        type="text"
        id="symCategoriesOther"
        placeholder="Please specify…"
        class="other-input"
      />
    </div>

    <div class="field range-field">
      <label for="severity">Severity</label>
      <input type="range" id="severity" min="1" max="10" value="5"/>
      <span id="sevValue">5</span>/10
    </div>

    <div class="field">
      <label for="symDuration">Duration (days)</label>
      <input type="number" id="symDuration" min="0" placeholder="e.g. 3"/>
    </div>

    <button type="submit" class="btn-primary">Get Recommendations</button>
  </form>

  <div id="symResult" class="response sym-response" hidden>
    <button class="close-btn" aria-label="Close result">×</button>
    <div class="result-content"></div>
    <div class="tool-row">
      <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
      <button class="dl-btn" title="Download"><i class="fas fa-download"></i></button>
    </div>
  </div>
</section>


    <section id="hero–cultural" class="module">
      <h2><i class="fas fa-globe"></i> Cultural Knowledge</h2>
      <p class="desc">
        Learn about traditional rituals, folklore, and regional herbal practices. Enter a country, tradition, or herb name to get rich cultural insights.
      </p>
      <form id="culture-form" class="culture-input-wrapper">
        <input id="cultureQuery" name="q" type="text" placeholder="e.g. West African herbal uses…" required/>
        <button type="submit" class="btn-culture">Get Insights</button>
      </form>
      <div id="cultureResult" class="response" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
      </div>
    </section>

    <section id="hero–safety" class="module">
      <h2><i class="fas fa-shield-alt"></i> Safety Checker</h2>
      <p class="desc">
        Check for potential adverse interactions between two herbs or medications. Enter both items to ensure safe usage.
      </p>
      <form id="safety-form">
        <input id="safetyA" placeholder="Item A (e.g. Turmeric)" aria-label="Item A" required/>
        <input id="safetyB" placeholder="Item B (e.g. Warfarin)" aria-label="Item B" required/>
        <button type="submit">Check Interaction</button>
        <div class="hint">Ensure both entries are distinct and correctly spelled.</div>
      </form>
      <div id="safetyResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
         <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
          <button class="dl-btn" title="Download"><i class="fas fa-download"></i></button>
        </div>
      </div>
    </section>

    <section id="hero–chat" class="module">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
        <h2><i class="fas fa-comments"></i> AI Herbalist Chat</h2>
        <div class="chat-controls">
          <button id="viewHistory" title="View History"><i class="fas fa-history"></i></button>
          <button id="clearChat" title="Clear Chat"><i class="fas fa-trash-alt"></i></button>
        </div>
      </div>
       <div id="chatBox" class="chat-box" role="log" aria-live="polite"></div>
      <div class="chat-input-row">
        <input id="chatInput" placeholder="Ask about herbal remedies…" aria-label="Type your question"/>
        <button id="sendChat" aria-label="Send message"><i class="fas fa-paper-plane"></i></button>
      </div>
    </section>

    <section id="formulations" class="module">
      <h2><i class="fas fa-prescription-bottle"></i> Personalized Formulations</h2>
      <p class="desc">
        Select one herb, enter age and weight, and receive a custom formulation tailored to your profile.
      </p>
      <form id="pf-form">
        <select id="pfHerbs" aria-label="Select herb" required>
          <option disabled selected>Select herb…</option>
          <option>Ashwagandha</option>
          <option>Astragalus</option>
          <option>Basil</option>
          <option>Chamomile</option>
          <option>Echinacea</option>
          <option>Ginkgo Biloba</option>
          <option>Ginseng</option>
          <option>Lavender</option>
          <option>Licorice</option>
          <option>Milk Thistle</option>
          <option>Neem</option>
          <option>Oregano</option>
          <option>Peppermint</option>
          <option>Rosemary</option>
          <option>St. John’s Wort</option>
          <option>Turmeric</option>
          <option>Valerian</option>
          <option>Roselle</option>
          <option>Soursop</option>
          <option>Baobab</option>
          <option>Moringa</option>
          <option>Ginger</option>
          <option>Hibiscus</option>
          <option>Holy Basil</option>
         <option value="Other">Other</option>
        </select>
        <input type="text" id="pfHerbsOther" placeholder="Please specify herb…" class="other-input hidden"/>

        <input id="pfAge" type="number" min="1" max="120" placeholder="Age (years)" required/>
        <input id="pfWeight" type="number" min="10" max="300" placeholder="Weight (kg)" required/>
        <button type="submit">Generate Formulation</button>
        <div class="hint">Select one herb from the dropdown, then enter valid age and weight.</div>
      </form>
      <div id="pfResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
        <p class="hint"><em>Formulation meets recommended dosage safety limits.</em></p>
      </div>
    </section>

    <section id="research" class="module">
      <h2><i class="fas fa-book-reader"></i> Research Summaries</h2>
      <p class="desc">
        Paste study titles, abstracts, or keywords and get a concise, plain-text summary of findings, including key citations.
      </p>
      <form id="research-form">
        <input id="researchQuery" placeholder="e.g. ‘Ashwagandha anxiety RCT’" aria-label="Research query" required/>
        <button type="submit">Generate Summary</button>
        <div class="hint">Include herb name and research focus for best results.</div>
      </form>
      <div id="researchResults" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
        <a href="#" target="_blank">Read Original Study</a>
      </div>
    </section>

    <section id="inventory" class="module">
      <h2><i class="fas fa-warehouse"></i> Inventory Forecast</h2>
      <p class="desc">
        Predict future stock requirements for your herbal inventory. Select a herb and forecast period (1–52 weeks).
      </p>
      <form id="inventory-form">
        <select id="forecastHerb" aria-label="Select herb for forecast" required>
          <option disabled selected>Select herb…</option>
          <option>Ashwagandha</option>
          <option>Astragalus</option>
          <option>Basil</option>
          <option>Chamomile</option>
          <option>Echinacea</option>
          <option>Ginkgo Biloba</option>
          <option>Ginseng</option>
          <option>Lavender</option>
          <option>Licorice</option>
          <option>Milk Thistle</option>
          <option>Neem</option>
          <option>Oregano</option>
          <option>Peppermint</option>
          <option>Rosemary</option>
          <option>St. John’s Wort</option>
          <option>Turmeric</option>
          <option>Valerian</option>
          <option>Roselle</option>
          <option>Soursop</option>
          <option>Baobab</option>
          <option>Moringa</option>
          <option>Ginger</option>
          <option>Hibiscus</option>
          <option>Holy Basil</option>
         <option value="Other">Other</option>
        </select>
        <input type="text" id="forecastHerbOther" placeholder="Please specify herb…" class="other-input hidden"/>

       <input id="forecastPeriod" type="number" min="1" max="52" value="4" placeholder="Weeks ahead" required/>
        <button type="submit">Forecast Inventory</button>
        <div class="hint">Enter number of weeks (1–52) for demand prediction.</div>
      </form>
      <div id="inventoryResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
      </div>
    </section>

    <section id="genetics" class="module">
      <h2><i class="fas fa-dna"></i> Genetics Match</h2>
      <p class="desc">
        Upload your genetic report (CSV or JSON) to receive herb recommendations tailored to your SNP profile.
      </p>
      <form id="genetics-form">
        <input id="geneticUpload" type="file" accept=".csv,.json" aria-label="Upload genetic report"/>
        <button type="submit">Analyze Genetics</button>
        <div class="hint">Supported formats: CSV or JSON with SNP data.</div>
      </form>
      <div id="geneticResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
        <p class="hint"><em>Tier 1: evidence-based recommendations. Tier 2: emerging scientific data.</em></p>
      </div>
    </section>

    <section id="dosage" class="module">
      <h2><i class="fas fa-calculator"></i> Dosage Calculator</h2>
      <p class="desc">
        Calculate daily herbal dosage based on your weight, symptom, and extract form for accurate guidance.
      </p>
      <form id="dose-form">
        <input id="weight" type="number" min="10" max="300" placeholder="Weight (kg)" required/>
        <input id="symptom" placeholder="Symptom (e.g. headache)" required/>
        <select id="formType" aria-label="Select extract type">
          <option value="powder">Powder</option>
          <option value="tincture">Tincture</option>
          <option value="capsule">Capsule</option>
        <option value="Other">Other</option>
        </select>
        <input type="text" id="formTypeOther" placeholder="Please specify form…" class="other-input hidden"/>

        <button type="submit">Calculate Dosage</button>
        <div class="hint">Specify extract form for precise calculations.</div>
      </form>
      <div id="dosageResult" class="response" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
         <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
          <button class="dl-btn" title="Download"><i class="fas fa-download"></i></button>
        </div>
      </div>
    </section>

    <section id="interaction" class="module">
      <h2><i class="fas fa-exchange-alt"></i> Interaction Checker</h2>
      <p class="desc">
        Select two herbs to verify if any harmful interactions exist. Helps ensure safe co-administration.
      </p>
      <form id="int-form">
        <select id="herbA" aria-label="Herb A" required>
          <option disabled selected>Herb A…</option>
          <option>Ashwagandha</option>
          <option>Baobab</option>
          <option>Basil</option>
          <option>Chamomile</option>
          <option>Echinacea</option>
          <option>Ginger</option>
          <option>Ginkgo Biloba</option>
          <option>Ginseng</option>
          <option>Hibiscus</option>
          <option>Holy Basil</option>
          <option>Lavender</option>
          <option>Licorice</option>
          <option>Milk Thistle</option>
          <option>Neem</option>
          <option>Moringa</option>
          <option>Oregano</option>
          <option>Peppermint</option>
          <option>Rosemary</option>
          <option>St. John’s Wort</option>
          <option>Turmeric</option>
          <option>Valerian</option>
        </select>
        <select id="herbB" aria-label="Herb B" required>
          <option disabled selected>Herb B…</option>
          <option>Ashwagandha</option>
          <option>Baobab</option>
          <option>Basil</option>
          <option>Chamomile</option>
          <option>Echinacea</option>
          <option>Ginger</option>
          <option>Ginkgo Biloba</option>
          <option>Ginseng</option>
          <option>Hibiscus</option>
          <option>Holy Basil</option>
          <option>Lavender</option>
          <option>Licorice</option>
          <option>Milk Thistle</option>
          <option>Neem</option>
          <option>Moringa</option>
          <option>Oregano</option>
          <option>Peppermint</option>
          <option>Rosemary</option>
          <option>St. John’s Wort</option>
          <option>Turmeric</option>
          <option>Valerian</option>
        </select>
        <button type="submit">Check Interaction</button>
        <div class="hint">Be sure to pick two different herbs to compare.</div>
      </form>
      <div id="interactionResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
         <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
          <button class="dl-btn" title="Download"><i class="fas fa-download"></i></button>
        </div>
      </div>
    </section>


    
    <section id="roi" class="module">
      <h2><i class="fas fa-dollar-sign"></i> Business Insights &amp; ROI Calculator</h2>
     <p class="desc">
        Calculate the financial return on investment (ROI) of integrating our AI‐driven herbal prescription system into your practice. 
        <br>1) Choose your currency. 2) Enter your average monthly number of AI‐generated herb prescriptions. 
        <br>3) Enter your average cost per herb prescription. 
        <br><strong>The result will show estimated monthly savings vs. traditional methods and ROI percentage.</strong>
      </p>
      <form id="roi-form">
        <div class="field">
          <label for="currency">Currency</label>
          <select id="currency">
            <option value="GHS" selected>Ghanaian Cedi (GHS)</option>
            <option value="USD">US Dollar (USD)</option>
            <option value="EUR">Euro (EUR)</option>
             <option value="Other">Other</option>
          </select>
          <input type="text" id="currencyOther" placeholder="Please specify currency…" class="other-input"/>
        </div>
        <div class="field">
          <label for="roiRx">Monthly Prescriptions</label>
          <input type="number" id="roiRx" required placeholder="e.g. 100"/>
        </div>
        <div class="field">
          <label for="roiCost">Avg. Herb Cost (<span id="curSym">₵</span>)</label>
          <input type="number" id="roiCost" required placeholder="e.g. 25"/>
        </div>
        <button type="submit">Calculate ROI</button>
      </form>
      <div id="roiResult" class="response" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
      </div>
    </section>

    <section id="analytics" class="module">
      <h2><i class="fas fa-chart-line"></i> Executive Analytics &amp; KPIs</h2>
      <p class="desc">
        Monitor real-time metrics to track user adoption, efficacy, inventory usage, and financial ROI—visualized in interactive charts.
      </p>
      <div class="charts">
        <figure class="chart-card">
          <canvas id="chartAdoption"></canvas>
 <figcaption><strong>Adoption Over Time:</strong> Number of new users subscribing to the AI Herbalist each month.</figcaption>
          <p class="chart-desc">This line chart shows how many unique practitioners started using AI‐based prescriptions from Jan to May.</p>

        </figure>
        <figure class="chart-card">
          <canvas id="chartEfficacy"></canvas>
 <figcaption><strong>Adoption Over Time:</strong> Number of new users subscribing to the AI Herbalist each month.</figcaption>
          <p class="chart-desc">This line chart shows how many unique practitioners started using AI‐based prescriptions from Jan to May.</p>
        </figure>
        <figure class="chart-card">
          <canvas id="chartSupply"></canvas>
  <figcaption><strong>Supply Impact:</strong> Proportion of top‐three herbs used weekly.</figcaption>
          <p class="chart-desc">This pie chart shows how inventory usage is split among Herb A, Herb B, and Herb C.</p>
        </figure>
        <figure class="chart-card">
          <canvas id="chartROI"></canvas>
<figcaption><strong>Financial ROI:</strong> Quarterly return on investment percentages.</figcaption>
         <p class="chart-desc">This radar chart displays ROI metrics for Q1–Q4.</p>
        </figure>
      </div>
 <button id="exportCSV" class="btn-primary">Export Full CSV</button>
    </section>

<section id="meet-professional" class="module meet-module">
    <div class="meet-content">
      <div class="meet-icon">
        <i class="fas fa-user-md"></i>
      </div>
      <div class="meet-text">
        <h2>Meet a<BR>Herbal Health Expert</h2>
        <p>Get one-on-one guidance from our licensed herbal practitioners. Discover tailored wellness plans, expert dosage advice, and safe herbal combinations.</p>
        <a href="consult.html" class="btn-schedule">
          <i class="fas fa-calendar-check"></i>
          Schedule Consultation
        </a>
      </div>
    </div>
  </section>

      <footer>
    <p>&copy; 2025 Vitra AI. <a href="#privacy">Privacy Policy</a> | <a href="#terms">Terms &amp; Conditions</a></p>
  </footer>
  </main>

 <script src="storage.js"></script>

 <script>

     const savedTheme = localStorage.getItem("vitra-theme");
  if (savedTheme === "dark") {
    document.documentElement.classList.add("dark");
    document.documentElement.setAttribute("aria-theme", "dark");
  }
</script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const sidebar = document.getElementById("sidebar");
    const hamburger = document.getElementById("hamburger");

    document.addEventListener("click", (e) => {
      if (!sidebar.classList.contains("open")) return;

      if (sidebar.contains(e.target) || hamburger.contains(e.target)) {
        return;
      }

      sidebar.classList.remove("open");
    });

    hamburger.addEventListener("click", (e) => {
      e.stopPropagation();
      sidebar.classList.toggle("open");
    });
  });
</script>
  
<script>
  function escapeHtml(unsafe) {
    return unsafe
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;");
  }

  document.addEventListener("DOMContentLoaded", () => {
  
        async function callOpenAI(messages) {
      try {
        const response = await fetch("/.netlify/functions/openai-proxy", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ messages })
        });
        if (!response.ok) throw new Error("OpenAI request failed");
        const data = await response.json();
        return data.choices?.[0]?.message?.content.trim() || "";
      } catch (err) {
        console.error(err);
        throw err;
      }
    }
Storage.recordCategory("Herbal");

    
    async function callVision(file) {
      const fd = new FormData();
      fd.append("file", file);

      const res = await fetch("/.netlify/functions/vision-proxy", {
        method: "POST",
        body: fd,
      });

      const rawText = await res.text();
      let payload = null;
      try {
        payload = JSON.parse(rawText);
      } catch {
        payload = null;
      }

      if (!res.ok) {
        const errMsg = payload && payload.error ? payload.error : rawText;
        throw new Error("Vision API error: " + errMsg);
      }

      return payload !== null ? payload : rawText;
    }

    function formatHTML(text) {
      if (!text) return "";
      return text
        .replace(/^######\s*(.+)$/gm, "<h6>$1</h6>")
        .replace(/^#####\s*(.+)$/gm, "<h5>$1</h5>")
        .replace(/^####\s*(.+)$/gm, "<h4>$1</h4>")
        .replace(/^###\s*(.+)$/gm, "<h3>$1</h3>")
        .replace(/^##\s*(.+)$/gm, "<h2>$1</h2>")
        .replace(/^#\s*(.+)$/gm, "<h1>$1</h1>")
        .replace(/\*\*(.+?)\*\*/g, "<strong>$1</strong>")
        .replace(/\*(.+?)\*/g, "<em>$1</em>")
        .replace(/`([^`]+)`/g, "<code>$1</code>")
        .split(/\n{2,}/)
        .map(p => `<p>${p.trim()}</p>`)
        .join("");
    }

    function addClose(panel) {
      if (panel.querySelector(".close-btn")) return;
      const btn = document.createElement("button");
      btn.className = "close-btn";
      btn.setAttribute("aria-label", "Close result");
      btn.textContent = "×";
      btn.onclick = () => (panel.hidden = true);
      panel.prepend(btn);
    }

    function addTools(panel) {
      if (panel.querySelector(".tool-row")) return;
      const tools = document.createElement("div");
      tools.className = "tool-row";
      tools.innerHTML = `
        <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
        <button class="dl-btn" title="Download"><i class="fas fa-download"></i></button>`;
      panel.append(tools);

      const copyBtn = tools.querySelector(".copy-btn");
      const dlBtn = tools.querySelector(".dl-btn");
      const contentDiv = panel.querySelector(".result-content");

      copyBtn.onclick = () => {
        if (!contentDiv) return;
        navigator.clipboard.writeText(contentDiv.innerText || "");
        const toast = document.createElement("div");
        toast.className = "copy-toast";
        toast.textContent = "Copied!";
        document.body.append(toast);
        setTimeout(() => toast.remove(), 1500);
      };

      dlBtn.onclick = () => {
        if (!contentDiv) return;
        const text = contentDiv.innerText || "";
        const blob = new Blob([text], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "response.txt";
        document.body.append(a);
        a.click();
        URL.revokeObjectURL(url);
        a.remove();
      };
    }

    function showFriendlyError(panel) {
      panel.innerHTML = '<div class="result-content">😕 Oops! Something went wrong. Please try again.</div>';
      addClose(panel);
    }

    function wireForm({ formId, systemPrompt, inputExtractor, resultPanelId }) {
      const form = document.getElementById(formId);
      const panel = document.getElementById(resultPanelId);
      form.onsubmit = async (e) => {
        e.preventDefault();
        panel.hidden = false;
        panel.innerHTML = '<div class="result-content">Processing… <span class="spinner"></span></div>';
        try {
          const userContent = inputExtractor();
          const reply = await callOpenAI([
            { role: "system", content: systemPrompt },
            { role: "user", content: userContent }
          ]);
          panel.innerHTML = `<div class="result-content">${formatHTML(reply)}</div>`;
          addClose(panel);
          addTools(panel);
        } catch (err) {
          showFriendlyError(panel);
        }
      };
    }


    const sidebar = document.getElementById("sidebar");
    const shrinkBtn = document.getElementById("shrinkBtn");
    const hamburger = document.getElementById("hamburger");
    const themeToggle = document.getElementById("themeToggle");

   shrinkBtn.addEventListener("click", () => {
      sidebar.classList.toggle("collapsed");
      const icon = shrinkBtn.querySelector("i");
      icon.classList.toggle("fa-angle-double-left");
      icon.classList.toggle("fa-angle-double-right");
    });

    hamburger.addEventListener("click", () => {
      sidebar.classList.toggle("open");
    });

    themeToggle.addEventListener("click", () => {
      const htmlEl = document.documentElement;
      const isDark = htmlEl.classList.toggle("dark");
      themeToggle.classList.toggle("fa-sun", isDark);
      themeToggle.classList.toggle("fa-moon", !isDark);
      htmlEl.setAttribute("aria-theme", isDark ? "dark" : "light");
       localStorage.setItem("vitra-theme", isDark ? "dark" : "light");
    });

    const mq = window.matchMedia("(max-width: 1024px)");
    function updateHamburgerVisibility() {
      hamburger.style.display = mq.matches ? "block" : "none";
    }
    mq.addListener(updateHamburgerVisibility);
    updateHamburgerVisibility();

    document.querySelectorAll("select").forEach((sel) => {
      sel.addEventListener("change", (e) => {
         const otherField = document.getElementById(sel.id + "Other");
       if (!otherField) return;
       const pickedOther = Array.from(sel.selectedOptions).some(opt => opt.value === "Other");
       if (pickedOther) {
         otherField.style.display = "block";
         otherField.required = true;
       } else {
         otherField.style.display = "none";
         otherField.required = false;
       }
      });
    });
    

    const idenForm = document.getElementById("iden-form");
    const idenResult = document.getElementById("idenResult");
    const idenPreview = document.getElementById("idenPreview");
    const idenClear = document.getElementById("idenClear");

    function previewImage(input) {
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = (e) => {
          idenPreview.src = e.target.result;
          idenPreview.style.display = "block";
          idenClear.style.display = "block";
        };
        reader.readAsDataURL(input.files[0]);
      }
    }
    window.previewImage = previewImage; 

    function clearPreview() {
      idenPreview.style.display = "none";
      idenPreview.src = "";
      idenClear.style.display = "none";
      document.querySelector("#iden-form input[type=file]").value = "";
      document.getElementById("idenDesc").value = "";
    }
    window.clearPreview = clearPreview; 

    idenForm.onsubmit = async (e) => {
      e.preventDefault();
      const panel = idenResult;
      panel.hidden = false;
      panel.innerHTML = '<div class="result-content">Processing… <span class="spinner"></span></div>';

      const fileInput = idenForm.querySelector('input[type="file"]');
      const file = fileInput.files[0];
      const desc = document.getElementById("idenDesc").value.trim();

      if (!file && !desc) {
        panel.innerHTML = '<div class="result-content">⚠️ Please upload an image or provide a description.</div>';
        addClose(panel);
        return;
      }

      try {
        let html = "";

        if (file) {

          const data = await callVision(file);
          html += `
            <p><strong>Plant Name:</strong> ${escapeHtml(data.name)}</p>
            <p><strong>Medicinal Uses:</strong> ${escapeHtml(data.uses)}</p>
            <p><strong>Cautions:</strong> ${escapeHtml(data.cautions)}</p>
            <p><strong>Native Regions:</strong> ${Array.isArray(data.regions) ? escapeHtml(data.regions.join(", ")) : "N/A"}</p>
            <hr/>`;
        }

        if (desc) {
            panel.innerHTML = `<div class="result-content">Consulting AI about your text… <span class="spinner"></span></div>`;
            const sys = `
You are a world‐class botanist. Given a user’s plant description, reply with a concise paragraph that includes:
• Plant name  
• Medicinal uses  
• Any cautions or side effects  
• Native or regional information  
Add any additional helpful notes in a coherent, single paragraph.
          `.trim();
          const aiReply = await callOpenAI([
            { role: "system", content: sys },
            { role: "user", content: `Describe plant: "${desc}"` }
          ]);
          html += formatHTML(aiReply);
       }

        panel.innerHTML = `<div class="result-content">${html}</div>`;
        localStorage.setItem("idenResult", panel.innerHTML);
        addClose(panel);
        addTools(panel);
     } catch (err) {
      panel.innerHTML = `
        <div class="result-content">
         😕 An error occurred. Please type in your description instead.
        </div>
      `;
     addClose(panel);
    }
    };


    const severitySlider = document.getElementById("severity");
    const sevValueSpan = document.getElementById("sevValue");
    severitySlider.oninput = (e) => {
      sevValueSpan.textContent = e.target.value;
    };

    document.getElementById("sym-form").onsubmit = async (e) => {
      e.preventDefault();
      const panel = document.getElementById("symResult");
      panel.hidden = false;
      panel.innerHTML = '<div class="result-content">Processing… <span class="spinner"></span></div>';

      const symptoms = document.getElementById("symInput").value.trim();
      const categories = Array.from(
        document.getElementById("symCategories").selectedOptions
      ).map(o => o.value).join(", ");
      const severity = document.getElementById("severity").value;
      const duration = document.getElementById("symDuration").value || "0";

      try {
        const aiReply = await callOpenAI([
          {
            role: "system",
            content: `
You are an expert herbal diagnostician. A user will give you:
• Their symptoms  
• Chosen categories  
• Severity (1–10)  
• Duration in days  

Provide:
1) A short introductory paragraph acknowledging the symptoms.  
2) One paragraph listing recommended herbs (with their dosages).  
3) One paragraph detailing any precautions or contraindications.  
Write in clear, complete sentences and separate each section into its own paragraph.
            `.trim()
          },
          {
            role: "user",
            content: `Symptoms: ${symptoms}
Categories: ${categories}
Severity: ${severity}
Duration: ${duration} days`
          }
        ]);
        panel.innerHTML = `<div class="result-content">${formatHTML(aiReply)}</div>`;
        localStorage.setItem("symResult", panel.innerHTML);
        addClose(panel);
        addTools(panel);
      } catch (err) {
        showFriendlyError(panel);
      }
    };


    wireForm({
      formId: "culture-form",
      systemPrompt: `
You are an expert in cultural herbalism and folklore. A user will give you a region, tradition, or herb name. Provide concise, culturally relevant practices, rituals, and folklore associated with that input. Format as short paragraphs or bullet points.
      `.trim(),
      inputExtractor: () => document.getElementById("cultureQuery").value.trim(),
      resultPanelId: "cultureResult"
    });


    wireForm({
      formId: "safety-form",
      systemPrompt: `
You are a safety expert in herbal and pharmaceutical interactions. Given two herbs or medications (Item A and Item B), determine if there are any known adverse interactions or contraindications. Respond with clear explanations, including references to known compounds if relevant.
      `.trim(),
      inputExtractor: () => {
        const a = document.getElementById("safetyA").value.trim();
        const b = document.getElementById("safetyB").value.trim();
        return `Item A: ${a}\nItem B: ${b}`;
      },
      resultPanelId: "safetyResult"
    });


    const chatBox = document.getElementById("chatBox");
    const sendChatBtn = document.getElementById("sendChat");
    const chatInput = document.getElementById("chatInput");
    const viewHistoryBtn = document.getElementById("viewHistory");
    const clearChatBtn = document.getElementById("clearChat");
    let lastDateHeader = null;

    let chatHistory = JSON.parse(localStorage.getItem("chatHistory") || "[]");
    function formatDateSeparator(date) {
      const today = new Date();
      const diffDays = Math.floor((today.setHours(0, 0, 0, 0) - date.setHours(0, 0, 0, 0)) / 86400000);
      if (diffDays === 0) return "Today";
      if (diffDays === 1) return "Yesterday";
      return date.toLocaleDateString();
    }

    function addMessage(who, text, timestamp = new Date()) {
      const msgDate = timestamp instanceof Date ? timestamp : new Date(timestamp);
      const msgDay = msgDate.toDateString();
      if (msgDay !== lastDateHeader) {
        const sep = document.createElement("div");
        sep.className = "chat-date-separator";
        sep.textContent = formatDateSeparator(msgDate);
        chatBox.append(sep);
        lastDateHeader = msgDay;
      }
      const msgDiv = document.createElement("div");
      msgDiv.className = who === "You" ? "user-msg" : "bot-msg";
      msgDiv.innerHTML = `
        ${formatHTML(text)}
      <div class="timestamp">${msgDate.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit", hour12: true })}</div>
      `;
      chatBox.append(msgDiv);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    chatHistory.forEach(m => addMessage(m.who, m.text, new Date(m.timestamp)));

   sendChatBtn.onclick = async () => {
      const userText = chatInput.value.trim();
      if (!userText) return;
      const userTime = new Date();
      addMessage("You", userText, userTime);
      chatHistory.push({ who: "You", text: userText, timestamp: new Date().toISOString() });
      localStorage.setItem("chatHistory", JSON.stringify(chatHistory));
      chatInput.value = "";

      const spinnerDiv = document.createElement("div");
      spinnerDiv.className = "bot-msg";
      spinnerDiv.innerHTML = `<div class="spinner"></div>`;
      chatBox.append(spinnerDiv);
      chatBox.scrollTop = chatBox.scrollHeight;

     const systemPrompt = `
You are a friendly, knowledgeable herbalist. A user will ask questions about herbs, remedies, dosages, or plant facts. Respond in plain language, giving clear instructions or information about herbal care.
      `.trim();

      const allMessages = [{ role: "system", content: systemPrompt }];
      chatHistory.forEach(m => {
        allMessages.push({
          role: m.who === "You" ? "user" : "assistant",
          content: m.text
        });
      });
      allMessages.push({ role: "user", content: userText });

      try {
        const aiReply = await callOpenAI(allMessages);
        const msgDate = new Date();
        spinnerDiv.innerHTML = `
          ${formatHTML(aiReply)}
          <div class="timestamp">${msgDate.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" })}</div>
        `;
        chatHistory.push({ who: "Herbalist", text: aiReply, timestamp: msgDate.toISOString() });
        localStorage.setItem("chatHistory", JSON.stringify(chatHistory));
      } catch (err) {
        spinnerDiv.innerHTML = `<div class="result-content">⚠️ Oops! Something went wrong. Please try again.</div>`;
      }
      chatBox.scrollTop = chatBox.scrollHeight;
    };

    clearChatBtn.onclick = () => {
      chatBox.innerHTML = "";
      lastDateHeader = null;
    };

    viewHistoryBtn.onclick = () => {
     const modal = document.createElement("div");
      modal.className = "history-modal";
       const grouped = {};
      chatHistory.forEach((m, i) => {
        const dt = new Date(m.timestamp);
        const label = formatDateSeparator(dt);
        if (!grouped[label]) grouped[label] = [];
        grouped[label].push({ who: m.who, text: m.text, idx: i });
      });

      let tableHTML = `<table class="history-table">`;
      Object.keys(grouped).forEach((label) => {
        tableHTML += `
          <thead>
            <tr><th colspan="3">${label}</th></tr>
            <tr>
              <th>Sender</th>
              <th>Message</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            ${grouped[label]
              .map(m =>
                `<tr data-index="${m.idx}">
                   <td>${m.who}</td>
                   <td>${formatHTML(m.text)}</td>
                   <td><button class="del-msg" data-index="${m.idx}" title="Delete"><i class="fas fa-trash-alt"></i></button></td>
                 </tr>`
              ).join("")}
          </tbody>`;
      });
      tableHTML += `</table>`;

      modal.innerHTML = `
        <div class="history-content">
          <h3>Chat History</h3>
          <div class="history-table-wrapper">
            ${tableHTML}
          </div>
          <div class="history-actions">
            <button class="clear-history"><i class="fas fa-trash"></i> Clear History</button>
            <button class="close-history"><i class="fas fa-times"></i> Close</button>
          </div>
        </div>`;
    document.body.append(modal);

      modal.querySelectorAll(".del-msg").forEach(btn => {
        btn.onclick = () => {
          const idx = +btn.dataset.index;
          chatHistory.splice(idx, 1);
          localStorage.setItem("chatHistory", JSON.stringify(chatHistory));
          const row = modal.querySelector(`tr[data-index="${idx}"]`);
          if (row) row.remove();

          modal.querySelectorAll(".history-table tbody tr").forEach((tr, i) => {
            tr.dataset.index = i;
            tr.querySelector(".del-msg").dataset.index = i;
          });
        };
      });

      modal.querySelector(".clear-history").onclick = () => {
        chatHistory = [];
        localStorage.removeItem("chatHistory");
        modal.remove();
      };
      modal.querySelector(".close-history").onclick = () => modal.remove();
    };


    (function() {
     const form = document.getElementById("pf-form");
     const panel = document.getElementById("pfResult");
     const systemPrompt = `
You are an expert herbal pharmacist. A user will provide one herb, age, and weight. Create a safe, personalized herbal formulation. Specify dosage, preparation method (e.g., tea, tincture), and any safety precautions. Use plain text bullet points.
     `.trim();
     form.onsubmit = async (e) => {
       e.preventDefault();
       panel.hidden = false;
       panel.innerHTML = '<div class="result-content">Processing… <span class="spinner"></span></div>';
       try {
         let herb = document.getElementById("pfHerbs").value;
         if (herb === "Other") {
           herb = document.getElementById("pfHerbsOther").value.trim();
         }
         const age = document.getElementById("pfAge").value;
         const weight = document.getElementById("pfWeight").value;
         const userContent = `Herb: ${herb}\nAge: ${age}\nWeight: ${weight} kg`;
         const aiReply = await callOpenAI([
           { role: "system", content: systemPrompt },
           { role: "user", content: userContent }
         ]);
         panel.innerHTML = `<div class="result-content">${formatHTML(aiReply)}</div>`;
         localStorage.setItem("pfResult", panel.innerHTML);
         addClose(panel);
         addTools(panel);
       } catch (err) {
         showFriendlyError(panel);
       }
     };
   })();


   (function() {
     const form = document.getElementById("research-form");
     const panel = document.getElementById("researchResults");
     const systemPrompt = `
You are an expert researcher specializing in herbal clinical studies. The user will provide study titles, abstracts, or keywords. Provide a concise, plain-text summary of the research, highlighting methodology, results, and conclusions. Include citations where appropriate.
     `.trim();
     form.onsubmit = async (e) => {
       e.preventDefault();
       panel.hidden = false;
       panel.innerHTML = '<div class="result-content">Processing… <span class="spinner"></span></div>';
       try {
         const userContent = document.getElementById("researchQuery").value.trim();
         const aiReply = await callOpenAI([
           { role: "system", content: systemPrompt },
           { role: "user", content: userContent }
         ]);
         panel.innerHTML = `<div class="result-content">${formatHTML(aiReply)}</div>`;
         localStorage.setItem("researchResults", panel.innerHTML);
         addClose(panel);
         addTools(panel);
       } catch (err) {
         showFriendlyError(panel);
       }
     };
   })();


   (function() {
     const form = document.getElementById("inventory-form");
     const panel = document.getElementById("inventoryResult");
     const systemPrompt = `
You are an experienced inventory analyst for herbal dispensaries. Given a herb name and a number of weeks, forecast weekly stock needs with buffer stock recommendations. Provide the answer as a short report with bullet points.
     `.trim();
     form.onsubmit = async (e) => {
       e.preventDefault();
       panel.hidden = false;
       panel.innerHTML = '<div class="result-content">Processing… <span class="spinner"></span></div>';
       try {
         let herb = document.getElementById("forecastHerb").value;
         if (herb === "Other") {
           herb = document.getElementById("forecastHerbOther").value.trim();
         }
         const weeks = document.getElementById("forecastPeriod").value;
         const userContent = `Herb: ${herb}\nWeeks Ahead: ${weeks}`;
         const aiReply = await callOpenAI([
           { role: "system", content: systemPrompt },
           { role: "user", content: userContent }
         ]);
         panel.innerHTML = `<div class="result-content">${formatHTML(aiReply)}</div>`;
         localStorage.setItem("inventoryResult", panel.innerHTML);
         addClose(panel);
         addTools(panel);
       } catch (err) {
         showFriendlyError(panel);
       }
     };
   })();


    document.getElementById("genetics-form").onsubmit = async (e) => {
      e.preventDefault();
      const panel = document.getElementById("geneticResult");
      panel.hidden = false;
      panel.innerHTML = '<div class="result-content">Processing… <span class="spinner"></span></div>';

      const fileInput = document.getElementById("geneticUpload");
      const file = fileInput.files[0];
      if (!file) {
        panel.innerHTML = '<div class="result-content">⚠️ Please upload a CSV or JSON file containing genetic SNP data.</div>';
        addClose(panel);
        return;
      }
      const allowedTypes = ["application/json", "text/csv"];
      if (!allowedTypes.includes(file.type)) {
        panel.innerHTML = '<div class="result-content">⚠️ Invalid file type. Upload a .csv or .json file.</div>';
        addClose(panel);
        return;
      }

      try {
        const fileText = await file.text();
        const aiReply = await callOpenAI([
          {
            role: "system",
            content: `
You are a genetics expert in herbal medicine. The user will upload a genetic report as CSV or JSON containing SNP data. Analyze the SNPs and recommend herbs tailored to their genetic profile. Provide evidence-level details: Tier 1 (strong evidence), Tier 2 (emerging). Format as bullet points.
            `.trim()
          },
          { role: "user", content: fileText }
        ]);
        panel.innerHTML = `<div class="result-content">${formatHTML(aiReply)}</div>`;
        localStorage.setItem("geneticResult", panel.innerHTML);
        addClose(panel);
        addTools(panel);
      } catch (err) {
        showFriendlyError(panel);
      }
    };


    (function() {
     const form = document.getElementById("dose-form");
     const panel = document.getElementById("dosageResult");
     const systemPrompt = `
You are a dosage calculation expert for herbal preparations. Given a user’s weight (in kg), symptom (e.g., headache), and extract form (powder, tincture, or capsule), calculate a safe daily dosage range. Provide the answer in plain text, specifying units (e.g., mg, ml) and any relevant safety notes.
     `.trim();
     form.onsubmit = async (e) => {
       e.preventDefault();
       panel.hidden = false;
       panel.innerHTML = '<div class="result-content">Processing… <span class="spinner"></span></div>';
       try {
         const weight = document.getElementById("weight").value;
         const symptom = document.getElementById("symptom").value.trim();
         let formType = document.getElementById("formType").value;
         if (formType === "Other") {
           formType = document.getElementById("formTypeOther").value.trim();
         }
         const userContent = `Weight: ${weight} kg\nSymptom: ${symptom}\nForm Type: ${formType}`;
         const aiReply = await callOpenAI([
           { role: "system", content: systemPrompt },
           { role: "user", content: userContent }
         ]);
         panel.innerHTML = `<div class="result-content">${formatHTML(aiReply)}</div>`;
         localStorage.setItem("dosageResult", panel.innerHTML);
         addClose(panel);
         addTools(panel);
       } catch (err) {
         showFriendlyError(panel);
       }
     };
   })();
    
 (function() {
     const form = document.getElementById("int-form");
     const panel = document.getElementById("interactionResult");
     const systemPrompt = `
You are a qualified pharmacologist specialized in herb-herb interactions. Given two herbs, evaluate if any known harmful interactions exist. Provide a clear explanation, including mechanisms if known, and any safety advice.
     `.trim();
     form.onsubmit = async (e) => {
       e.preventDefault();
       panel.hidden = false;
       panel.innerHTML = '<div class="result-content">Processing… <span class="spinner"></span></div>';
       try {
         const a = document.getElementById("herbA").value;
         const b = document.getElementById("herbB").value;
         if (a === b) {
           panel.innerHTML = '<div class="result-content">⚠️ Please select two distinct herbs.</div>';
           addClose(panel);
           return;
         }
         const aiReply = await callOpenAI([
           { role: "system", content: systemPrompt },
           { role: "user", content: `Herb A: ${a}\nHerb B: ${b}` }
         ]);
         panel.innerHTML = `<div class="result-content">${formatHTML(aiReply)}</div>`;
         localStorage.setItem("interactionResult", panel.innerHTML);
         addClose(panel);
         addTools(panel);
       } catch (err) {
         showFriendlyError(panel);
       }
     };
   })();


    document.getElementById("currency").onchange = (e) => {
      const symbolMap = { GHS: "₵", USD: "$", EUR: "€" };
      document.getElementById("curSym").textContent = symbolMap[e.target.value] || "";
    };

     document.getElementById("roi-form").onsubmit = async (e) => {
      e.preventDefault();
      const panel = document.getElementById("roiResult");
      panel.hidden = false;
      panel.innerHTML = '<div class="result-content">Calculating… <span class="spinner"></span></div>';

      const rxCount = +document.getElementById("roiRx").value;
      const cost = +document.getElementById("roiCost").value;
     let currency = document.getElementById("currency").value;
 if (currency === "Other") {
   currency = document.getElementById("currencyOther").value.trim();
 }
      if (!(rxCount > 0 && cost > 0)) {
        panel.innerHTML = '<div class="result-content">⚠️ Please enter positive numbers for prescriptions and cost.</div>';
        return;
      }

      try {
        const aiReply = await callOpenAI([
          {
            role: "system",
            content: `
You are a healthcare financial analyst. A user will provide:
1) Monthly AI-generated herb prescriptions (rxCount)
2) Average cost per prescription (cost)
3) Currency symbol (currency)

Calculate:
- Total monthly cost using AI (rxCount × cost)
- Estimate the cost if done via traditional manual methods (e.g., 25% higher than AI).
- Monthly savings = Traditional cost – AI cost
- ROI (%) = (Monthly savings / AI cost) × 100

Provide step-by-step calculations in plain text, using currency: ${currency}. 
Conclude with final ROI percentage and a short summary line.
            `.trim()
          },
          {
            role: "user",
            content: `Monthly Prescriptions: ${rxCount}\nAverage Cost: ${cost}`
          }
        ]);
        panel.innerHTML = `<div class="result-content">${formatHTML(aiReply)}</div>`;
        localStorage.setItem("roiResult", panel.innerHTML);
        addClose(panel);
        addTools(panel);
      } catch (err) {
        showFriendlyError(panel);
      }
    };

     function getCSSVar(name) {
    return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
  }

  function initRealCharts() {
    const colorText = getCSSVar("--text");
    const colorMuted = getCSSVar("--muted");

    new Chart("chartAdoption", {
      type: "line",
      data: {
        labels: ["January","February","March","April","May","June","July"],
        datasets: [{
          label: "New Users",
          data: [45, 60, 80, 95, 120, 135, 150],
          borderColor: getCSSVar("--primary"),
          backgroundColor: "rgba(58,118,84,0.1)",
          fill: true
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: { 
            ticks: { color: colorText },
            grid: { display: false }
          },
          y: {
            ticks: { color: colorText },
            grid: { color: colorMuted }
          }
        },
        plugins: {
          legend: { display: false }
        }
      }
    });

    new Chart("chartEfficacy", {
      type: "bar",
      data: {
        labels: ["Ashwagandha","Turmeric","Ginger","Chamomile"],
        datasets: [{
          data: [78, 85, 72, 90],
          backgroundColor: [
            "rgba(42,111,78,0.7)",
            "rgba(142,108,75,0.7)",
            "rgba(212,197,162,0.7)",
            "rgba(42,111,78,0.4)"
          ]
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: { ticks: { color: colorText }, grid: { display: false } },
          y: { ticks: { color: colorText }, grid: { color: colorMuted }, beginAtZero: true, max: 100 }
        },
        plugins: {
          legend: { display: false }
        }
      }
    });

    new Chart("chartSupply", {
      type: "pie",
      data: {
        labels: ["Turmeric","Moringa","Ginger","Hibiscus"],
        datasets: [{
          data: [120, 95, 80, 60],
          backgroundColor: [
            "rgba(142,108,75,0.7)",
            "rgba(42,111,78,0.7)",
            "rgba(212,197,162,0.7)",
            "rgba(42,111,78,0.4)"
          ]
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: "bottom",
            labels: { color: colorText }
          }
        }
      }
    });

    new Chart("chartROI", {
      type: "radar",
      data: {
        labels: ["Q1","Q2","Q3","Q4"],
        datasets: [{
          label: "ROI (%)",
          data: [12, 18, 22, 15],
          borderColor: getCSSVar("--secondary"),
          backgroundColor: "rgba(142,108,75,0.2)"
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          r: {
            angleLines: { color: colorMuted },
            grid: { color: colorMuted },
            pointLabels: { color: colorText }
          }
        },
        plugins: {
          legend: { display: false }
        }
      }
    });
  }

  document.getElementById("exportCSV").addEventListener("click", () => {
    const charts = [
      {
        id: "Adoption",
        desc: "Adoption Over Time: New AI users each month",
        labels: ["January","February","March","April","May","June","July"],
        values: [45, 60, 80, 95, 120, 135, 150]
      },
      {
        id: "Efficacy",
        desc: "Efficacy Outcomes: Positive feedback % per herb",
        labels: ["Ashwagandha","Turmeric","Ginger","Chamomile"],
        values: [78, 85, 72, 90]
      },
      {
        id: "Supply",
        desc: "Inventory Impact: Weekly usage (kg) of top herbs",
        labels: ["Turmeric","Moringa","Ginger","Hibiscus"],
        values: [120, 95, 80, 60]
      },
      {
        id: "ROI",
        desc: "Financial ROI: Quarterly ROI (%)",
        labels: ["Q1","Q2","Q3","Q4"],
        values: [12, 18, 22, 15]
      }
    ];
    let csvContent = "Chart,Description,Label,Value\n";
    charts.forEach(ch => {
      ch.labels.forEach((lab, idx) => {
        csvContent += `"${ch.id}","${ch.desc}","${lab}",${ch.values[idx]}\n`;
      });
    });
    const blob = new Blob([csvContent], { type: "text/csv" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "analytics_full.csv";
    document.body.append(a);
    a.click();
    URL.revokeObjectURL(url);
    a.remove();
  });

  
    document.querySelectorAll(".response .close-btn").forEach((btn) => {
      btn.onclick = () => {
        const panel = btn.closest(".response");
        if (panel) panel.hidden = true;
      };
    });
      ["idenResult","symResult","cultureResult","safetyResult",
   "pfResult","researchResults","inventoryResult","geneticResult",
   "dosageResult","interactionResult","roiResult"]
  .forEach(id => {
    const panel = document.getElementById(id);
    const saved = localStorage.getItem(id);
    if (saved) {
      panel.innerHTML = saved;
      panel.hidden = false;

      addClose(panel);
      addTools(panel);
      panel.querySelectorAll(".close-btn").forEach(btn => btn.onclick = () => panel.hidden = true);
      panel.querySelectorAll(".copy-btn").forEach(cb => {
        cb.onclick = () => {
          const content = panel.querySelector(".result-content").innerText;
          navigator.clipboard.writeText(content);
          const t = document.createElement("div");
          t.className = "copy-toast";
          t.textContent = "Copied!";
          document.body.append(t);
          setTimeout(() => t.remove(), 1500);
        };
      });
      panel.querySelectorAll(".dl-btn").forEach(db => {
        db.onclick = () => {
          const text = panel.querySelector(".result-content").innerText;
          const blob = new Blob([text], { type: "text/plain" });
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = "response.txt";
          document.body.append(a);
          a.click();
          URL.revokeObjectURL(url);
          a.remove();
        };
      });
    }
  });
  });
</script>
<script>
  window.addEventListener("load", () => {
    if (typeof initRealCharts === "function") {
      initRealCharts();
    }
  });
</script>


<script>
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll('aside#sidebar nav a').forEach((link) => {

      const linkHref = link.getAttribute("href").split("/").pop(); 
      const pageNow = window.location.pathname.split("/").pop();   
      if (linkHref === pageNow) {
        link.classList.add("active");
      } else {
        link.classList.remove("active");
      }
    });
  });
</script>

<script>

  function getCSSVar(name) {
    return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
  }

  function initRealCharts() {
    const colorText = getCSSVar("--text");
    const colorMuted = getCSSVar("--muted");

    new Chart("chartAdoption", {
      type: "line",
      data: {
        labels: ["January","February","March","April","May","June","July"],
        datasets: [{
          label: "New Users",
          data: [45, 60, 80, 95, 120, 135, 150],
          borderColor: getCSSVar("--primary"),
          backgroundColor: "rgba(58,118,84,0.1)",
          fill: true
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: { 
            ticks: { color: colorText },
            grid: { display: false }
          },
          y: {
            ticks: { color: colorText },
            grid: { color: colorMuted }
          }
        },
        plugins: {
          legend: { display: false }
        }
      }
    });

    new Chart("chartEfficacy", {
      type: "bar",
      data: {
        labels: ["Ashwagandha","Turmeric","Ginger","Chamomile"],
        datasets: [{
          data: [78, 85, 72, 90],
          backgroundColor: [
            "rgba(42,111,78,0.7)",
            "rgba(142,108,75,0.7)",
            "rgba(212,197,162,0.7)",
            "rgba(42,111,78,0.4)"
          ]
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: { ticks: { color: colorText }, grid: { display: false } },
          y: { ticks: { color: colorText }, grid: { color: colorMuted }, beginAtZero: true, max: 100 }
        },
        plugins: {
          legend: { display: false }
        }
      }
    });

    new Chart("chartSupply", {
      type: "pie",
      data: {
        labels: ["Turmeric","Moringa","Ginger","Hibiscus"],
        datasets: [{
          data: [120, 95, 80, 60],
          backgroundColor: [
            "rgba(142,108,75,0.7)",
            "rgba(42,111,78,0.7)",
            "rgba(212,197,162,0.7)",
            "rgba(42,111,78,0.4)"
          ]
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: "bottom",
            labels: { color: colorText }
          }
        }
      }
    });

    new Chart("chartROI", {
      type: "radar",
      data: {
        labels: ["Q1","Q2","Q3","Q4"],
        datasets: [{
          label: "ROI (%)",
          data: [12, 18, 22, 15],
          borderColor: getCSSVar("--secondary"),
          backgroundColor: "rgba(142,108,75,0.2)"
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          r: {
            angleLines: { color: colorMuted },
            grid: { color: colorMuted },
            pointLabels: { color: colorText }
          }
        },
        plugins: {
          legend: { display: false }
        }
      }
    });
  }

  window.addEventListener("load", () => {
    if (typeof Chart !== "undefined" && document.getElementById("chartAdoption")) {
      initRealCharts();
    }
  });
</script>
</body>
</html>
