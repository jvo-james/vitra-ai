<!DOCTYPE html>
<html lang="en" aria-theme="light">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Vitra AI – Herbal Medicine Hub</title>
  
<!-- Montserrat + FontAwesome -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet"/>
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const links = document.querySelectorAll("aside nav a[href^='#']");
  const sections = [...links].map(link => document.querySelector(link.getAttribute("href")));

  window.addEventListener("scroll", () => {
    let index = sections.findIndex(section => section.offsetTop > window.scrollY + 100);
    if (index === -1) index = sections.length;
    document.querySelectorAll("aside nav a").forEach(a => a.classList.remove("active"));
    if (sections[index - 1])
      document.querySelector(`aside nav a[href="#${sections[index - 1].id}"]`)?.classList.add("active");
  });
});
</script>

<style>
/*───────────────────────────────────────────────────────────────────────────
  1) RESET & BASE
────────────────────────────────────────────────────────────────────────────*/
*, *::before, *::after {
  margin:0; padding:0; box-sizing:border-box;
}
html { font-family: 'Montserrat', sans-serif; font-size:16px; scroll-behavior:smooth; }
body {
  display:flex; min-height:100vh;
  background:var(--bg); color:var(--text);
  overflow-x:hidden; transition:background .3s, color .3s;
}
a { color:inherit; text-decoration:none; }
ul { list-style:none; }
img { max-width:100%; display:block; }
button { font-family:inherit; }

/*───────────────────────────────────────────────────────────────────────────
  2) THEME VARIABLES
────────────────────────────────────────────────────────────────────────────*/
:root {
  /* Palette */
  --primary: #2a6f4e;
  --primary-light: #3b8562;
  --secondary: #8e6c4b;
  --accent: #d4c5a2;
  --bg: #f8f6f0;
  --surface: #fff;
  --text: #333;
  --muted: #666;
  /* Dark overrides */
  --bg-dark: #1f1f1f;
  --surface-dark: #2a2a2a;
  --text-dark: #ececec;
  --muted-dark: #888;
  /* Layout */
  --radius: .75rem;
  --padding: 1rem;
  --transition: .3s ease;
  --sidebar-w: 280px;
  --sidebar-collapsed-w: 80px;
  --header-h: 64px;
}
html.dark {
  --bg: var(--bg-dark);
  --surface: var(--surface-dark);
  --text: var(--text-dark);
  --muted: var(--muted-dark);
}

/*───────────────────────────────────────────────────────────────────────────
  3) SIDEBAR
────────────────────────────────────────────────────────────────────────────*/
aside {
  width: var(--sidebar-w);
  background: linear-gradient(180deg, var(--primary) 0%, var(--primary-light) 100%);
  color: #fff;
  position: sticky; top:0; height:100vh;
  transition: width var(--transition);
  overflow:hidden; z-index:1000;
}
aside.collapsed { width: var(--sidebar-collapsed-w); }
aside .brand {
  display:flex; align-items:center; gap:.75rem;
  padding:var(--padding);
  font-size:1.4rem; font-weight:700;
}
aside .brand i { font-size:1.6rem; }
aside .brand span { transition:opacity var(--transition); }
aside.collapsed .brand span { opacity:0; }
aside nav { margin-top:2rem; }
aside nav a {
  display:flex; align-items:center; gap:1rem;
  padding:.75rem var(--padding);
  color:#fff; opacity:.9;
  transition: background var(--transition), padding-left var(--transition), opacity var(--transition);
}
aside nav a.active,
aside nav a:hover {
  background: rgba(255,255,255,0.15);
  padding-left: calc(var(--padding)+.5rem);
  opacity:1;
}
aside nav a i { width:1.2rem; text-align:center; }
aside.collapsed nav a span { display:none; }
#shrinkBtn {
  position:absolute; bottom: var(--padding); right: -18px;
  width:36px; height:36px; background: #fff; color: var(--primary);
  border:none; border-radius:50%;
  box-shadow:0 2px 6px rgba(0,0,0,0.2);
  transition: transform var(--transition);
}
#shrinkBtn:hover { transform: scale(1.1); }

/*───────────────────────────────────────────────────────────────────────────
  4) HEADER
────────────────────────────────────────────────────────────────────────────*/
header {
  position: fixed; top:0; left:var(--sidebar-w); right:0;
  height: var(--header-h);
  background: var(--surface); box-shadow:0 2px 6px rgba(0,0,0,0.1);
  display:flex; align-items:center; justify-content:space-between;
  padding: 0 var(--padding); transition:left var(--transition);
  z-index:900;
}
aside.collapsed + header { left: var(--sidebar-collapsed-w); }
header h1 { font-size:1.5rem; color:var(--text); }
header .hamburger, header .theme-toggle {
  font-size:1.4rem; color:var(--primary); cursor:pointer;
  transition:transform var(--transition);
}
header .hamburger:hover, header .theme-toggle:hover { transform: scale(1.1); }

/*───────────────────────────────────────────────────────────────────────────
  5) MAIN LAYOUT
────────────────────────────────────────────────────────────────────────────*/
main {
  flex:1; padding: calc(var(--header-h)+var(--padding)) var(--padding);
  background: var(--bg);
}

/*───────────────────────────────────────────────────────────────────────────
  6) HERO
────────────────────────────────────────────────────────────────────────────*/
.hero-module {
  display:grid; grid-template-columns: 1fr 1fr;
  align-items:center; gap:2rem;
  background: var(--surface); border-radius:var(--radius);
  padding:3rem; position:relative; overflow:hidden;
  box-shadow:0 4px 12px rgba(0,0,0,0.05);
}
.hero-module .hero-bg-icon {
  position:absolute; font-size:8rem; opacity:.1;
  color: var(--primary); pointer-events:none;
}
html.dark .hero-bg-icon { color: var(--accent); opacity:.08; }
.hero-module .hero-image { border-radius:var(--radius); overflow:hidden; }
.hero-module .hero-image img {
  width:100%; height:100%; object-fit:cover;
}
.hero-module .hero-content h1 {
  font-size:2.75rem; margin-bottom:1rem; color:var(--primary);
}
.hero-module .hero-content p {
  color:var(--muted); font-size:1.1rem; margin-bottom:2rem;
}
.hero-actions {
  display:flex; gap:1rem; flex-wrap:wrap;
}
.hero-actions a {
  display:flex; align-items:center; gap:.5rem;
  padding:.75rem 1.5rem; border-radius:var(--radius);
  font-weight:600; transition:background var(--transition),transform var(--transition);
}
.hero-actions .btn-primary { background: var(--primary); color:#fff; }
.hero-actions .btn-secondary { background: var(--secondary); color:#fff; }
.hero-actions .btn-tertiary {
  background: var(--bg); border:2px solid var(--primary); color:var(--primary);
}
.hero-actions a:hover {
  transform: translateY(-3px); box-shadow:0 6px 16px rgba(0,0,0,0.1);
}
@media(max-width:768px) {
  .hero-module { grid-template-columns: 1fr; text-align:center; }
}

/*───────────────────────────────────────────────────────────────────────────
  7) MODULE HEADINGS & DESCRIPTIONS
────────────────────────────────────────────────────────────────────────────*/
.module h2 {
  display:flex; align-items:center; gap:.75rem;
  font-size:1.5rem; color:var(--primary);
}
.module p.desc { color:var(--muted); margin-bottom:1rem; }

/*───────────────────────────────────────────────────────────────────────────
  8) FORMS & CONTROLS
────────────────────────────────────────────────────────────────────────────*/
form { display:flex; flex-wrap:wrap; gap:1rem; align-items:flex-end; }
form .field { display:flex; flex-direction:column; flex:1 1 200px; }
label { margin-bottom:.5rem; font-weight:500; color:var(--text); }
input, select, textarea {
  padding:.75rem; border:1px solid #d1dce5; border-radius:var(--radius);
  background:var(--bg); color:var(--text); transition:border-color var(--transition);
}
input:focus, select:focus, textarea:focus {
  border-color:var(--primary); box-shadow:0 0 6px var(--primary);
}
button { 
  background:var(--primary); color:#fff; border:none;
  padding:.75rem 1.5rem; border-radius:var(--radius);
  transition:transform var(--transition),box-shadow var(--transition);
}
button:hover:not([disabled]) {
  transform:scale(1.05); box-shadow:0 4px 14px rgba(0,0,0,0.1);
}
.hint { width:100%; font-size:.85rem; color:var(--muted); }

/*───────────────────────────────────────────────────────────────────────────
  9) SYMPTOM CHECKER GRID
────────────────────────────────────────────────────────────────────────────*/
.sym-form {
  display:grid;
  grid-template:
    "a b" auto
    "c d" auto
    "e e" auto / 1fr 1fr;
  gap:1rem;
}
.sym-form .field:nth-child(1) { grid-area:a; }
.sym-form .field:nth-child(2) { grid-area:b; }
.range-field { grid-area:c; display:flex; align-items:center; gap:.5rem; }
.sym-form .field:nth-child(4) { grid-area:d; }
.sym-form button { grid-area:e; justify-self:center; }

/*───────────────────────────────────────────────────────────────────────────
 10) CULTURAL, SAFETY, RESEARCH, INVENTORY, ETC.
     — they all inherit .module, form, button, .response styles above
────────────────────────────────────────────────────────────────────────────*/

/*───────────────────────────────────────────────────────────────────────────
 11) RESPONSE PANELS & TOOLS
────────────────────────────────────────────────────────────────────────────*/
.response {
  position:relative; background:rgba(142,108,75,0.1);
  border-left:4px solid var(--secondary); padding:var(--padding);
  border-radius:var(--radius); margin-top:1rem;
}
.response .close-btn {
  position:absolute; top:.5rem; right:.5rem; background:none;
  border:none; font-size:1.2rem; color:var(--secondary); cursor:pointer;
}
.tool-row {
  position:absolute; bottom:.5rem; right:.5rem; display:flex; gap:.5rem;
}
.tool-row button { font-size:.85rem; width:1.6rem; height:1.6rem; }

/*───────────────────────────────────────────────────────────────────────────
 12) CHAT
────────────────────────────────────────────────────────────────────────────*/
.chat-box {
  background:var(--surface); border:1px solid #d1dce5;
  border-radius:var(--radius); padding:var(--padding);
  max-height:300px; overflow-y:auto; display:flex; flex-direction:column; gap:.5rem;
}
.user-msg, .bot-msg {
  max-width:70%; padding:.75rem; border-radius:var(--radius);
  position:relative; word-wrap:break-word;
}
.user-msg { align-self:flex-end; background:var(--primary); color:#fff; border-bottom-right-radius:0; }
.bot-msg { align-self:flex-start; background:var(--surface); color:var(--text); border-bottom-left-radius:0; }
.chat-controls { display:flex; gap:.5rem; margin-bottom:.5rem; }
.chat-input { display:flex; gap:.5rem; }
.chat-input input { flex:1; border-radius:var(--radius) 0 0 var(--radius); }
.chat-input button { border-radius:0 var(--radius) var(--radius) 0; }

/*───────────────────────────────────────────────────────────────────────────
 13) CHARTS
────────────────────────────────────────────────────────────────────────────*/
.charts {
  display:grid; grid-template-columns: repeat(2,1fr); gap:1rem;
}
.chart-card {
  display:flex; flex-direction:column;
  border:1px solid var(--muted); border-radius:var(--radius);
  overflow:hidden; height:250px;
}
.chart-card canvas {
  flex:1; width:100%; height:100%;
}

/*───────────────────────────────────────────────────────────────────────────
 14) FOOTER
────────────────────────────────────────────────────────────────────────────*/
footer {
  background:var(--surface); text-align:center; padding:var(--padding);
  border-top:1px solid rgba(0,0,0,0.05); color:var(--muted); font-size:.85rem;
}

/*───────────────────────────────────────────────────────────────────────────
 15) RESPONSIVE
────────────────────────────────────────────────────────────────────────────*/
@media(max-width:1024px) {
  aside { position:fixed; left:-100%; }
  aside.open { left:0; }
  header { left:0;}
}
@media(max-width:768px) {
  .hero-module { grid-template-columns:1fr; }
  .charts { grid-template-columns:1fr; }
}
@media(max-width:480px) {
  header h1 { font-size:1.2rem; }
  .hero-module h1 { font-size:2rem; }
  .hero-module p { font-size:.95rem; }
  button { padding:.6rem 1rem; }
}
</style>




</head>

<body>

  <!-- SIDEBAR -->
  <aside id="sidebar">
    <div class="brand"><i class="fas fa-leaf"></i><span>Vitra AI</span></div>
    <nav role="navigation">
    <a href="herbal.html" class="active"><i class="fas fa-seedling"></i><span>Herbal Medicine</span></a>
    <a href="mental.html"><i class="fas fa-brain"></i><span>Psychology & Mental Health</span></a>
    <a href="dietetics.html"><i class="fas fa-utensils"></i><span>Dietetics</span></a>
    <a href="pharmacy.html"><i class="fas fa-prescription-bottle-alt"></i><span>E-Pharmacy</span></a>
    <a href="consult.html"><i class="fas fa-calendar-check"></i><span>Consultation Booking</span></a>
      <button id="shrinkBtn" aria-label="Toggle sidebar"><i class="fas fa-angle-double-left"></i></button>
    </nav>
  </aside>

  <!-- HEADER -->
  <header>
    <div style="display:flex; align-items:center; gap:1rem;">
      <i id="hamburger" class="fas fa-bars hamburger" aria-label="Toggle navigation"></i>
      <h1>Herbal Medicine Hub</h1>
    </div>
    <div>
      <i id="themeToggle" class="fas fa-moon theme-toggle" aria-label="Toggle theme"></i>
    </div>
  </header>

  <!-- MAIN CONTENT -->
  <main role="main">
    <!--  Hero -->
   <section id="hero" class="module hero-module">
     <!-- background icons -->
 <i class="fas fa-seedling hero-bg-icon" style="top: 8%; left: 7%;"></i>        
  <i class="fas fa-leaf     hero-bg-icon" style="top: 5%; right: 9%;"></i>      
  <i class="fas fa-flask    hero-bg-icon" style="bottom: 10%; left: 12%;"></i>   
  <i class="fas fa-stethoscope hero-bg-icon" style="bottom: 8%; right: 15%;"></i> 
  <i class="fas fa-chart-line  hero-bg-icon" style="top: 45%; left: 45%;"></i>  
 <div class="hero-image" data-aos="zoom-in">
    <img src="herbs.webp" alt="AI-Powered Herbal Medicine">
  </div>
  <div class="hero-content" data-aos="fade-left">
    <h1>AI-Powered Herbal Medicine Hub</h1>
    <p>Discover plant ID, custom formulations, and more—all powered by AI.</p>
    <div class="hero-actions">
      <a href="#hero–identifier" class="btn-primary"><i class="fas fa-camera"></i> Scan a Plant</a>
      <a href="#hero-symptom" class="btn-secondary"><i class="fas fa-notes-medical"></i> Check Symptoms</a>
      <a href="#hero–chat" class="btn-tertiary"><i class="fas fa-comments"></i> Chat with Herbalist</a>
    </div>
  </div>
</section>

  

    <!-- 1. Herb Identifier -->
    <section id="hero–identifier" class="module">
      <h2><i class="fas fa-camera"></i> AI Plant Scanner</h2>
      <p class="desc">Upload a photo; our AI will identify the plant (e.g. <em>Moringa oleifera</em> placeholder).</p>
      <form id="iden-form">
        <textarea id="idenDesc" rows="2" placeholder="Or describe your plant here…"></textarea>
        <input type="file" accept="image/*" aria-label="Upload plant image" onchange="previewImage(this)"/>
        <button type="submit">Identify</button>
        <div class="hint">Use a clear close-up of a leaf or flower.</div>
      </form>
      <img id="idenPreview" alt="" style="max-width:200px;margin-top:1rem;display:none;"/>
      <div id="idenResult" class="response" role="status" aria-live="polite" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
      </div>
    </section>

    <!-- 2. Symptom Checker -->
    <section id="hero-symptom" class="module">
      <h2><i class="fas fa-notes-medical"></i> Symptom Checker</h2>
      <p class="desc">Tell us your symptoms and duration, choose severity, then get AI‐powered herb recommendations.</p>
      <form id="sym-form" class="sym-form">
        <div class="field">
          <label for="symInput">Your Symptoms</label>
          <textarea id="symInput" required placeholder="e.g. headache, nausea…"></textarea>
        </div>
        <div class="field">
          <label for="symCategories">Category</label>
          <select id="symCategories" multiple size="4" required>
            <option disabled selected>Select category…</option>
            <option value="pain">Pain</option>
            <option value="digestive">Digestive</option>
            <option value="respiratory">Respiratory</option>
            <option value="stress">Stress</option>
  <option value="sleep">Sleep</option>
  <option value="energy">Energy</option>
  <option value="immune">Immune</option>
  <option value="skin">Skin</option>
  <option value="mental">Mental</option>
  <option value="cardio">Cardio</option>
 
          </select>
        </div>
        <div class="field range-field">
          <label for="severity">Severity</label>
          <input type="range" id="severity" min="1" max="10" value="5"/>
          <span id="sevValue">5</span>/10
        </div>
        <div class="field">
          <label for="symDuration">Duration (days)</label>
          <input type="number" id="symDuration" min="0" placeholder="e.g. 3"/>
        </div>
        <button type="submit" class="btn-primary">Get Recommendations</button>
      </form>
      <div id="symResult" class="response sym-response" hidden>
        <button class="close-btn">×</button>
        <div class="result-content"></div>
      </div>
    </section>

    <!-- 3. Cultural Knowledge -->
    <section id="hero–cultural" class="module">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
        <h2>🌍 Cultural Knowledge</h2>
      </div>
      <p class="desc">Enter a region, tradition or herb name to get practices, rituals & folklore.</p>
      <div class="culture-input-wrapper" style="display:flex; gap:0.5rem; align-items:flex-end; margin-bottom:1rem;">
        <input id="cultureQuery" type="text" placeholder="e.g. West African herbal uses…" />
        <button id="btnCulture" class="btn-culture">Get Insights</button>
      </div>
      <div id="cultureResult" class="response" hidden>
        <button class="close-btn">×</button>
        <div class="result-content"></div>
      </div>
    </section>

    <!-- 4. Safety Checker -->
    <section id="hero–safety" class="module">
      <h2><i class="fas fa-shield-alt"></i> Safety Checker</h2>
      <p class="desc">Enter two items (herbs or medications) to check for dangerous interactions.</p>
      <form id="safety-form">
        <input id="safetyA" placeholder="Item A (e.g. Turmeric)" aria-label="Item A" required/>
        <input id="safetyB" placeholder="Item B (e.g. Warfarin)" aria-label="Item B" required/>
        <button type="submit">Check</button>
        <div class="hint">Pick two distinct items.</div>
      </form>
      <div id="safetyResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
      </div>
    </section>

    <!-- 5. AI Herbalist Chat -->
     <section id="drugChatbot" class="module">
      <h2><i class="fas fa-comments"></i> AI Herbalist Chat</h2>
      <p class="desc">      <p class="desc">Ask about herbal remedies:</p>
      <div class="chat-controls">
        <button id="clearPharmaChat" class="btn-secondary"><i class="fas fa-trash"></i> Clear</button>
         <button id="historyBtn" class="btn" style="margin-bottom:0.5rem;">
      <i class="fas fa-history"></i> History
         </button>
      </div>
      <div id="pharmaChatBox" class="chat-box"></div>
      <form id="pharma-form" class="chat-input">
        <input id="pharmaInput" type="text" placeholder="Ask me anything about Herbal medicine…">
        <button id="sendPharma" class="btn"><i class="fas fa-paper-plane"></i></button>
      </form>
    </section>

  

    <!-- 6. Personalized Formulations -->
    <section id="formulations" class="module">
      <h2><i class="fas fa-user-shield"></i> Personalized Formulations</h2>
      <p class="desc">Pick one herb, age & weight for a custom blend.</p>
      <form id="pf-form">
        <select id="pfHerbs" aria-label="Select herb" required>
          <option disabled selected>Select herb…</option>
          <option>Ashwagandha</option>
          <option>Astragalus</option>
          <option>Basil</option>
          <option>Chamomile</option>
          <option>Echinacea</option>
          <option>Ginkgo Biloba</option>
          <option>Ginseng</option>
          <option>Lavender</option>
          <option>Licorice</option>
          <option>Milk Thistle</option>
          <option>Neem</option>
          <option>Oregano</option>
          <option>Peppermint</option>
          <option>Rosemary</option>
          <option>St. John’s Wort</option>
          <option>Turmeric</option>
          <option>Valerian</option>
          <!-- 7 Ghanaian local herbs -->
          <option>Roselle</option>
          <option>Soursop</option>
          <option>Baobab</option>
          <option>Moringa</option>
          <option>Ginger</option>
          <option>Hibiscus</option>
          <option>Holy Basil</option>
        </select>
        <input id="pfAge" type="number" min="1" max="120" placeholder="Age (years)" required/>
        <input id="pfWeight" type="number" min="10" max="300" placeholder="Weight (kg)" required/>
        <button type="submit">Generate</button>
        <div class="hint">Use dropdown to pick a single herb.</div>
      </form>
      <div id="pfResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
        <p class="hint"><em>Formulation meets dosage safety limits.</em></p>
      </div>
    </section>

    <!-- 7. Research Summaries -->
    <section id="research" class="module">
      <h2><i class="fas fa-book-reader"></i> Research Summaries</h2>
      <p class="desc">Paste study titles or keywords for a concise summary.</p>
      <form id="research-form">
        <input id="researchQuery" placeholder="e.g. ‘Ashwagandha anxiety RCT’" aria-label="Research query" required/>
        <button type="submit">Generate Summary</button>
        <div class="hint">Include herb and focus area.</div>
      </form>
      <div id="researchResults" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
        <a href="#" target="_blank">Read Original Study</a>
      </div>
    </section>

    <!-- 8. Inventory Forecast -->
    <section id="inventory" class="module">
      <h2><i class="fas fa-warehouse"></i> Inventory Forecast</h2>
      <p class="desc">Predict stock needs weeks ahead.</p>
      <form id="inventory-form">
        <select id="forecastHerb" aria-label="Select one herb for inventory forecast" required>
          <option disabled selected>Select herb…</option>
          <!-- same options as PF -->
          <option>Ashwagandha</option>
          <option>Astragalus</option>
          <option>Basil</option>
          <option>Chamomile</option>
          <option>Echinacea</option>
          <option>Ginkgo Biloba</option>
          <option>Ginseng</option>
          <option>Lavender</option>
          <option>Licorice</option>
          <option>Milk Thistle</option>
          <option>Neem</option>
          <option>Oregano</option>
          <option>Peppermint</option>
          <option>Rosemary</option>
          <option>St. John’s Wort</option>
          <option>Turmeric</option>
          <option>Valerian</option>
          <option>Roselle</option>
          <option>Soursop</option>
          <option>Baobab</option>
          <option>Moringa</option>
          <option>Ginger</option>
          <option>Hibiscus</option>
          <option>Holy Basil</option>
        </select>
        <input id="forecastPeriod" type="number" min="1" max="52" value="4" placeholder="Weeks ahead" required/>
        <button type="submit">Forecast</button>
        <div class="hint">Choose 1–52 weeks into the future.</div>
      </form>
      <div id="inventoryResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
      </div>
    </section>

    <!-- 9. Genetics Match -->
    <section id="genetics" class="module">
      <h2><i class="fas fa-dna"></i> Genetics Match</h2>
      <p class="desc">Upload your genetic report for tailored herb recommendations.</p>
      <form id="genetics-form">
        <input id="geneticUpload" type="file" accept=".csv,.json" aria-label="Upload genetic report"/>
        <button type="submit">Analyze</button>
        <div class="hint">CSV or JSON with SNP data is ideal.</div>
      </form>
      <div id="geneticResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
        <p class="hint"><em>Tier 1: evidence-based, Tier 2: emerging science.</em></p>
      </div>
    </section>

    <!-- 10. Dosage Calculator -->
    <section id="dosage" class="module">
      <h2><i class="fas fa-calculator"></i> Dosage Calculator</h2>
      <p class="desc">Get daily dosage advice based on weight, symptom, and extract form.</p>
      <form id="dose-form">
        <input id="weight" type="number" min="10" max="300" placeholder="Weight (kg)" required/>
        <input id="symptom" placeholder="Symptom (e.g. headache)" required/>
        <select id="formType" aria-label="Select extract type">
          <option value="powder">Powder</option>
          <option value="tincture">Tincture</option>
          <option value="capsule">Capsule</option>
        </select>
        <button type="submit">Calculate</button>
        <div class="hint">Specify extract form for accuracy.</div>
      </form>
      <div id="dosageResult" class="response" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
      </div>
    </section>

    <!-- 11. Interaction Checker -->
    <section id="interaction" class="module">
      <h2><i class="fas fa-exchange-alt"></i> Interaction Checker</h2>
      <p class="desc">Select two herbs to check for interactions.</p>
      <form id="int-form">
        <select id="herbA" aria-label="Herb A" required>
          <option disabled selected>Herb A…</option>
          <option>Ashwagandha</option>
          <option>Baobab</option>
          <option>Basil</option>
          <option>Chamomile</option>
          <option>Echinacea</option>
          <option>Ginger</option>
          <option>Ginkgo Biloba</option>
          <option>Ginseng</option>
          <option>Hibiscus</option>
          <option>Holy Basil</option>
          <option>Lavender</option>
          <option>Licorice</option>
          <option>Milk Thistle</option>
          <option>Neem</option>
          <option>Moringa</option>
          <option>Oregano</option>
          <option>Peppermint</option>
          <option>Rosemary</option>
          <option>St. John’s Wort</option>
          <option>Turmeric</option>
          <option>Valerian</option>
        </select>
        <select id="herbB" aria-label="Herb B" required>
          <option disabled selected>Herb B…</option>
          <option>Ashwagandha</option>
          <option>Baobab</option>
          <option>Basil</option>
          <option>Chamomile</option>
          <option>Echinacea</option>
          <option>Ginger</option>
          <option>Ginkgo Biloba</option>
          <option>Ginseng</option>
          <option>Hibiscus</option>
          <option>Holy Basil</option>
          <option>Lavender</option>
          <option>Licorice</option>
          <option>Milk Thistle</option>
          <option>Neem</option>
          <option>Moringa</option>
          <option>Oregano</option>
          <option>Peppermint</option>
          <option>Rosemary</option>
          <option>St. John’s Wort</option>
          <option>Turmeric</option>
          <option>Valerian</option>
        </select>
        <button type="submit">Check</button>
        <div class="hint">Pick two distinct herbs.</div>
      </form>
      <div id="interactionResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
      </div>
    </section>

  

    <!-- 12. ROI Calculator -->
    <section id="roi" class="module">
      <h2><i class="fas fa-dollar-sign"></i> Business Insights & ROI Calculator</h2>
      <p class="desc">
        Estimate your practice’s return on investment from AI-driven herbal prescription automation.
        Select your currency, enter your monthly prescription volume and herb costs, then calculate ROI.
      </p>
      <form id="roi-form">
        <div class="field">
          <label for="currency">Currency</label>
          <select id="currency">
            <option value="GHS" selected>Ghanaian Cedi (GHS)</option>
            <option value="USD">US Dollar (USD)</option>
            <option value="EUR">Euro (EUR)</option>
          </select>
        </div>
        <div class="field">
          <label for="roiRx">Monthly Prescriptions</label>
          <input type="number" id="roiRx" required placeholder="e.g. 100"/>
        </div>
        <div class="field">
          <label for="roiCost">Avg. Herb Cost (<span id="curSym">₵</span>)</label>
          <input type="number" id="roiCost" required placeholder="e.g. 25"/>
        </div>
        <button type="submit">Calculate ROI</button>
      </form>
      <div id="roiResult" class="response" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
      </div>
    </section>

     <!-- Executive Analytics Dashboard -->
    <section id="analytics" class="module">
      <h2><i class="fas fa-chart-line"></i> Executive Analytics & KPIs</h2>
      <p class="desc">Real‐time metrics to track adoption, efficacy, supply and ROI at a glance.</p>
      <div class="charts">
        <figure class="chart-card"><canvas id="chartAdoption"></canvas><figcaption><strong>Adoption Over Time:</strong> Monthly new users.</figcaption></figure>
        <figure class="chart-card"><canvas id="chartEfficacy"></canvas><figcaption><strong>Efficacy Outcomes:</strong> Positive feedback rates.</figcaption></figure>
        <figure class="chart-card"><canvas id="chartSupply"></canvas><figcaption><strong>Supply Impact:</strong> Inventory usage.</figcaption></figure>
        <figure class="chart-card"><canvas id="chartROI"></canvas><figcaption><strong>Financial ROI:</strong> Quarterly returns.</figcaption></figure>
      </div><br>
      <button onclick="exportAnalytics()">Export Full CSV</button>
    </section>

    <!-- CONTACT & DISCLAIMER -->
    <section id="contact" class="module">
      <h2><i class="fas fa-envelope"></i> Contact & Compliance</h2>
      <p class="desc">For partnerships, audits, or support.</p>
      <form id="contact-form">
        <input type="email" placeholder="Your email" required aria-label="Email"/>
        <textarea placeholder="Message" rows="3" required aria-label="Message"></textarea>
        <button type="submit">Send</button>
      </form>
      <p class="hint" style="margin-top:1rem;">
        <strong>Disclaimer:</strong> For informational purposes only; consult a professional.<br/>
        Genetic data is handled per our <a href="#privacy">Privacy Policy</a>.
      </p>
    </section>

    <!-- FOOTER -->
    <footer>
      <p>&copy; 2025 Vitra AI. <a href="#privacy">Privacy Policy</a> | <a href="#terms">Terms & Conditions</a></p>
    </footer>

  </main>




 
  

  
<script>
 
  function onboardClose() {
    document.getElementById('onboardModal').style.display = 'none';
  }

  // Call OpenAI proxy
  async function callOpenAI(messages) {
    const res = await fetch('/.netlify/functions/openai-proxy', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ messages })
    });
    if (!res.ok) throw new Error('Server error');
    const j = await res.json();
    return j.choices[0].message.content;
  }

  // Call Vision API proxy
  async function callVision(file) {
    const fd = new FormData();
    fd.append('file', file);
    const res = await fetch('/.netlify/functions/vision-proxy', {
      method: 'POST',
      body: fd
    });
    if (!res.ok) throw new Error('Vision error');
    return res.json();
  }

  // Simple markdown → HTML formatter
  function formatHTML(txt) {
    return txt
      .replace(/^#+\s*(.*)$/gm,'$1') 
      .replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>')
      .replace(/\*(.+?)\*/g,'<em>$1</em>')
      .replace(/\[([^\]]+)\]/g,'<code>$1</code>')
      .split(/\n{2,}/).map(p=>`<p>${p.trim()}</p>`).join('');
  }

  // Show a friendly error message in a panel
  function showFriendlyError(panel) {
    panel.innerHTML = '<div class="result-content">😕 Oops! Something went wrong. Please try again.</div>';
    addClose(panel);
  }

  // Add close-“×” button to a response panel
  function addClose(panel) {
    if (panel.querySelector('.close-btn')) return;
    const btn = document.createElement('button');
    btn.className = 'close-btn';
    btn.textContent = '×';
    btn.onclick = () => panel.hidden = true;
    panel.prepend(btn);
  }

  // Add copy/download tools under the result-content
  function addTools(panel) {
    if (panel.querySelector('.tool-row')) return;
    const tools = document.createElement('div');
    tools.className = 'tool-row';
    tools.innerHTML = `
      <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
      <button class="dl-btn"   title="Download"><i class="fas fa-download"></i></button>`;
    panel.append(tools);

    tools.querySelector('.copy-btn').onclick = () => {
   navigator.clipboard.writeText(panel.querySelector('.result-content').innerText);
  const toast = document.createElement('div');
  toast.textContent = 'Copied!';
  toast.className = 'copy-toast';
  document.body.append(toast);
  setTimeout(()=>toast.remove(), 1500);
 };

    tools.querySelector('.dl-btn').onclick = () => {
      const text = panel.querySelector('.result-content').innerText;
      const blob = new Blob([text], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'response.txt'; a.click();
      URL.revokeObjectURL(url);
    };
  }

  //──────────────────────────────────────────────────────────────────────────────
  // CHARTS
  //──────────────────────────────────────────────────────────────────────────────

  function initCharts() {
    const cfg = (type, data) => ({
      type, data,
      options: { responsive: true,
      maintainAspectRatio: false,
      aspectRatio: 1.8,
      color: getComputedStyle(document.documentElement).getPropertyValue('--text').trim(),
      scales: {
        x: { 
          ticks: { color: getComputedStyle(document.documentElement).getPropertyValue('--text').trim() },
          grid:  { color: getComputedStyle(document.documentElement).getPropertyValue('--muted').trim() }
        },
        y: {
          ticks: { color: getComputedStyle(document.documentElement).getPropertyValue('--text').trim() },
          grid:  { color: getComputedStyle(document.documentElement).getPropertyValue('--muted').trim() }
        }
      },
      plugins: {
       legend: {
          display: false,
          labels: { color: getComputedStyle(document.documentElement).getPropertyValue('--text').trim() }
        }
      } }
    });
    new Chart('chartAdoption', cfg('line', { labels:['Jan','Feb','Mar'], datasets:[{data:[50,75,100]}], options: { grid:{ x:{display:false}, y:{display:false} } } }));
    new Chart('chartEfficacy',  cfg('bar',  { labels:['Mild','Mod','High'],   datasets:[{data:[30,45,25]}], options: { scales:{ x:{grid:{display:false}}, y:{grid:{display:false}} } } }));
    new Chart('chartSupply',    cfg('pie',  { labels:['A','B','C'],         datasets:[{data:[200,150,300]}] }));
    new Chart('chartROI',       cfg('radar',{ labels:['Q1','Q2','Q3','Q4'],datasets:[{data:[5,7,6,8]}] }));
  }

  function exportAnalytics() {
    const ids = ['Adoption','Efficacy','Supply','ROI'];
    let csv = '';
    ids.forEach(id => {
      const ch = Chart.getChart('chart' + id);
      ch.data.labels.forEach((lab,i) => {
        csv += `${id},${lab},${ch.data.datasets[0].data[i]}\n`;
      });
    });
    const blob = new Blob([csv], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'analytics.csv'; a.click();
    URL.revokeObjectURL(url);
  }

  //──────────────────────────────────────────────────────────────────────────────
  // GENERIC FORM HANDLER
  //──────────────────────────────────────────────────────────────────────────────
  function wireForm(formId, sysPrompt, extract, outId) {
    document.getElementById(formId).onsubmit = async e => {
      e.preventDefault();
      const panel = document.getElementById(outId);
      panel.hidden = false;
 panel.innerHTML = `<div class="result-content">${sysPrompt.includes('summary') ? 'Summarizing…' :
                        sysPrompt.includes('formulations') ? 'Formulating…' :
                        sysPrompt.includes('forecast') ? 'Forecasting…' :
                        'Generating…'} <span class="spinner"></span></div>`;
      try {
        const reply = await callOpenAI([
          { role: 'system', content: sysPrompt },
          { role: 'user',   content: extract() }
        ]);
        panel.innerHTML = `<div class="result-content">${formatHTML(reply)}</div>`;
        addClose(panel); addTools(panel);
      } catch (err) {
        showFriendlyError(panel);
      }
    };
  }

  //──────────────────────────────────────────────────────────────────────────────
  // SYMPTOM CHECKER
  //──────────────────────────────────────────────────────────────────────────────
  document.getElementById('severity').oninput = e => {
    document.getElementById('sevValue').textContent = e.target.value;
  };

  document.getElementById('sym-form').onsubmit = async e => {
    e.preventDefault();
    const panel = document.getElementById('symResult');
    panel.hidden = false;
    panel.innerHTML = '<div class="result-content">Processing… <span class="spinner"></span></div>';
    const text = document.getElementById('symInput').value.trim();
    const cat  = document.getElementById('symCategories').value;
    const sev  = document.getElementById('severity').value;
    const dur  = document.getElementById('symDuration').value || 0;
    try {
      const txt = await callOpenAI([
        { role: 'system', content: 'You are a herbal diagnostician. Answer with a plain-text list.' },
        { role: 'user',   content: `Symptoms: ${text}; Category: ${cat}; Severity: ${sev}; Duration: ${dur}d.` }
      ]);
      panel.innerHTML = `<div class="result-content">${formatHTML(txt)}</div>`;
      addClose(panel); addTools(panel);
    } catch (err) {
      showFriendlyError(panel);
    }
  };

  //──────────────────────────────────────────────────────────────────────────────
  // INDIVIDUAL FORM WIRINGS
  //──────────────────────────────────────────────────────────────────────────────

  // Plant Identifier
  document.getElementById('iden-form').onsubmit = async e => {
    e.preventDefault();
    const panel = document.getElementById('idenResult');
    panel.hidden = false;
    panel.innerHTML = '<div class="result-content">Processing… <span class="spinner"></span></div>';
    const file = e.target.querySelector('input[type=file]').files[0];
    const desc = document.getElementById('idenDesc').value.trim();
    if (!file && !desc) {
      panel.innerHTML = '<div class="result-content">⚠️ Please upload an image or description.</div>';
      addClose(panel);
      return;
    }
    try {
      let html = '';
      if (file) {
        const data = await callVision(file);
        html += `<strong>Name:</strong> ${data.name}<br/>
                 <strong>Uses:</strong> ${data.uses}<br/>
                 <strong>Cautions:</strong> ${data.cautions}<br/>
                 <strong>Regions:</strong> ${data.regions.join(', ')}<hr/>`;
      }
      if (desc) {
        const txt = await callOpenAI([
          { role: 'system', content: 'You are a plant expert. Reply plainly.' },
          { role: 'user',   content: `Describe plant: ${desc}` }
        ]);
        html += formatHTML(txt);
      }
      panel.innerHTML = `<div class="result-content">${html}</div>`;
      addClose(panel); addTools(panel);
    } catch (err) {
      showFriendlyError(panel);
    }
  };

 

  // Safety Checker
  wireForm(
    'safety-form',
    'You warn of dangerous herb/med combos.',
    () => `${document.getElementById('safetyA').value}&${document.getElementById('safetyB').value}`,
    'safetyResult'
  );

  // Personalized Formulations
  wireForm(
    'pf-form',
    'You create safe herbal formulations.',
    () => `Herbs: ${document.getElementById('pfHerbs').value}; Age: ${document.getElementById('pfAge').value}; Weight: ${document.getElementById('pfWeight').value}kg`,
    'pfResult'
  );

  // Research Summaries
  wireForm(
    'research-form',
    'You summarize clinical research with citations.',
    () => document.getElementById('researchQuery').value.trim(),
    'researchResults'
  );

  // Inventory Forecast
  wireForm(
    'inventory-form',
    'You are an expert summarizer—return 3 concise bullet points without markdown or tables.',
    () => `Herb: ${document.getElementById('forecastHerb').value}; Weeks: ${document.getElementById('forecastPeriod').value}`,
    'inventoryResult'
  );

   document.getElementById('btnCulture').addEventListener('click', async () => {
    const panel = document.getElementById('cultureResult');
    panel.hidden = false;
    panel.innerHTML = '<div class="result-content">Fetching cultural insights… <span class="spinner"></span></div>';
    try {
      const reply = await callOpenAI([
        { role:'system', content:'You are a cultural herbalist. Provide folklore and practices in bullet points.' },
        { role:'user',   content: document.getElementById('cultureQuery').value.trim() }
      ]);
      panel.innerHTML = `<div class="result-content">${formatHTML(reply)}</div>`;
      addClose(panel); addTools(panel);
    } catch {
      showFriendlyError(panel);
    }
  });

  // Genetics Match
  document.getElementById('genetics-form').onsubmit = async e => {
    e.preventDefault();
    const panel = document.getElementById('geneticResult');
    panel.hidden = false;
    panel.innerHTML = '<div class="result-content">Processing… <span class="spinner"></span></div>';
    const file = document.getElementById('geneticUpload').files[0];
    if (!file) {
      panel.innerHTML = '<div class="result-content">⚠️ Please upload CSV/JSON.</div>';
      addClose(panel);
      return;
    }
    // New file-type validation
 const allowed = ['application/json','text/csv'];
 if (!allowed.includes(file.type)) {
   panel.innerHTML = '<div class="result-content">⚠️ Invalid file type. Upload a .csv or .json.</div>';
   addClose(panel);
   return;
 }
    try {
      const text = await file.text();
      const reply = await callOpenAI([
        { role: 'system', content: 'You interpret genetic SNP data for herb recommendations.' },
        { role: 'user',   content: text }
      ]);
      panel.innerHTML = `<div class="result-content">${formatHTML(reply)}</div>`;
      addClose(panel); addTools(panel);
    } catch (err) {
      showFriendlyError(panel);
    }
  };

  // Dosage Calculator
  wireForm(
    'dose-form',
    'You calculate daily herbal dosages by weight, symptom, form.',
    () => `Weight: ${document.getElementById('weight').value}kg; Symptom: ${document.getElementById('symptom').value}; Form: ${document.getElementById('formType').value}`,
    'dosageResult'
  );

  // Interaction Checker
  wireForm(
    'int-form',
    'You check interactions between two herbs.',
    () => {
      const a = document.getElementById('herbA').value;
      const b = document.getElementById('herbB').value;
      if (a === b) throw new Error('Pick two distinct herbs.');
      return `${a}&${b}`;
    },
    'interactionResult'
  );

  // ROI Calculator
  document.getElementById('currency').onchange = e => {
    const sym = { GHS:'₵', USD:'$', EUR:'€' }[e.target.value];
    document.getElementById('curSym').textContent = sym;
  };

  document.getElementById('roi-form').onsubmit = async e => {
    e.preventDefault();
    const panel = document.getElementById('roiResult');
    panel.hidden = false;
    panel.innerHTML = '<div class="result-content">Calculating… <span class="spinner"></span></div>';
    const rx   = +document.getElementById('roiRx').value;
    const cost = +document.getElementById('roiCost').value;
    try {
      const reply = await callOpenAI([
      { role: 'system', content: 'You are a business analyst. Provide step-by-step ROI calc in simple language, no raw error messages.' },
        { role: 'user',   content: `Volume: ${rx}; Unit cost: ${cost}; Currency: ${document.getElementById('currency').value}` }
      ]);
      panel.innerHTML = `<div class="result-content">${formatHTML(reply)}</div>`;
      addClose(panel); addTools(panel);
    } catch (err) {
      showFriendlyError(panel);
    }
  };

  //──────────────────────────────────────────────────────────────────────────────
  // INIT & EVENT LISTENERS
  //──────────────────────────────────────────────────────────────────────────────
  document.addEventListener('DOMContentLoaded', () => {
    // Charts & export
    initCharts();
    document.querySelector('button[onclick="exportAnalytics()"]').onclick = exportAnalytics;

    // Sidebar shrink
    const sidebar     = document.getElementById('sidebar');
    const shrinkBtn   = document.getElementById('shrinkBtn');
     shrinkBtn.addEventListener('click', () => {
      sidebar.classList.toggle('collapsed');
      // swap arrow direction
      shrinkBtn.querySelector('i').classList.toggle('fa-angle-double-left');
      shrinkBtn.querySelector('i').classList.toggle('fa-angle-double-right');
      // hide/show brand text
      document.querySelector('#sidebar .brand span').style.display = sidebar.classList.contains('collapsed') ? 'none' : 'inline';
     });

    // Hamburger (mobile nav)
    const hamburger   = document.getElementById('hamburger');
    hamburger.addEventListener('click', () => {
      sidebar.classList.toggle('open');
    });

    // Theme toggle
    const themeToggle = document.getElementById('themeToggle');
    themeToggle.addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
      themeToggle.classList.toggle('fa-sun');
      themeToggle.classList.toggle('fa-moon');
    });

  

    // ─────────────── Chatbot + History ───────────────
  const chatBox = document.getElementById('pharmaChatBox');
  let lastDateKey = null;
  const history = [];

  function formatDateHeader(date) {
    const today = new Date(),
          diff = (today - date)/(1000*60*60*24);
    if (diff < 1) return 'Today';
    if (diff < 2) return 'Yesterday';
    return date.toLocaleDateString();
  }

  function addMessage(type, text) {
    const now = new Date(),
          key = now.toDateString();
    if (key !== lastDateKey) {
      const sep = document.createElement('div');
      sep.className = 'chat-date';
      sep.innerText = formatDateHeader(now);
      chatBox.append(sep);
      lastDateKey = key;
    }
    const ts = now.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'}),
          wrapper = document.createElement('div');
    wrapper.className = type==='user'?'user-msg':'bot-msg';
    wrapper.innerHTML = `
      <div class="msg-text">${text}</div>
      <div class="msg-ts">${ts}</div>`;
    chatBox.append(wrapper);
    chatBox.scrollTop = chatBox.scrollHeight;
    history.push({ role:type, text, time: `${now.toDateString()} ${ts}` });
  }

  // Send
  document.getElementById('sendPharma').onclick = async e => {
    e.preventDefault();
    const q = document.getElementById('pharmaInput').value.trim();
    if (!q) return showToast('⚠️ Type a question');
    addMessage('user', q);
    document.getElementById('pharmaInput').value = '';
    const spinner = document.createElement('div');
    spinner.className = 'spinner'; chatBox.append(spinner);
    const a = await callAI(q);
    spinner.remove();
    addMessage('bot', sanitizeAIContent(a));
  };

  // Clear chat
  document.getElementById('clearPharmaChat').onclick = () => {
    chatBox.innerHTML = '';
    lastDateKey = null;
    history.length = 0;
  };

  // History modal
  const historyModal = document.getElementById('historyModal'),
        historyList  = document.getElementById('historyList');

  document.getElementById('historyBtn').addEventListener('click', e => {
    e.preventDefault();
    historyList.innerHTML = history.map((h,i)=>`
      <div class="history-item">
        <strong>${h.role==='user'?'You':'Bot'}:</strong> ${h.text}
        <div class="msg-ts">${h.time}</div>
        <button class="delete-history" data-index="${i}">×</button>
      </div>`).join('');
    historyModal.hidden = false;
  });

  document.querySelector('.close-modal').onclick = () => {
    historyModal.hidden = true;
  };

  historyList.addEventListener('click', e => {
    if (!e.target.matches('.delete-history')) return;
    const idx = +e.target.dataset.index;
    history.splice(idx,1);
    e.target.closest('.history-item').remove();
  });

  });
</script>

</body>
</html>
