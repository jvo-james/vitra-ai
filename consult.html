<!DOCTYPE html>
<html lang="en" aria-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>E-Pharmacy AI Portal</title>

  <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

<style>
  /*──────────────────── Global Theme ────────────────────*/
  :root {
    --cb-primary: #3b3f88;       
    --cb-primary-alt: #5c4d99;   
    --cb-accent: #f08a5d;        
    --cb-bg: #f7f6f9;           
    --cb-surface: #ffffff;      
    --cb-text: #2d2d2d;          
    --cb-muted: #777777;         
    --radius: 0.75rem;
    --padding: 1rem;
    --shadow: 0 4px 12px rgba(0,0,0,0.1);
    --transition: 0.3s ease;
  }
  html.dark {
    --cb-bg: #1a1b2e;
    --cb-surface: #2d2d44;
    --cb-text: #e0e0e0;
    --cb-muted: #aaaaaa;
    --shadow: 0 4px 12px rgba(0,0,0,0.4);
  }
  *, *::before, *::after {
    box-sizing: border-box;
    transition: var(--transition);
  }
  body {
    margin: 0; padding: 0;
    font-family: 'Montserrat', sans-serif;
    background: var(--cb-bg);
    color: var(--cb-text);
    line-height: 1.5;
  }
  a { color: inherit; text-decoration: none; }
  h1,h2,h3,h4 { margin-bottom: 0.5rem; color: var(--cb-primary); }
  p.desc { color: var(--cb-muted); margin-bottom: 1rem; }

  /*──────────────────── Layout ────────────────────*/
  aside#sidebar {
    position: fixed; top: 0; left: 0; bottom: 0;
    width: 220px; background: var(--cb-surface);
    box-shadow: var(--shadow); z-index: 1000;
    display: flex; flex-direction: column;
  }
  aside#sidebar .brand {
    padding: var(--padding);
    font-size: 1.25rem;
    background: var(--cb-primary);
    color: #fff;
    display: flex; align-items: center; gap: 0.5rem;
  }
  aside#sidebar nav ul {
    flex: 1; overflow-y: auto; margin: 0; padding: 0; list-style: none;
  }
  aside#sidebar nav li a {
    display: flex; align-items: center; gap: 0.75rem;
    padding: 0.75rem var(--padding);
    border-radius: var(--radius);
  }
  aside#sidebar nav li.active a,
  aside#sidebar nav li a:hover {
    background: var(--cb-primary-alt);
    color: #fff;
  }
  #shrinkSidebar {
    background: none; border: none; font-size: 1.25rem;
    color: var(--cb-primary); cursor: pointer;
    margin: var(--padding);
  }
.sidebar-shrink #sidebar {
  width: 60px;
}
.sidebar-open aside#sidebar {
  transform: translateX(0);
}
  .sidebar-shrink #sidebar {
  width: 60px;
}
.sidebar-shrink header,
.sidebar-shrink main {
  margin-left: 60px;
}
  .sidebar-shrink #sidebar nav li a {
  justify-content: center;
}
.sidebar-shrink #sidebar nav li a span { 
  display: none !important; }
  @media (min-width: 769px) {
  #hamburger { display: none; }      
 }
  body.sidebar-open header,
 body.sidebar-open main {
 margin-left: 220px;  
 }
  header {
    position: sticky; top: 0;
    height: 60px; background: var(--cb-surface);
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 var(--padding); flex-wrap: wrap;
    box-shadow: var(--shadow); z-index: 1001;
  }
  header h1 {
    flex: 1 1 auto;          
    margin: 0.5rem 0;        
    word-break: break-word; 
    font-size: 1.25rem;     
  }
  #hamburger, #themeToggle {
    font-size: 1.5rem; color: var(--cb-primary); cursor: pointer;
  }

header, section, footer {
   margin-left: var(--sidebar-width,220px);
   transition: margin-left var(--transition);
 }

 body.sidebar-shrink header,
body.sidebar-shrink section,
body.sidebar-shrink footer {
   margin-left: var(--sidebar-collapsed-width,60px);
 }
   .sidebar-shrink #sidebar .brand {
 justify-content: center;      
 }
 .sidebar-shrink #sidebar .brand span {
  display: none;               
 }
  section.module {
    background: var(--cb-surface);
    border-radius: var(--radius);
    padding: var(--padding);
    margin-bottom: 1.5rem;
    box-shadow: var(--shadow);
  }

  /*──────────────────── Hero ────────────────────*/
  #hero {
    display: grid; grid-template-columns: 1fr 1fr; gap: var(--padding);
    background: var(--cb-primary-alt); color: #fff;
    padding: 2rem var(--padding);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    margin-bottom: 2rem;
  }
  #hero .hero-text h2 { font-size: 2.25rem; margin-bottom: 0.5rem; color: #fff; }
  #hero .hero-features {
    display: flex; flex-direction: column; gap: 1rem;
  }
  #hero .feature-card {
    background: #fff; color: var(--cb-primary);
    padding: 1rem; border-radius: var(--radius);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    display: flex; align-items: center; justify-content: space-between;
    cursor: pointer;
  }
  #hero .feature-card:hover {
    background: var(--cb-accent); color: #fff;
    transform: translateY(-3px);
  }
  #hero .feature-card i { font-size: 2rem; }
  #hero .feature-card .btn {
    background: var(--cb-primary); color: #fff;
    padding: 0.5rem 1rem; border-radius: var(--radius);
  }

  /*──────────────────── Forms & Inputs ────────────────────*/
  label { display: block; margin-bottom: 1rem; }
  input, select, textarea {
    width: 100%; padding: 0.75rem; margin-top: 0.5rem;
    border: 2px solid var(--cb-primary-alt);
    border-radius: var(--radius);
    background: var(--cb-bg);
    color: var(--cb-text);
  }
  input:focus, select:focus, textarea:focus {
    border-color: var(--cb-accent);
    box-shadow: 0 0 0 3px rgba(240,138,93,0.3);
  }
  button.btn {
    background: var(--cb-accent); color: #fff;
    border: none; padding: 0.75rem 1.25rem;
    border-radius: var(--radius); box-shadow: var(--shadow);
    cursor: pointer;
  }
  button.btn:hover { background: #d4724f; }

  /*──────────────────── Response Panels ────────────────────*/
  .response {
    background: var(--cb-surface);
    border-left: 4px solid var(--cb-accent);
    padding: var(--padding);
    margin-top: 1rem;
    position: relative;
    box-shadow: var(--shadow);
  }
  .response .close-btn {
    position: absolute; top: 0.5rem; right: 0.5rem;
    background: none; border: none; font-size: 1.1rem; cursor: pointer;
    color: var(--cb-muted);
  }

  /*──────────────────── Chat & History ────────────────────*/
  .chat-box {
    background: var(--cb-bg);
    border: 2px solid var(--cb-primary-alt);
    border-radius: var(--radius);
    padding: var(--padding);
    max-height: 300px; overflow-y: auto;
    margin-bottom: 1rem;
  }
  .chat-input { display: flex; gap: 0.5rem; }
  .chat-input input { flex: 1; border-radius: var(--radius) 0 0 var(--radius); }
  .chat-input button { border-radius: 0 var(--radius) var(--radius) 0; }
  .user-msg, .bot-msg {
    max-width: 70%; padding: 0.75rem; border-radius: var(--radius);
    margin-bottom: 0.5rem; word-wrap: break-word;
  }
  .user-msg {
    align-self: flex-end; background: var(--cb-primary); color: #fff;
    border-bottom-right-radius: 0;
  }
  .bot-msg {
    align-self: flex-start; background: var(--cb-surface); color: var(--cb-text);
    border-bottom-left-radius: 0;
  }
  .chat-date {
    text-align: center; margin: 1rem 0; font-size: 0.9rem;
    color: var(--cb-muted); font-weight: 600;
  }
  .msg-ts { font-size: 0.75rem; color: var(--cb-muted); }

  /*──────────────────── Modals & History ────────────────────*/
 .modal {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
   background: rgba(0,0,0,0.5);
   display: flex;                  /* show container as flex */
   align-items: center; justify-content: center;
    z-index: 2000;
 }
  /* hide when [hidden] is present */
  .modal[hidden] {
   display: none !important;
  }
  .modal-content {
    background: var(--cb-surface); padding: 1.5rem;
    border-radius: var(--radius); width: 90%; max-width: 600px;
    box-shadow: var(--shadow); position: relative;
  }
  .close-modal {
    position: absolute; top: 0.5rem; right: 0.75rem;
    font-size: 1.5rem; cursor: pointer; color: var(--cb-muted);
  }
  .history-item {
    background: var(--cb-bg); padding: 0.75rem; margin-bottom: 0.75rem;
    border-radius: var(--radius); display: flex;
    justify-content: space-between; align-items: center;
  }
  .delete-history {
    background: var(--cb-primary-alt); color: #fff;
    border: none; padding: 0.3rem 0.6rem; border-radius: var(--radius);
    cursor: pointer;
  }
  .delete-history:hover { background: var(--cb-primary); }

  /*──────────────────── Analytics Cards & Calendar ────────────────────*/
  .analytics-grid {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(240px,1fr));
    gap: var(--padding);
  }
  .analytics-card {
    background: var(--cb-surface);
    border-radius: var(--radius);
    padding: var(--padding);
    box-shadow: var(--shadow);
  }
  /* ─────── Calendar Grid ─────── */
  #calendar {
    display: grid;
    grid-template-columns: repeat(7,1fr);
    gap: 1px;
    background: var(--cb-bg);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    margin-top: 1rem;
  }
  #calendar .cell {
    padding: 0.75rem;
    background: var(--cb-surface);
    text-align: center;
    cursor: pointer;
    transition: transform var(--transition);
  }
  #calendar .cell.closed {
    background: #f0f0f0;
    color: var(--cb-muted);
    cursor: not-allowed;
  }
  #calendar .cell.open {
    background: var(--cb-accent);
    color: #fff;
  }
  #calendar .cell.today {
    border: 2px dashed var(--cb-primary);
    font-weight: bold;
  }
  #calendar .cell.selected {
    outline: 3px solid var(--cb-primary-alt);
    transform: scale(1.05);
    z-index: 1;
  }

  /*──────────────────── Responsive ────────────────────*/
  @media (max-width: 1024px) {
    header { left: 60px; }
    main { margin-left: 80px; }
     body.sidebar-shrink header,
    body.sidebar-shrink main {
      margin-left: 60px;
    }
  }
  @media (max-width: 768px) {
    aside#sidebar { transform: translateX(-100%); }
    body.sidebar-open aside#sidebar { transform: none; }
    header { left: 0; }
    main { margin-left: 1rem; margin-top: 100px; }
    #hero { grid-template-columns: 1fr; }
  }
    /* make our generated calendar look like your cells */
  #calendar {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 1px;
    background: var(--cb-bg);
    border: 1px solid var(--cb-bg);
  }
  /* Spinner */
.spinner {
  animation: spin 1s linear infinite;
  margin: .5rem auto;
  border: 6px solid rgba(0,0,0,0.15);        
  border-left-color: var(--cb-accent);     
  width: 32px; height: 32px;  
}
@keyframes spin { to { transform: rotate(360deg); } }
.hero-graphic {
  display: flex;
  align-items: center;
  justify-content: center;
}

.hero-graphic .hero-img {
  max-width: 100%;
  max-height: 300px;      /* adjust as needed */
  width: auto;
  height: auto;
  object-fit: contain;
  border-radius: var(--radius);
  box-shadow: var(--shadow);
}
/* Toast */
.toast {
  position: fixed; bottom: 1rem; left: 50%;
  transform: translateX(-50%) translateY(100%);
  background: var(--cb-primary-alt); color: #fff;
  padding: .75rem 1.5rem; border-radius: var(--radius);
  box-shadow: var(--shadow); opacity: 0;
  transition: transform .3s, opacity .3s;
  z-index: 2000;
}
.toast.visible {
  transform: translateX(-50%) translateY(0);
  opacity: 1;
}
   .calendar .cell.selected {
  outline: 3px solid var(--cb-primary);
  transform: scale(1.1);
  z-index: 1;
 }
 button#findMatch.btn {
   position: relative;
 }
 button#findMatch.btn.loading {
   color: transparent;            /* hide text */
 }
 button#findMatch.btn.loading::after {
   content: 'Matching…';
   position: absolute; top:50%; left:50%;
   transform: translate(-50%,-50%);
 }
 button#findMatch.btn.loading .spinner {
   position: absolute; top:50%; right:1rem;
   transform: translateY(-50%);
   display: inline-block;
 }
 .calendar-controls { display: none !important; }
 #filterSlots, #nextAvailable { display: none !important; }

  .month-nav {
   display: flex; align-items: center; justify-content: center;
   gap: 1rem; margin-bottom: 1rem;
 }
 .month-nav button {
   background: var(--cb-primary-alt); color: #fff;
   border: none; padding: .5rem; border-radius: var(--radius);
 }
 .month-nav #calendarHeader {
   font-size: 1.25rem; font-weight: 600;
 }

 #timeSlots {
   background: var(--cb-surface); padding: var(--padding);
   border-radius: var(--radius); box-shadow: var(--shadow);
   margin-top: 1rem;
 }
 #timeSlots h4 { margin-bottom: .75rem; color: var(--cb-primary-alt); font-weight: 600;  }
 #timeSlots ul { display: flex; flex-wrap: wrap; gap: .5rem; }
 #timeSlots ul li button {
   background: var(--cb-primary-alt); color: #fff;
   padding: .5rem 1rem; border-radius: var(--radius);
   box-shadow: var(--shadow); cursor: pointer;
 }
</style>
</head>
<body>
  <!-- Sidebar -->
  <aside id="sidebar">
    <div class="brand">
      <i class="fas fa-calendar-check"></i>
      <span>Vitra AI Consult</span>
    </div>
    <nav>
      <ul>
        <li class="active"><a href="#providerMatch"><i class="fas fa-user-md"></i><span>Provider Match</span></a></li>
        <li><a href="#availabilityCalendar"><i class="fas fa-calendar-alt"></i><span>Availability</span></a></li>
        <li><a href="#bookAppointment"><i class="fas fa-book-medical"></i><span>Book Appointment</span></a></li>
        <li><a href="#dashboard"><i class="fas fa-tachometer-alt"></i><span>Dashboard</span></a></li>
        <li><a href="#feedback"><i class="fas fa-star"></i><span>Feedback</span></a></li>
        <li><a href="#analytics"><i class="fas fa-chart-line"></i><span>Analytics</span></a></li>
        <li><a href="#liveChat"><i class="fas fa-comments"></i><span>Live Chat</span></a></li>
      </ul>
    </nav>
    <button id="shrinkSidebar" title="Toggle sidebar"><i class="fas fa-chevron-left"></i></button>
  </aside>

  <!-- Header -->
  <header>
    <i id="hamburger" class="fas fa-bars"></i>
    <h1>AI-Powered Consultation Booking</h1>
    <i id="themeToggle" class="fas fa-moon"></i>
  </header>

  <!-- Hero -->
  <section id="hero" class="module">
    <div class="hero-text">
      <h2><i class="fas fa-stethoscope"></i> Seamless Consultation Booking</h2>
      <p class="desc">From instant provider match to one-click appointment, powered by AI.</p>
      <a href="#providerMatch" class="btn hero-btn"><i class="fas fa-user-md"></i> Get Matched Now</a>
    </div>
    <div class="hero-graphic">
      <!-- You can replace this with an illustrative SVG or image -->
      <img class="hero-img" src="9E2CDE35-303A-4C5F-A4A9-1B0420CF8B0C.png" alt="Consultation illustration" />
    </div>
  </section>

  <!-- 1. Personalized AI Provider Matching -->
  <section id="providerMatch" class="module">
    <h2><i class="fas fa-user-md"></i> Personalized Provider Matching</h2>
    <p class="desc">Answer a few questions and get instantly matched to the best in-network specialist.</p>
    <form id="matchForm">
      <label>Chief Concern:
        <input type="text" id="concernInput" placeholder="e.g. persistent cough">
      </label>
      <label>Urgency:
        <select id="urgencyInput">
          <option>Low</option>
          <option>Medium</option>
          <option>High</option>
        </select>
      </label>
      <label>Preferred Language:
        <select id="languageInput">
          <option>English</option>
          <option>Twi</option>
          <option>Ga</option>
          <option>Ewe</option>
        </select>
      </label>
      <button type="button" id="findMatch" class="btn"><i class="fas fa-search"></i> Find My Specialist</button>
    </form>

    <div id="matchResults" class="response" hidden>
      <button class="close-btn"><i class="fas fa-times"></i></button>
      <div class="result-content">
        <!-- AI will choose among these pseudo-providers -->
        <ul id="providerList">
          <li data-id="p1"><strong>Dr. Kwame Asante</strong> – Pulmonologist, Korle Bu Teaching Hospital</li>
          <li data-id="p2"><strong>Dr. Abena Owusu</strong> – Cardiologist, 37 Military Hospital</li>
          <li data-id="p3"><strong>Dr. Kojo Mensah</strong> – Psychiatrist, Ridge Hospital</li>
          <li data-id="p4"><strong>Dr. Yaa Dufie</strong> – Dietitian, Nyaho Medical Centre</li>
          <li data-id="p5"><strong>Dr. Nana Adjei</strong> – General Practitioner, Cape Coast Polyclinic</li>
          <li data-id="p6"><strong>Dr. Efua Amponsah</strong> – Endocrinologist, LEKMA Hospital</li>
          <li data-id="p7"><strong>Dr. Michael Addo</strong> – Neurologist, 37 Military Hospital</li>
          <li data-id="p8"><strong>Dr. Grace Ofori</strong> – Dermatologist, Accra Dermatology Centre</li>
          <li data-id="p9"><strong>Dr. Joseph Kumi</strong> – Orthopedic Surgeon, Komfo Anokye Teaching Hospital</li>
          <li data-id="p10"><strong>Dr. Ama Brew</strong> – Pediatrician, Trust Hospital</li>
          <li data-id="p11"><strong>Ms. Akosua Baah</strong> – Physical Therapist, Tema General Hospital</li>
          <li data-id="p12"><strong>Mr. Daniel Boakye</strong> – Pharmacist, Ridge Hospital</li>
          <li data-id="p13"><strong>Mrs. Esther Kum</strong>i – Occupational Therapist, Cape Coast Polyclinic</li>
          <li data-id="p14"><strong>Ms. Joy Mensah</strong> – Speech Therapist, LEKMA Hospital</li>
          <li data-id="p15"><strong>Dr. Paul Yeboah</strong> – Nephrologist, Korle Bu Teaching Hospital</li>
          <li data-id="p16"><strong>Dr. Linda Frimpong</strong> – Rheumatologist, 37 Military Hospital</li>
          <li data-id="p17"><strong>Mr. Kwesi Owusu</strong> – Nutritionist, Nyaho Medical Centre</li>
          <li data-id="p18"><strong>Ms. Abena Boateng</strong> – Clinical Psychologist, Accra Psychology Clinic</li>       
        </ul>
      </div>
       <div id="chooseOwnSelect" hidden>
   <label>Pick Your Provider:
     <select id="ownProvider">
       <option disabled selected>-- Select --</option>
         <option value="p1">Dr. Kwame Asante – Pulmonologist, Korle Bu Teaching Hospital</option>
<option value="p2">Dr. Abena Owusu – Cardiologist, 37 Military Hospital</option>
<option value="p3">Dr. Kojo Mensah – Psychiatrist, Ridge Hospital</option>
<option value="p4">Dr. Yaa Dufie – Dietitian, Nyaho Medical Centre</option>
<option value="p5">Dr. Nana Adjei – General Practitioner, Cape Coast Polyclinic</option>
<option value="p6">Dr. Efua Amponsah – Endocrinologist, LEKMA Hospital</option>
<option value="p7">Dr. Michael Addo – Neurologist, 37 Military Hospital</option>
<option value="p8">Dr. Grace Ofori – Dermatologist, Accra Dermatology Centre</option>
<option value="p9">Dr. Joseph Kumi – Orthopedic Surgeon, Komfo Anokye Teaching Hospital</option>
<option value="p10">Dr. Ama Brew – Pediatrician, Trust Hospital</option>
<option value="p11">Ms. Akosua Baah – Physical Therapist, Tema General Hospital</option>
<option value="p12">Mr. Daniel Boakye – Pharmacist, Ridge Hospital</option>
<option value="p13">Mrs. Esther Kumi – Occupational Therapist, Cape Coast Polyclinic</option>
<option value="p14">Ms. Joy Mensah – Speech Therapist, LEKMA Hospital</option>
<option value="p15">Dr. Paul Yeboah – Nephrologist, Korle Bu Teaching Hospital</option>
<option value="p16">Dr. Linda Frimpong – Rheumatologist, 37 Military Hospital</option>
<option value="p17">Mr. Kwesi Owusu – Nutritionist, Nyaho Medical Centre</option>
<option value="p18">Ms. Abena Boateng – Clinical Psychologist, Accra Psychology Clinic</option>        
     </select>
   </label>
 </div>
      <div class="match-actions">
      <button id="proceedMatch" class="btn">Proceed with AI choice</button>
      <button id="chooseOwn" class="btn btn-outline">Choose own provider</button>
    </div>
    </div>
  </section>

 
  <section id="appointmentFlow" class="module" hidden>
    <h2><i class="fas fa-calendar-alt"></i> Schedule with <span id="chosenProvider"></span></h2>
<div class="calendar-controls">
  <label>Select Professional:
        <select id="availProfessional">
         <option value="p1">Dr. Kwame Asante – Pulmonologist, Korle Bu Teaching Hospital</option>
<option value="p2">Dr. Abena Owusu – Cardiologist, 37 Military Hospital</option>
<option value="p3">Dr. Kojo Mensah – Psychiatrist, Ridge Hospital</option>
<option value="p4">Dr. Yaa Dufie – Dietitian, Nyaho Medical Centre</option>
<option value="p5">Dr. Nana Adjei – General Practitioner, Cape Coast Polyclinic</option>
<option value="p6">Dr. Efua Amponsah – Endocrinologist, LEKMA Hospital</option>
<option value="p7">Dr. Michael Addo – Neurologist, 37 Military Hospital</option>
<option value="p8">Dr. Grace Ofori – Dermatologist, Accra Dermatology Centre</option>
<option value="p9">Dr. Joseph Kumi – Orthopedic Surgeon, Komfo Anokye Teaching Hospital</option>
<option value="p10">Dr. Ama Brew – Pediatrician, Trust Hospital</option>
<option value="p11">Ms. Akosua Baah – Physical Therapist, Tema General Hospital</option>
<option value="p12">Mr. Daniel Boakye – Pharmacist, Ridge Hospital</option>
<option value="p13">Mrs. Esther Kumi – Occupational Therapist, Cape Coast Polyclinic</option>
<option value="p14">Ms. Joy Mensah – Speech Therapist, LEKMA Hospital</option>
<option value="p15">Dr. Paul Yeboah – Nephrologist, Korle Bu Teaching Hospital</option>
<option value="p16">Dr. Linda Frimpong – Rheumatologist, 37 Military Hospital</option>
<option value="p17">Mr. Kwesi Owusu – Nutritionist, Nyaho Medical Centre</option>
<option value="p18">Ms. Abena Boateng – Clinical Psychologist, Accra Psychology Clinic</option>        </select>
      </label>
      <label>Date:
        <input type="date" id="calendarDateInput">
      </label>
      <label>Time of Day:
        <select id="timeOfDayInput">
          <option>Morning</option>
          <option>Afternoon</option>
          <option>Evening</option>
        </select>
      </label>
      <label>Type:
        <select id="visitTypeInput">
          <option>Telehealth</option>
          <option>In-Person</option>
        </select>
      </label>
      <button type="button" id="filterSlots" class="btn"><i class="fas fa-filter"></i> Filter</button>
      <button type="button" id="nextAvailable" class="btn"><i class="fas fa-forward"></i> Next Available</button>
    </div>
     <div class="month-nav">
   <button type="button" id="prevMonth" class="btn-sm">&larr;</button>
   <div id="calendarHeader" class="calendar-header"></div>
   <button type="button" id="nextMonth" class="btn-sm">&rarr;</button>
  </div>
   <div id="calendar"></div>
   <div id="timeSlots"></div>
   <!-- STEP 3: user details + confirm -->
   <form id="finalBookingForm" hidden style="margin-top: 1.5rem;">
     <h3>Confirm your details</h3>
     <label>Your Name:
       <input id="clientNameFinal" placeholder="Full Name" required>
     </label>
      <label>Email: <input id="clientEmail" type="email" required></label>
     <label>Phone: <input id="clientPhone" type="tel" required></label>

     <div id="summarySelection" style="margin-bottom: 1rem;"></div>
     <div class="summary-actions">
       <button id="editSelection" type="button" class="btn btn-outline">‹ Back</button>
       <button id="confirmBookingFinal" type="button" class="btn">Confirm & Book</button>
     </div>
   </form>
  </section>
  <!-- 4. Patient Dashboard & History -->
  <section id="dashboard" class="module">
    <h2><i class="fas fa-tachometer-alt"></i> Your Dashboard</h2>
    <p class="desc">Manage upcoming visits, review past appointments, download summaries.</p>
    <div class="dashboard-tabs">
      <button type="button" data-tab="upcoming" class="active">Upcoming</button>
      <button type="button" data-tab="past">Past</button>
    </div>
    <div id="upcoming" class="dashboard-list">
      <ul>
        <li>
          <strong>Dr. Abena Owusu</strong> – 2025-05-30 14:00  
          <button type="button" class="btn-sm rescheduleBtn">Reschedule</button>
          <button type="button" class="btn-sm cancelBtn">Cancel</button>
        </li>
        <!-- more items… -->
      </ul>
    </div>
    <div id="past" class="dashboard-list" hidden>
      <ul>
        <li>
          <strong>Dr. Kojo Mensah</strong> – 2025-04-12 10:00  
          <button type="button" class="btn-sm">Download Summary</button>
          <button type="button" class="btn-sm">Download Invoice</button>
        </li>
        <!-- more… -->
      </ul>
    </div>
  </section>

  <!-- 5. Feedback & Ratings -->
  <section id="feedback" class="module">
    <h2><i class="fas fa-star"></i> Feedback & Ratings</h2>
    <p class="desc">Help us improve—quick 1-min survey.</p>
    <label>Rate your last visit:  
      <select id="ratingInput">
        <option>⭐</option><option>⭐⭐</option><option>⭐⭐⭐</option><option>⭐⭐⭐⭐</option><option>⭐⭐⭐⭐⭐</option>
      </select>
    </label>
    <label>Comments:
      <textarea id="feedbackInput" rows="3" placeholder="Any suggestions?"></textarea>
    </label>
    <button type="button" id="submitFeedback" class="btn"><i class="fas fa-paper-plane"></i> Submit</button>
  </section>

  <!-- 6. Analytics & Optimization -->
  <section id="analytics" class="module">
    <h2><i class="fas fa-chart-line"></i> Analytics & Optimization</h2>
    <div class="chart-container">
      <canvas id="noShowChart"></canvas>
      <canvas id="peakTimesChart" style="margin-top:1rem;"></canvas>
    </div>
    <button type="button" id="optimizeStaffing" class="btn"><i class="fas fa-cogs"></i> AI Suggest Staffing</button>
    <div id="optimizationResult" class="response" hidden>
      <button class="close-btn"><i class="fas fa-times"></i></button>
      <div class="result-content"></div>
    </div>
  </section>

  <!-- 7. Live AI Chat Support -->
  <section id="liveChat" class="module">
    <h2><i class="fas fa-comments"></i> Live AI Chat Support</h2>
    <p class="desc">24/7 assistant for all your booking questions.</p>
    <div class="chat-controls">
      <button type="button" id="clearChat" class="btn-sm"><i class="fas fa-trash"></i> Clear</button>
      <button type="button" id="showHistory" class="btn-sm"><i class="fas fa-history"></i> History</button>
    </div>
    <div id="chatBox" class="chat-box"></div>
    <form id="chatForm" class="chat-input">
      <input id="chatInput" type="text" placeholder="Ask me anything…">
      <button type="button" id="sendChat" class="btn"><i class="fas fa-paper-plane"></i></button>
    </form>
    <!-- Chat history modal -->
    <div id="chatHistoryModal" class="modal" hidden>
      <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h3>Chat History</h3>
        <div id="chatHistoryList"></div>
        <button type="button" id="clearHistoryChat" class="btn-sm">Clear All</button>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <small>© 2025 AI-Pharmacy Chain — All rights reserved</small>
  </footer>

<script>
(function(){
  // ─── HELPERS ────────────────────────────────────────
  const PHASE = {
    findMatch: 'Matching…',
    confirmBooking: 'Confirming…',
    sendChat: 'Thinking…'
  };
  function showToast(msg) {
    const t = document.createElement('div');
    t.className = 'toast';
    t.innerText = msg;
    document.body.append(t);
    requestAnimationFrame(()=>t.classList.add('visible'));
    setTimeout(()=>t.remove(),3000);
  }
  async function callOpenAI(messages) {
    try {
      const res = await fetch('/.netlify/functions/openai-proxy', {
        method:'POST', headers:{'Content-Type':'application/json'},
        body: JSON.stringify({messages})
      });
      if(!res.ok) throw new Error(await res.text());
      const j = await res.json();
      return j.choices?.[0]?.message?.content.trim() || '⚠️ Unexpected AI response.';
    } catch(err) {
      return '⚠️ '+err.message;
    }
  }

  document.addEventListener('DOMContentLoaded', ()=>{
    // ─── ELEMENTS ───────────────────────────────────────
    const sidebarBtn      = document.getElementById('shrinkSidebar');
    const hamburger       = document.getElementById('hamburger');
    const themeToggle     = document.getElementById('themeToggle');
    const bodyEl          = document.body;
    const providerMatchEl = document.getElementById('providerMatch');
    const appointmentEl   = document.getElementById('appointmentFlow');
    const matchPanel      = document.getElementById('matchResults');
    const calEl           = document.getElementById('calendar');
    const headerEl        = document.getElementById('calendarHeader');
    const profSelect      = document.getElementById('availProfessional');
    const prevBtn         = document.getElementById('prevMonth');
    const nextBtn         = document.getElementById('nextMonth');
    const timeSlotsEl     = document.getElementById('timeSlots');

    // ─── STYLES & TOGGLES ───────────────────────────────
    sidebarBtn.addEventListener('click', () => {
  bodyEl.classList.toggle('sidebar-shrink');
  // flip the chevron
  const icon = sidebarBtn.querySelector('i');
  icon.classList.toggle('fa-chevron-left');
  icon.classList.toggle('fa-chevron-right');
});
    hamburger.addEventListener('click', ()=>{
      bodyEl.classList.toggle('sidebar-open');
      bodyEl.classList.remove('sidebar-shrink');
    });
    themeToggle.addEventListener('click', ()=>{
      const html = document.documentElement;
      html.classList.toggle('dark');
      html.setAttribute('aria-theme', html.classList.contains('dark')?'dark':'light');
      themeToggle.classList.toggle('fa-sun');
      themeToggle.classList.toggle('fa-moon');
    });

    // ─── AVAILABILITY DATA ──────────────────────────────
    const availability = {
      p1:  { '2025-06-10':['09:00','10:00','11:00'], '2025-06-12':['14:00','15:00'], '2025-06-15':['08:30','09:30','10:30'] },
      p2:  { '2025-06-03':['10:00','13:00','16:00'], '2025-06-04':['09:00','11:00'], '2025-06-15':['12:00','14:00'] },
      p3:  { '2025-06-08':['08:00','09:00','10:00','11:00'], '2025-06-11':['13:30','14:30'], '2025-06-16':['15:00','16:00'] },
      p4:  { '2025-06-05':['09:30','10:30','11:30'], '2025-06-09':['14:00','15:00','16:00'], '2025-06-18':['08:00','09:00'] },
      p5:  { '2025-06-07':['08:15','09:15','10:15'], '2025-06-13':['13:00','14:00'], '2025-06-17':['10:00','11:00','12:00'] },
      p6:  { '2025-06-02':['09:00','10:00'], '2025-06-14':['11:00','12:00','13:00'], '2025-06-19':['14:00','15:00'] },
      p7:  { '2025-06-06':['08:30','09:30','10:30'], '2025-06-12':['13:00','14:00','15:00'], '2025-06-20':['09:00','10:00'] },
      p8:  { '2025-06-01':['10:00','11:00','12:00'], '2025-06-11':['14:30','15:30'], '2025-06-16':['08:00','09:00','10:00'] },
      p9:  { '2025-06-04':['09:00','10:00','11:00'], '2025-06-13':['13:00','14:00'], '2025-06-18':['15:00','16:00'] },
      p10: { '2025-06-03':['08:00','09:00','10:00'], '2025-06-10':['11:00','12:00','13:00'], '2025-06-17':['14:00','15:00'] },
      p11: { '2025-06-05':['09:30','10:30','11:30'], '2025-06-14':['13:00','14:00','15:00'], '2025-06-19':['08:00','09:00'] },
      p12: { '2025-06-02':['10:00','11:00','12:00'], '2025-06-08':['14:00','15:00'], '2025-06-20':['09:00','10:00','11:00'] },
      p13: { '2025-06-07':['08:00','09:00','10:00'], '2025-06-12':['11:30','12:30','13:30'], '2025-06-18':['14:00','15:00'] },
      p14: { '2025-06-03':['09:15','10:15','11:15'], '2025-06-09':['13:00','14:00','15:00'], '2025-06-16':['08:00','09:00'] },
      p15: { '2025-06-05':['08:30','09:30','10:30'], '2025-06-13':['11:00','12:00','13:00'], '2025-06-19':['14:30','15:30'] },
      p16: { '2025-06-02':['10:00','11:00','12:00'], '2025-06-11':['13:15','14:15'], '2025-06-17':['09:00','10:00','11:00'] },
      p17: { '2025-06-04':['09:00','10:00','11:00'], '2025-06-10':['12:00','13:00','14:00'], '2025-06-15':['15:00','16:00'] },
      p18: { '2025-06-01':['08:00','09:00','10:00'], '2025-06-08':['11:30','12:30','13:30'], '2025-06-20':['14:00','15:00','16:00'] }
    };

    // ─── CALENDAR STATE ────────────────────────────────
    let displayYear  = new Date().getFullYear();
    let displayMonth = new Date().getMonth();

    function generateCalendar(yr,mth){
      headerEl.innerText = new Date(yr,mth)
        .toLocaleString('default',{month:'long',year:'numeric'});
      calEl.innerHTML = '';
      ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].forEach(wd=>{
        const hd = document.createElement('div');
        hd.className='cell'; hd.style.fontWeight='600'; hd.innerText=wd;
        calEl.append(hd);
      });
      const firstDay = new Date(yr,mth,1).getDay();
      for(let i=0;i<firstDay;i++){
        const blank = document.createElement('div');
        blank.className='cell closed'; calEl.append(blank);
      }
      const avail = availability[ profSelect.value ]||{};
      const today = new Date();
      const daysInMon = new Date(yr,mth+1,0).getDate();
      for(let d=1;d<=daysInMon;d++){
        const dateKey = `${yr}-${String(mth+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
        const open = !!avail[dateKey];
        const cell = document.createElement('div');
        cell.className = `cell ${open?'open':'closed'}`;
        cell.innerText = d;
        if(open){
          cell.addEventListener('click',()=>{
            calEl.querySelectorAll('.cell.selected')
              .forEach(x=>x.classList.remove('selected'));
            cell.classList.add('selected');
            renderTimeSlots(dateKey,avail[dateKey]);
          });
        }
        if(today.getFullYear()===yr && today.getMonth()===mth && today.getDate()===d){
          cell.classList.add('today');
        }
        calEl.append(cell);
      }
      timeSlotsEl.innerHTML='';
    }

    function renderTimeSlots(dateKey,slots){
      timeSlotsEl.innerHTML = `<h4>Available times on ${dateKey}:</h4>`;
      const ul = document.createElement('ul');
      ul.style.listStyle='none'; ul.style.padding='0';
      slots.forEach(t=>{
        const li = document.createElement('li');
        const btn = document.createElement('button');
        btn.type='button'; btn.className='btn-sm'; btn.innerText=t;
        btn.style.margin='0.25rem';
        li.append(btn); ul.append(li);
      });
      timeSlotsEl.append(ul);
    }

    // ─── INITIAL RENDER + MONTH NAV ─────────────────────
    generateCalendar(displayYear,displayMonth);
    prevBtn.onclick = ()=>{ displayMonth--; if(displayMonth<0){displayMonth=11;displayYear--;} generateCalendar(displayYear,displayMonth); };
    nextBtn.onclick = ()=>{ displayMonth++; if(displayMonth>11){displayMonth=0;displayYear++;} generateCalendar(displayYear,displayMonth); };
    profSelect.onchange = ()=> generateCalendar(displayYear,displayMonth);

    // ─── 1. PROVIDER MATCHING ────────────────────────────
    const providers = [
      {id:'p1',name:'Dr. Kwame Asante',spec:'Pulmonologist, Korle Bu'},
      {id:'p2',name:'Dr. Abena Owusu',spec:'Cardiologist, 37 Military'},
      {id:'p3',name:'Dr. Kojo Mensah',spec:'Psychiatrist, Ridge'},
      {id:'p4',name:'Dr. Yaa Dufie',spec:'Dietitian, Nyaho Medical'},
      {id:'p5',name:'Dr. Nana Adjei',spec:'GP, Cape Coast'},
      {id:'p6',name:'Dr. Efua Amponsah',spec:'Endocrinologist, LEKMA'},
      {id:'p7',name:'Dr. Michael Addo',spec:'Neurologist, 37 Military'},
      {id:'p8',name:'Dr. Grace Ofori',spec:'Dermatologist, Accra Derm.'},
      {id:'p9',name:'Dr. Joseph Kumi',spec:'Ortho Surgeon, Komfo Anokye'},
      {id:'p10',name:'Dr. Ama Brew',spec:'Pediatrician, Trust Hosp.'},
      {id:'p11',name:'Ms. Akosua Baah',spec:'PT, Tema General'},
      {id:'p12',name:'Mr. Daniel Boakye',spec:'Pharmacist, Ridge'},
      {id:'p13',name:'Mrs. Esther Kumi',spec:'OT, Cape Coast'},
      {id:'p14',name:'Ms. Joy Mensah',spec:'Speech Therapist, LEKMA'},
      {id:'p15',name:'Dr. Paul Yeboah',spec:'Dermatologist, Korle Bu'},
      {id:'p16',name:'Dr. Linda Frimpong',spec:'Nephrologist, 37 Military'},
      {id:'p17',name:'Mr. Kwesi Owusu',spec:'Nutritionist, Nyaho Med.'},
      {id:'p18',name:'Ms. Abena Boateng',spec:'Psychologist, Accra Psych.'}
    ];
    document.getElementById('findMatch').addEventListener('click', async e=>{
      e.preventDefault();
      const btn = e.currentTarget;
      const concern = document.getElementById('concernInput').value.trim();
      if(!concern) return showToast('Enter your chief concern');
     btn.disabled = true;
      btn.innerHTML = `${PHASE.findMatch} <span class="spinner"></span>`;
      const sys = `You are AI match. Providers:\n${providers.map(p=>`- ${p.name}, ${p.spec}`).join('\n')}`;
      const usr = `Concern="${concern}". Pick best provider.`;
      const raw = await callOpenAI([{role:'system',content:sys},{role:'user',content:usr}]);
     btn.disabled = false;
     btn.innerHTML = '<i class="fas fa-search"></i> Find My Specialist';

      // only take the very first line as the AI pick
     const cleaned = raw
        .replace(/```[\s\S]*?```/g, '')
        .replace(/^(#+)\s*/gm, '')               
        .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
        .replace(/\*(.+?)\*/g, '<em>$1</em>');
      const top = cleaned.split(/\r?\n/)[0].trim();

      matchPanel.innerHTML = `
        <div class="result-content"><strong>${top}</strong></div>
       <div id="chooseOwnSelect" hidden>
       </div>
        <div class="match-actions">
          <button id="proceedMatch" class="btn">Next ➔</button>
          <button id="chooseOwn" class="btn btn-outline">Choose Own</button>
        </div>`;
      matchPanel.hidden = false;

   document.getElementById('proceedMatch').onclick = ()=>{
        chosenProviderName = top;
       document.getElementById('chosenProvider').innerText = chosenProviderName;
        providerMatchEl.hidden = true;
        appointmentEl.hidden   = false;
        startAppointmentFlow(chosenProviderName);
      };
      
      document.getElementById('chooseOwn')
   .addEventListener('click', () => {
     matchPanel.querySelector('.result-content').hidden = true;
     document.getElementById('chooseOwnSelect').hidden = false;
   });
 document.getElementById('ownProvider')
   .addEventListener('change', e => {
     const id = e.target.value;
     const pn = providers.find(p=>p.id===id).name;
     providerMatchEl.hidden = true;
     appointmentEl.hidden   = false;
     startAppointmentFlow(pn);
   });
       document.getElementById('ownProvider').addEventListener('change', e => {
      const id = e.target.value;
      const provider = providers.find(p=>p.id===id).name;
      providerMatchEl.hidden = true;
      appointmentEl.hidden   = false;
      startAppointmentFlow(provider);
    });
    });

    // ─── 2. PICK A SLOT ──────────────────────────────────
     calEl.addEventListener('click', e => {
      if (!e.target.classList.contains('open')) return;
      // clear previous selection
      calEl.querySelectorAll('.selected').forEach(c=>c.classList.remove('selected'));
      e.target.classList.add('selected');
      const day = e.target.innerText;
      const dateKey = `${displayYear}-${String(displayMonth+1).padStart(2,'0')}-${String(day).padStart(2,'0')}`;
      renderTimeSlots(dateKey, availability[profSelect.value][dateKey]);
    });
    timeSlotsEl.addEventListener('click', e => {
      if (!e.target.matches('button')) return;
      window.selectedTime = e.target.innerText;
      window.selectedDate = timeSlotsEl.querySelector('h4').innerText.split(' on ')[1];
      showSummary();
    });

  // ─── 3. SUMMARY & CONFIRM ────────
  function showSummary() {
  // grab all needed elements
  const calendarEl       = document.getElementById('calendar');
  const timeSlotsElLocal = document.getElementById('timeSlots');
  const finalForm        = document.getElementById('finalBookingForm');
  const summarySelection = document.getElementById('summarySelection');
  const editBtn          = document.getElementById('editSelection');
  const confirmBtn       = document.getElementById('confirmBookingFinal');
  const clientName       = document.getElementById('clientNameFinal');

  // toggle visibility
  calendarEl.hidden      = true;
  timeSlotsElLocal.hidden= true;
  finalForm.hidden       = false;

  // fill in the chosen slot
  summarySelection.innerHTML =
    `<p><strong>${window.selectedDate}</strong> at <strong>${window.selectedTime}</strong></p>`;

  // back-button: restores calendar view
  editBtn.onclick = () => {
    calendarEl.hidden       = false;
    timeSlotsElLocal.hidden = false;
    finalForm.hidden        = true;
    summarySelection.innerHTML = '';
    document.querySelectorAll('#calendar .selected')
      .forEach(c => c.classList.remove('selected'));
  };

  // confirm & book
  confirmBtn.onclick = async () => {
    const name = clientName.value.trim();
    if (!name) return showToast('Please enter your name');
    showToast(PHASE.confirmBooking);
    await new Promise(r => setTimeout(r, 1500));
    finalForm.innerHTML =
      `<div class="result-content">
         🎉 Success, <strong>${name}</strong>!<br>
         Your appointment on <strong>${window.selectedDate}</strong> at <strong>${window.selectedTime}</strong> is confirmed.
       </div>`;
  };
}
    
    // below where you do startAppointmentFlow:
function startAppointmentFlow(providerName) {
   // header
   appointmentEl.querySelector('h2').innerHTML =
     `<i class="fas fa-calendar-alt"></i> Schedule with <strong>${providerName}</strong>`;
   // one-time description
   if (!appointmentEl.querySelector('.flow-desc')) {
     appointmentEl.insertAdjacentHTML(
       'afterbegin',
       `<p class="desc flow-desc">Select an available date, then pick a time slot.</p>`
     );
   }
   // lock select & render
   profSelect.value = providers.find(p=>p.name===providerName).id;
   profSelect.disabled = true;
   generateCalendar(displayYear, displayMonth);
 } 
   


  }); // DOMContentLoaded
})(); // IIFE
</script>

  
</body>
</html>
