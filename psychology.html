<!DOCTYPE html>
<html lang="en" aria-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Vitra AI – Psychology & Mental Health</title>
  <!-- Montserrat + FontAwesome Kit -->
<!-- Pale Blue + FontAwesome -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet"/>
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet"/>
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/><style>
    /*────────────────── THEME & RESET ──────────────────*/
    :root {
      --primary:#5A8DEE;--primary-alt:#7DA4E8;
      --secondary:#FF758C;--accent:rgba(255,255,255,0.4);
      --bg:#F0F4F8;--surface:rgba(255,255,255,0.85);
      --text:#1F2937;--muted:#546E7A;
      --radius:.75rem;--padding:1rem;--transition:.3s ease;
      --shadow-light:0 4px 20px rgba(0,0,0,0.05);
      --shadow-heavy:0 8px 40px rgba(0,0,0,0.1);
    }
    html.dark {
      --bg:#111827;--surface:rgba(30,35,54,0.85);
      --text:#E0E6F0;--muted:#9AA5B1;--accent:rgba(30,35,54,0.5);
    }
    *,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
    html{font-family:'Montserrat',sans-serif;scroll-behavior:smooth;}
    body{display:flex;min-height:100vh;background:var(--bg);color:var(--text);overflow-x:hidden;}
    a{color:inherit;text-decoration:none;}
    button,input,textarea,select{font:inherit;transition:all var(--transition);}
    :focus{outline:2px solid var(--primary);outline-offset:2px;}

    /*────────────────── SIDEBAR ──────────────────*/
    aside{flex:0 0 260px;background:var(--surface);backdrop-filter:blur(12px);
      box-shadow:var(--shadow-light);position:sticky;top:0;height:100vh;
      display:flex;flex-direction:column;transition:flex var(--transition);}
    aside.collapsed{flex:0 0 72px;}
    .brand{display:flex;align-items:center;gap:.75rem;padding:var(--padding);font-size:1.2rem;color:var(--primary);}
    aside.collapsed .brand span{opacity:0;}
    nav{flex:1;overflow-y:auto;margin-top:.5rem;}
    nav a{display:flex;align-items:center;gap:1rem;padding:.75rem var(--padding);border-radius:var(--radius);
      transition:background var(--transition),transform var(--transition);}
    nav a:hover,nav a.active{background:var(--primary);color:#fff;transform:translateX(4px);}
    #shrinkBtn{margin:var(--padding) auto;width:36px;height:36px;border-radius:50%;
      background:var(--primary);color:#fff;box-shadow:var(--shadow-heavy);cursor:pointer;}
    #shrinkBtn:hover{transform:scale(1.1);}

    /*────────────────── HEADER ──────────────────*/
    header{position:fixed;top:0;left:260px;right:0;height:60px;background:var(--surface);
      backdrop-filter:blur(12px);display:flex;align-items:center;justify-content:space-between;
      padding:0 var(--padding);box-shadow:var(--shadow-light);transition:left var(--transition);z-index:1000;}
    header.sidebar-collapsed{left:72px;}
    header h1{font-size:1.4rem;}
    .hamburger,.theme-toggle{font-size:1.5rem;color:var(--primary);cursor:pointer;}
    .hamburger:hover,.theme-toggle:hover{transform:scale(1.1);}

    /*────────────────── MAIN & HERO ──────────────────*/
    main{flex:1;margin-top:60px;padding:var(--padding);overflow-x:hidden;}
    .hero{position:relative;background:var(--surface);backdrop-filter:blur(12px);
      border-radius:var(--radius);padding:3rem var(--padding);text-align:center;box-shadow:var(--shadow-heavy);
      margin-bottom:2rem;}
    .hero h1{font-size:2.75rem;color:var(--primary);margin-bottom:1rem;}
    .hero p{font-size:1.2rem;color:var(--muted);margin-bottom:2rem;max-width:600px;margin-inline:auto;}
    .hero .actions{display:flex;flex-direction:column;gap:1rem;max-width:360px;margin-inline:auto;}
    .hero .actions a{display:inline-block;background:var(--primary);color:#fff;padding:1rem;font-size:1rem;
      border-radius:var(--radius);box-shadow:var(--shadow-light);transition:transform var(--transition),background var(--transition);}
    .hero .actions a.btn-secondary{background:var(--secondary);}
    .hero .actions a:hover{transform:translateY(-3px);}
    .hero-icons{position:absolute;top:1rem;right:1rem;display:flex;flex-direction:column;gap:.5rem;
      font-size:2rem;opacity:0.15;}

    /*────────────────── MODULES ──────────────────*/
    section.module{background:var(--surface);backdrop-filter:blur(8px);border-radius:var(--radius);
      padding:var(--padding);margin-bottom:1.5rem;box-shadow:var(--shadow-light);transition:transform var(--transition);}
    section.module:hover{transform:translateY(-4px);}
    section.module h2{display:flex;align-items:center;gap:.5rem;font-size:1.5rem;color:var(--primary);margin-bottom:.75rem;}
    section.module p.desc{color:var(--muted);font-size:1rem;margin-bottom:1rem;}

    /*────────────────── FORMS & BUTTONS ──────────────────*/
    input[type="text"],input[type="number"],select,textarea{width:100%;padding:.75rem;border:1px solid var(--muted);
      border-radius:var(--radius);background:var(--accent);color:var(--text);}
    input:focus,textarea:focus,select:focus{border-color:var(--primary);box-shadow:0 0 8px var(--primary);}
    input[type="range"]{width:100%;accent-color:var(--primary);}
    .checkbox-group{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:.5rem;}
    fieldset{border:1px solid var(--muted);border-radius:var(--radius);padding:.75rem;}
    legend{padding:0 .5rem;font-weight:600;color:var(--secondary);}

    button.btn{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.25rem;border:none;border-radius:var(--radius);
      background:var(--primary);color:#fff;font-weight:600;box-shadow:var(--shadow-light);cursor:pointer;
      transition:background var(--transition),transform var(--transition),box-shadow var(--transition);}
    button.btn-secondary{background:var(--secondary);}
    button.btn:hover{transform:translateY(-2px);box-shadow:var(--shadow-heavy);}
    button.btn-secondary:hover{background:var(--primary-alt);}

    /*────────────────── RESPONSES & SPINNER ──────────────────*/
    .response{background:var(--surface);backdrop-filter:blur(8px);border-left:4px solid var(--secondary);
      padding:var(--padding);border-radius:var(--radius);margin-top:1rem;box-shadow:var(--shadow-light);position:relative;}
    .response .result-content{white-space:pre-wrap;line-height:1.5;}
    .close-btn{position:absolute;top:var(--padding);right:var(--padding);background:none;border:none;font-size:1.2rem;color:var(--secondary);cursor:pointer;}
    .tool-row{position:absolute;bottom:var(--padding);right:var(--padding);display:flex;gap:.5rem;}
    .tool-row button{background:var(--surface);border:1px solid var(--muted);border-radius:50%;width:1.6rem;height:1.6rem;
      display:flex;align-items:center;justify-content:center;cursor:pointer;transition:transform var(--transition);}
    .tool-row button:hover{transform:scale(1.1);}

    /* simple spinner */
    .spinner {
      display:inline-block;
      width:1em; height:1em;
      border:2px solid var(--secondary);
      border-right-color:transparent;
      border-radius:50%;
      animation:spin 0.6s linear infinite;
      vertical-align:middle;
    }
    @keyframes spin { to{transform:rotate(360deg);} }

    /*────────────────── CHAT UI ──────────────────*/
    .chat-box{background:var(--bg);border:1px solid var(--muted);border-radius:var(--radius);padding:var(--padding);
      max-height:300px;overflow-y:auto;display:flex;flex-direction:column;}
    .user-msg,.bot-msg{max-width:75%;padding:.75rem 1rem;margin:.5rem 0;border-radius:1rem;position:relative;}
    .user-msg{background:var(--primary);color:#fff;align-self:flex-end;}
    .bot-msg{background:var(--accent);color:var(--text);align-self:flex-start;}
    .timestamp{font-size:.65rem;color:var(--muted);position:absolute;bottom:-1.2rem;right:1rem;}

    /*────────────────── CHARTS ──────────────────*/
    .charts{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem;margin-top:1rem;}
    .chart-card{background:var(--surface);backdrop-filter:blur(8px);border-radius:var(--radius);
      padding:var(--padding);box-shadow:var(--shadow-light);display:flex;flex-direction:column;}
    .chart-card canvas{flex:1;}

    /*────────────────── RESPONSIVE ──────────────────*/
    @media(max-width:1024px){header{padding:0 .5rem;} .hero{padding:2rem .75rem;}}
    @media(max-width:640px){.hero h1{font-size:2rem;}section.module{padding:.75rem;}.hero-icons{display:none;}
      .checkbox-group{grid-template-columns:1fr;}}
  </style>
</head>
<body>

  <!-- SIDEBAR -->
  <aside id="sidebar">
    <div class="brand"><i class="fas fa-brain"></i><span>Vitra AI</span></div>
    <nav>
      <a href="index.html"><i class="fas fa-seedling"></i><span>Herbal Medicine</span></a>
      <a href="psychology.html" class="active"><i class="fas fa-brain"></i><span>Psych &amp; MH</span></a>
      <a href="dietetics.html"><i class="fas fa-utensils"></i><span>Dietetics</span></a>
      <a href="pharmacy.html"><i class="fas fa-prescription-bottle-alt"></i><span>E-Pharmacy</span></a>
      <a href="consult.html"><i class="fas fa-calendar-check"></i><span>Consult Booking</span></a>
    </nav>
    <button id="shrinkBtn" aria-label="Toggle sidebar"><i class="fas fa-angle-double-left"></i></button>
  </aside>

  <!-- HEADER -->
  <header>
    <i id="hamburger" class="fas fa-bars"></i>
    <h1>Psychology &amp; Mental Health</h1>
    <i id="themeToggle" class="fas fa-moon"></i>
  </header>

  <!-- MAIN -->
  <main>

    <!-- HERO -->
    <section class="hero" id="hero">
      <h1><i class="fas fa-brain"></i> Empower Your Mind with AI</h1>
      <p>Discover multimodal insights, therapeutic chats, creative therapies, and more—powered by advanced AI.</p>
      <div class="actions">
        <a href="#therapybot" class="btn btn-primary"><i class="fas fa-comments"></i> Talk to Therapy Bot</a>
        <a href="#insight"      class="btn btn-secondary"><i class="fas fa-wave-square"></i> Emotional Insight</a>
        <a href="#creative"     class="btn btn-primary"><i class="fas fa-palette"></i> Creative Therapies</a>
        <a href="#games"        class="btn btn-secondary"><i class="fas fa-gamepad"></i> Cognitive Games</a>
      </div>
      <div class="hero-icons">
        <i class="fas fa-cloud"></i>
        <i class="fas fa-moon"></i>
        <i class="fas fa-star"></i>
        <i class="fas fa-lightbulb"></i>
      </div>
    </section>

    <!-- 1. Therapy Bot -->
    <section class="module" id="therapybot">
      <h2><i class="fas fa-robot"></i> 1. Conversational “Therapy Bot”</h2>
      <p class="desc">Engage in guided CBT, mindfulness, or emotional support—choose your path and let the AI adapt.</p>
      <form id="therapy-form">
        <label>Modality:
          <select id="therapyModality">
            <option value="CBT">CBT Exercises</option>
            <option value="mindfulness">Mindfulness</option>
            <option value="emotional">Emotional Support</option>
            <option value="guidedImagery">Guided Imagery</option>
          </select>
        </label>
        <label>Session Length:
          <select id="therapyLength">
            <option>5 minutes</option><option>10 minutes</option><option>20 minutes</option>
          </select>
        </label>
        <label>Language:
          <select id="therapyLang">
            <option>English</option><option>Spanish</option><option>French</option>
          </select>
        </label>
        <div style="display:flex;gap:.5rem;">
          <input id="therapyInput" type="text" placeholder="Describe what you need…" />
          <button id="sendChat" class="btn btn-primary"><i class="fas fa-paper-plane"></i></button>
        </div>
      </form>
      <div id="chatBox" class="chat-box"></div>
      <div id="chatHint" class="desc" hidden>Bot is thinking… <span class="spinner"></span></div>
    </section>

    <!-- 2. Emotional Insight -->
    <section class="module" id="insight">
      <h2><i class="fas fa-wave-square"></i> 2. Multimodal Emotional Insight</h2>
      <p class="desc">Record voice, upload a selfie, or type your thoughts to get sentiment, tone, and stress analysis.</p>
      <div class="insight-controls">
        <button id="startVideo"     class="btn btn-primary"><i class="fas fa-video"></i> Record Video</button>
        <button id="uploadAudio"    class="btn btn-secondary"><i class="fas fa-microphone"></i> Upload Audio</button>
        <button id="uploadImage"    class="btn btn-primary"><i class="fas fa-camera"></i> Upload Selfie</button>
        <button id="typingAnalysis" class="btn btn-secondary"><i class="fas fa-keyboard"></i> Type Analysis</button>
      </div>
      <textarea id="insightNotes" rows="3" placeholder="Or write your feelings…"></textarea>
      <button id="runInsight" class="btn btn-primary"><i class="fas fa-play"></i> Analyze</button>
      <div id="insightPanel" class="response" hidden>
        <button class="close-btn">&times;</button>
        <div class="result-content"></div>
        <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
        </div>
      </div>
    </section>

    <!-- 3. Daily Mood Tracker -->
    <section class="module" id="moodTracker">
      <h2><i class="fas fa-sliders-h"></i> 3. Daily Mood Tracker</h2>
      <p class="desc">Consistent mood logging helps you and our AI detect patterns, triggers, and early warning signs.</p>
      <form id="mood-form">
        <label for="moodRange">Mood Rating: <strong><span id="moodValue">5</span>/10</strong></label>
        <input type="range" id="moodRange" min="1" max="10" value="5"/>
        <fieldset>
          <legend>Select all that apply:</legend>
          <div class="checkbox-group">
            <label><input type="checkbox" name="emotions" value="Happy"> <i class="far fa-smile"></i> Happy</label>
            <label><input type="checkbox" name="emotions" value="Sad"> <i class="far fa-frown"></i> Sad</label>
            <label><input type="checkbox" name="emotions" value="Anxious"> <i class="fas fa-exclamation-triangle"></i> Anxious</label>
            <label><input type="checkbox" name="emotions" value="Calm"> <i class="fas fa-water"></i> Calm</label>
            <label><input type="checkbox" name="emotions" value="Angry"> <i class="fas fa-fire"></i> Angry</label>
            <label><input type="checkbox" name="emotions" value="Motivated"> <i class="fas fa-bolt"></i> Motivated</label>
          </div>
        </fieldset>
        <fieldset>
          <legend>Potential Triggers:</legend>
          <div class="checkbox-group">
            <label><input type="checkbox" name="triggers" value="Work"> Work</label>
            <label><input type="checkbox" name="triggers" value="Relationships"> Relationships</label>
            <label><input type="checkbox" name="triggers" value="Finance"> Finance</label>
            <label><input type="checkbox" name="triggers" value="Health"> Health</label>
            <label><input type="checkbox" name="triggers" value="Sleep"> Sleep</label>
            <label><input type="checkbox" name="triggers" value="Diet"> Diet</label>
          </div>
        </fieldset>
        <label for="moodNote">Quick Journal Entry:</label>
        <textarea id="moodNote" rows="3" placeholder="How are you feeling?"></textarea>
        <label for="selfCare">Self-Care Focus:</label>
        <select id="selfCare"><option disabled selected>Choose…</option>
          <option>Breathing</option><option>Stretching</option><option>Mindfulness</option>
          <option>Music</option><option>Walk</option>
        </select>
        <button type="submit" class="btn btn-primary"><i class="fas fa-chart-line"></i> Analyze Mood</button>
      </form>
      <div id="moodPanel" class="response" hidden>
        <button class="close-btn">&times;</button>
        <div class="result-content"></div>
        <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
        </div>
      </div>
    </section>

    <!-- 4. Dream Explorer -->
    <section class="module" id="dream">
      <h2><i class="fas fa-bed"></i> 4. Dream &amp; Subconscious Explorer</h2>
      <p class="desc">Dive into your nightly mind—capture narratives, symbols, emotions, and ambient sounds.</p>
      <div class="dream-block">
        <h3><i class="fas fa-feather-alt"></i> Narrative</h3>
        <textarea id="dreamText" rows="4" placeholder="“I found myself…”"></textarea>
      </div>
      <div class="dream-block">
        <h3><i class="fas fa-microphone-alt"></i> Audio (Optional)</h3>
        <input type="file" id="dreamAudio" accept="audio/*"/>
        <button class="btn btn-secondary" id="recordAudio"><i class="fas fa-record-vinyl"></i> Record 30s</button>
      </div>
      <div class="dream-block">
        <h3><i class="fas fa-swatchbook"></i> Symbols &amp; Themes</h3>
        <fieldset>
          <legend>Common Symbols</legend>
          <div class="checkbox-group">
            <label><input type="checkbox" value="water"/> <i class="fas fa-water"></i> Water</label>
            <label><input type="checkbox" value="flight"/> <i class="fas fa-wind"></i> Flight</label>
            <label><input type="checkbox" value="teeth"/> <i class="fas fa-tooth"></i> Teeth</label>
            <label><input type="checkbox" value="chase"/> <i class="fas fa-running"></i> Being Chased</label>
            <label><input type="checkbox" value="falling"/> <i class="fas fa-arrow-down"></i> Falling</label>
            <label>
              <input type="checkbox" id="otherSymbolChk"/> Other:
              <input type="text" id="otherSymbol" placeholder="Your symbol"/>
            </label>
          </div>
        </fieldset>
      </div>
      <div class="dream-block">
        <h3><i class="fas fa-smile-beam"></i> Mood Before Sleep</h3>
        <select id="preMood">
          <option disabled selected>Choose…</option>
          <option>Calm</option><option>Anxious</option><option>Neutral</option><option>Excited</option><option>Sad</option>
        </select>
        <h3 style="margin-top:1rem;"><i class="fas fa-sun"></i> Mood On Waking</h3>
        <select id="postMood">
          <option disabled selected>Choose…</option>
          <option>Refreshed</option><option>Tired</option><option>Confused</option>
          <option>Inspired</option><option>Anxious</option>
        </select>
      </div>
      <div class="dream-block">
        <h3><i class="fas fa-tags"></i> Contextual Tags</h3>
        <input type="text" id="dreamTags" placeholder="e.g. exam, graduation"/>
      </div>
      <div class="dream-block">
        <h3><i class="fas fa-lightbulb"></i> Reflection</h3>
        <textarea id="dreamReflect" rows="3" placeholder="My reflection…"></textarea>
      </div>
      <div class="dream-actions">
        <button id="analyzeDream" class="btn btn-primary"><i class="fas fa-brain"></i> Analyze Dream</button>
        <button id="interpretSymbols" class="btn btn-secondary"><i class="fas fa-search"></i> Interpret Symbols</button>
        <button id="generatePrompts" class="btn btn-secondary"><i class="fas fa-pen-nib"></i> Generate Prompts</button>
      </div>
      <div id="dreamPanel" class="response" hidden>
        <button class="close-btn">&times;</button>
        <div class="result-content"></div>
        <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
        </div>
      </div>
    </section>

    <!-- 5. AI-Curated Creative Therapies -->
    <section class="module" id="creative">
      <h2><i class="fas fa-palette"></i> 5. AI-Curated Creative Therapies</h2>
      <p class="desc">Generate art, music, poetry or journaling prompts—all tailored to your mood.</p>
      <form id="creative-form">
        <label>Type:
          <select id="creativeType">
            <option value="art">Abstract Art</option>
            <option value="music">Soundscape</option>
            <option value="poetry">Poetry</option>
            <option value="journaling">Journaling</option>
          </select>
        </label>
        <label>Style:
          <select id="creativeStyle">
            <option>Calm & Soft</option><option>Vibrant & Bold</option>
            <option>Mystical</option><option>Minimalist</option>
          </select>
        </label>
        <label>Detail:
          <input type="range" id="creativeDetail" min="1" max="10" value="5"/>
        </label>
        <button id="artGenerate" class="btn btn-primary"><i class="fas fa-brush"></i> Art</button>
        <button id="musicGenerate" class="btn btn-secondary"><i class="fas fa-music"></i> Music</button>
        <button id="poetryGenerate" class="btn btn-secondary"><i class="fas fa-pen"></i> Poetry</button>
        <button id="journalGenerate" class="btn btn-secondary"><i class="fas fa-book"></i> Journal</button>
      </form>
      <div id="creativePanel" class="response" hidden>
        <button class="close-btn">&times;</button>
        <div class="result-content"></div>
        <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
        </div>
      </div>
    </section>

    <!-- 6. Cognitive Games -->
    <section class="module" id="games">
      <h2><i class="fas fa-gamepad"></i> 6. Dynamic Cognitive Games</h2>
      <p class="desc">Adaptive puzzles, memory match, and story co-creation.</p>
      <form id="games-form">
        <label>Game Type:
          <select id="gameType">
            <option value="puzzle">Logic Puzzle</option>
            <option value="memory">Memory Match</option>
            <option value="story">Collaborative Story</option>
          </select>
        </label>
        <label>Difficulty:
          <select id="gameDifficulty">
            <option>Easy</option><option>Medium</option><option>Hard</option>
          </select>
        </label>
        <button id="startPuzzle" class="btn btn-primary"><i class="fas fa-puzzle-piece"></i> Logic</button>
        <button id="startMemory" class="btn btn-secondary"><i class="fas fa-clone"></i> Memory</button>
        <button id="startStory" class="btn btn-secondary"><i class="fas fa-book-open"></i> Story</button>
      </form>
      <div id="gamesPanel" class="response" hidden>
        <button class="close-btn">&times;</button>
        <div class="result-content"></div>
        <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
        </div>
      </div>
    </section>

    <!-- 7. Predictive Risk & Early Warning -->
    <section class="module" id="risk">
      <h2><i class="fas fa-chart-line"></i> 7. Predictive Risk & Early Warning</h2>
      <p class="desc">Monitor patterns and get alerts when risk thresholds are crossed.</p>
      <form id="risk-form">
        <label>Threshold (%):
          <input type="number" id="riskThreshold" min="1" max="100" value="75"/>
        </label>
        <label>Notify Via:
          <select id="riskNotify">
            <option>Email</option><option>SMS</option><option>In-App</option>
          </select>
        </label>
        <button id="enableRisk" class="btn btn-primary"><i class="fas fa-bell"></i> Enable Alerts</button>
      </form>
      <div id="riskPanel" class="response" hidden>
        <button class="close-btn">&times;</button>
        <div class="result-content"></div>
        <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
        </div>
      </div>
    </section>

    <!-- 8. Personalized Self-Care Plans -->
    <section class="module" id="selfcare">
      <h2><i class="fas fa-heart"></i> 8. Personalized Self-Care Plans</h2>
      <p class="desc">AI-generated daily routines, reminders, and habit tracking.</p>
      <form id="selfcare-form">
        <label>Focus:
          <select id="selfcareFocus">
            <option>Breathing</option><option>Stretch & Movement</option>
            <option>Mindfulness</option><option>Creative Pause</option>
          </select>
        </label>
        <label>Time:
          <input type="time" id="selfcareTime"/>
        </label>
        <button id="generatePlan" class="btn btn-primary"><i class="fas fa-calendar-day"></i> Generate</button>
      </form>
      <div id="selfcarePanel" class="response" hidden>
        <button class="close-btn">&times;</button>
        <div class="result-content"></div>
        <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
        </div>
      </div>
    </section>

    <!-- 9. VR Micro-Therapies -->
    <section class="module" id="vr">
      <h2><i class="fas fa-vr-cardboard"></i> 9. Virtual Reality Micro-Therapies</h2>
      <p class="desc">Immersive calm landscapes or graded exposure in VR.</p>
      <form id="vr-form">
        <label>Environment:
          <select id="vrEnvironment">
            <option>Forest</option><option>Beach</option><option>Mountain</option><option>Custom</option>
          </select>
        </label>
        <label>Duration:
          <select id="vrDuration">
            <option>2 minutes</option><option>5 minutes</option><option>10 minutes</option>
          </select>
        </label>
        <button id="launchPhobia" class="btn btn-primary"><i class="fas fa-exclamation-triangle"></i> Phobia Sim</button>
        <button id="launchCalm"   class="btn btn-secondary"><i class="fas fa-water"></i> Mindscapes</button>
      </form>
      <div id="vrPanel" class="response" hidden>
        <button class="close-btn">&times;</button>
        <div class="result-content"></div>
        <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
        </div>
      </div>
    </section>

    <!-- 10. Professional Ecosystem -->
    <section class="module" id="pro">
      <h2><i class="fas fa-toolbox"></i> 10. Integrated Professional Ecosystem</h2>
      <p class="desc">Secure note-taking, referral management, and session analytics.</p>
      <form id="pro-form">
        <label>Upload Notes:
          <input type="file" id="proUpload" accept=".txt,.json"/>
        </label>
        <label>Referral:
          <select id="proReferral">
            <option>Immediate</option><option>Standard</option><option>Low Priority</option>
          </select>
        </label>
        <button id="processNotes" class="btn btn-primary"><i class="fas fa-file-alt"></i> Process</button>
        <button id="matchTherapist" class="btn btn-secondary"><i class="fas fa-user-md"></i> Match Therapist</button>
      </form>
      <div id="proPanel" class="response" hidden>
        <button class="close-btn">&times;</button>
        <div class="result-content"></div>
        <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
        </div>
      </div>
    </section>

    <!-- 11. Medication Management -->
    <section class="module" id="medsafety">
      <h2><i class="fas fa-pills"></i> 11. Medication Management & Safety</h2>
      <p class="desc">Enter medications, check interactions, set adherence reminders.</p>
      <form id="medsafety-form">
        <label>Medications:
          <input type="text" id="medList" placeholder="e.g. Sertraline, Ibuprofen"/>
        </label>
        <button id="checkInteractions" class="btn btn-primary"><i class="fas fa-exchange-alt"></i> Check Interactions</button>
        <button id="setAdherence" class="btn btn-secondary"><i class="fas fa-check-circle"></i> Set Reminders</button>
      </form>
      <div id="medsafetyPanel" class="response" hidden>
        <button class="close-btn">&times;</button>
        <div class="result-content"></div>
        <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
        </div>
      </div>
    </section>

    <!-- 12. Symptom Questionnaire -->
    <section class="module" id="symptomQuiz">
      <h2><i class="fas fa-clipboard-list"></i> 12. Symptom Questionnaire</h2>
      <p class="desc">Answer a brief survey; AI will score severity and suggest next steps.</p>
      <form id="quiz-form">
        <label>Sleep Quality:
          <select name="sleep"><option>Poor</option><option>Fair</option><option>Good</option></select>
        </label>
        <label>Appetite:
          <select name="appetite"><option>Low</option><option>Normal</option><option>High</option></select>
        </label>
        <label>Concentration:
          <select name="concentration"><option>Impaired</option><option>Average</option><option>Sharp</option></select>
        </label>
        <button id="submitQuiz" class="btn btn-primary"><i class="fas fa-play"></i> Submit & Analyze</button>
      </form>
      <div id="quizPanel" class="response" hidden>
        <button class="close-btn">&times;</button>
        <div class="result-content"></div>
        <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
        </div>
      </div>
    </section>

    <!-- 13. Community & Peer Support -->
    <section class="module" id="community">
      <h2><i class="fas fa-users"></i> 13. Community & Peer Support</h2>
      <p class="desc">Join moderated circles or get a check-in from Buddy Bot.</p>
      <form id="community-form">
        <label>Topic:
          <select id="communityTopic">
            <option>Anxiety</option><option>Depression</option><option>Motivation</option><option>Mindfulness</option>
          </select>
        </label>
        <label><input type="checkbox" id="anonToggle"/> Join Anonymously</label>
        <button id="enterCircle" class="btn btn-primary"><i class="fas fa-comments"></i> Enter Circle</button>
        <button id="buddyCheckin" class="btn btn-secondary"><i class="fas fa-user-friends"></i> Buddy Check-in</button>
      </form>
      <div id="communityPanel" class="response" hidden>
        <button class="close-btn">&times;</button>
        <div class="result-content"></div>
        <div class="tool-row">
          <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
        </div>
      </div>
    </section>

    <!-- 14. Data Analytics & ROI -->
    <section class="module" id="analytics">
      <h2><i class="fas fa-chart-pie"></i> 14. Data Analytics & ROI</h2>
      <p class="desc">Visualize engagement, symptom changes, and export detailed reports.</p>
      <div class="charts">
        <div class="chart-card"><canvas id="engagementChart" width="400" height="200"></canvas><figcaption>Sessions Over Time</figcaption></div>
        <div class="chart-card"><canvas id="outcomeChart"    width="400" height="200"></canvas><figcaption>Outcome Metrics</figcaption></div>
      </div>
      <div style="margin-top:1rem;display:flex;gap:1rem;align-items:center">
        <label>Date Range:
          <input type="date" id="analyticsFrom"/> –
          <input type="date" id="analyticsTo"/>
        </label>
        <button id="exportCharts" class="btn btn-primary"><i class="fas fa-file-export"></i> Export CSV</button>
      </div>
    </section>

    <footer style="text-align:center;padding:1rem;background:var(--surface);color:var(--muted)">
      &copy; 2025 Vitra AI – Psychology &amp; Mental Health
    </footer>
  </main>

  <!-- CHART.JS & LOGIC -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // ── OpenAI proxy + Markdown helper ───────────────────────────
    async function callOpenAI(messages) {
      const res = await fetch('/.netlify/functions/openai-proxy',{
        method:'POST',headers:{'Content-Type':'application/json'},
        body:JSON.stringify({messages})
      });
      if(!res.ok) throw new Error('OpenAI error');
      const j = await res.json();
      return j.choices[0].message.content;
    }
    function formatHTML(txt){
      return txt.replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>')
                .replace(/\*(.+?)\*/g,'<em>$1</em>')
                .split(/\n{2,}/).map(p=>`<p>${p.trim()}</p>`).join('');
    }

    document.addEventListener('DOMContentLoaded',()=>{
      // UTIL: ensure .response panel exists
      function getPanel(id){
        const sec=document.getElementById(id);
        let pan=sec.querySelector('.response');
        if(!pan){
          pan=document.createElement('div');
          pan.className='response';
          sec.append(pan);
        }
        pan.hidden=false;
        return pan;
      }

      // SIDEBAR / THEME
      document.getElementById('shrinkBtn').onclick = ()=>
        document.getElementById('sidebar').classList.toggle('collapsed');
      document.getElementById('hamburger').onclick = ()=>
        document.getElementById('sidebar').classList.toggle('collapsed');
      document.getElementById('themeToggle').onclick = ()=>{
        document.documentElement.classList.toggle('dark');
        document.getElementById('themeToggle').classList.toggle('fa-sun');
      };

      // CLOSE & COPY for all panels
      document.body.addEventListener('click',e=>{
        if(e.target.closest('.close-btn')){
          e.target.closest('.response').hidden=true;
        }
        if(e.target.closest('.copy-btn')){
          const panel=e.target.closest('.response');
          const txt=panel.querySelector('.result-content').innerText;
          navigator.clipboard.writeText(txt);
        }
      });

      // ── THERAPY BOT ───────────────────────────────────────────
      const chatBox=document.getElementById('chatBox'),
            chatHint=document.getElementById('chatHint'),
            chatInput=document.getElementById('therapyInput');
      function addMsg(who,txt){
        const d=document.createElement('div');
        d.className = who==='You'?'user-msg':'bot-msg';
        d.innerHTML=`${formatHTML(txt)}<div class="timestamp">${new Date().toLocaleTimeString()}</div>`;
        chatBox.append(d);
        chatBox.scrollTop=chatBox.scrollHeight;
      }
      document.getElementById('sendChat').onclick=async e=>{
        e.preventDefault();
        const txt=chatInput.value.trim();
        if(!txt) return;
        addMsg('You',txt);
        chatInput.value=''; chatHint.hidden=false;
        const sys=`You are a therapist. Modality=${document.getElementById('therapyModality').value};Length=${document.getElementById('therapyLength').value};Language=${document.getElementById('therapyLang').value}.`;
        try{
          const reply=await callOpenAI([{role:'system',content:sys},{role:'user',content:txt}]);
          addMsg('Therapist',reply);
        }catch{
          addMsg('Therapist','⚠️ Something went wrong.');
        }finally{chatHint.hidden=true;}
      };

      // ── MOOD TRACKER ─────────────────────────────────────────
      const moodR=document.getElementById('moodRange'),
            moodV=document.getElementById('moodValue');
      moodR.oninput=()=>moodV.textContent=moodR.value;
      document.getElementById('mood-form').onsubmit=async e=>{
        e.preventDefault();
        const panel=getPanel('moodTracker');
        panel.innerHTML=`<div class="result-content">Analyzing… <span class="spinner"></span></div>`;
        const data={
          mood:moodR.value,
          emotions:[...document.querySelectorAll('#moodTracker input[name="emotions"]:checked')].map(c=>c.value),
          triggers:[...document.querySelectorAll('#moodTracker input[name="triggers"]:checked')].map(c=>c.value),
          note:document.getElementById('moodNote').value.trim(),
          selfCare:document.getElementById('selfCare').value
        };
        try{
          const reply=await callOpenAI([{role:'system',content:'You are a mental health assistant.'},
            {role:'user',content:`Daily Mood Entry:\n${JSON.stringify(data)}`}]);
          panel.innerHTML=`<div class="result-content">${formatHTML(reply)}</div>`;
        }catch{
          panel.innerHTML=`<div class="result-content">😕 Something went wrong.</div>`;
        }
      };

      // ── DREAM & SYMBOLS ─────────────────────────────────────────
      document.getElementById('analyzeDream').onclick=async()=>{
        const panel=getPanel('dream');
        panel.innerHTML=`<div class="result-content">Analyzing… <span class="spinner"></span></div>`;
        const narrative=document.getElementById('dreamText').value.trim(),
              symbols=[...document.querySelectorAll('#dream input[type="checkbox"]:checked')].map(c=>c.value).join(', '),
              pre=document.getElementById('preMood').value,
              post=document.getElementById('postMood').value,
              tags=document.getElementById('dreamTags').value.trim(),
              reflect=document.getElementById('dreamReflect').value.trim();
        try{
          const reply=await callOpenAI([{role:'system',content:'You are a dream interpreter.'},
            {role:'user',content:
              `Narrative: ${narrative}\nSymbols: ${symbols}\nBefore sleep: ${pre}\nOn waking: ${post}\nTags: ${tags}\nReflection: ${reflect}`
            }]);
          panel.innerHTML=`<div class="result-content">${formatHTML(reply)}</div>`;
        }catch{
          panel.innerHTML=`<div class="result-content">😕 Oops! Something went wrong.</div>`;
        }
      };
      document.getElementById('interpretSymbols').onclick=async()=>{
        const panel=getPanel('dream');
        panel.innerHTML=`<div class="result-content">Interpreting… <span class="spinner"></span></div>`;
        const symbols=[...document.querySelectorAll('#dream input[type="checkbox"]:checked')].map(c=>c.value).join(', ');
        try{
          const reply=await callOpenAI([{role:'system',content:'You are a dream symbol interpreter.'},
            {role:'user',content:`Symbols: ${symbols}`}]);
          panel.innerHTML=`<div class="result-content">${formatHTML(reply)}</div>`;
        }catch{
          panel.innerHTML=`<div class="result-content">😕 Oops! Something went wrong.</div>`;
        }
      };
      document.getElementById('generatePrompts').onclick=async()=>{
        const panel=getPanel('dream');
        panel.innerHTML=`<div class="result-content">Generating… <span class="spinner"></span></div>`;
        const narrative=document.getElementById('dreamText').value.trim();
        try{
          const reply=await callOpenAI([{role:'system',content:'You are a creative writing assistant.'},
            {role:'user',content:`Generate 3 journaling prompts inspired by: ${narrative}`}]);
          panel.innerHTML=`<div class="result-content">${formatHTML(reply)}</div>`;
        }catch{
          panel.innerHTML=`<div class="result-content">😕 Oops! Something went wrong.</div>`;
        }
      };

      // ── AUDIO RECORDING STUB ──────────────────────────────────
      document.getElementById('recordAudio').onclick=()=>{
        alert('Audio recording not implemented in this demo.');
      };

      // ── GENERIC WIRING ────────────────────────────────────────
      function wire(id,sys,ask,sec){
        const btn=document.getElementById(id);
        if(!btn)return;
        btn.onclick=async()=>{
          const panel=getPanel(sec);
          panel.innerHTML=`<div class="result-content">Processing… <span class="spinner"></span></div>`;
          const inp=prompt(ask);
          if(!inp)return panel.innerHTML='';
          try{
            const reply=await callOpenAI([{role:'system',content:sys},{role:'user',content:inp}]);
            panel.innerHTML=`<div class="result-content">${formatHTML(reply)}</div>`;
          }catch{
            panel.innerHTML=`<div class="result-content">⚠️ Something went wrong.</div>`;
          }
        };
      }

      // Section 2 extras
      wire('startVideo','Analyze video emotion','Paste video URL…','insight');
      wire('uploadAudio','Analyze audio emotion','Paste audio URL…','insight');
      wire('uploadImage','Analyze image emotion','Paste image URL…','insight');

      // Section 5 Creative
      wire('artGenerate','Generate art prompt','Enter an emotion…','creative');
      wire('musicGenerate','Compose soundscape','Describe your mood…','creative');
      wire('poetryGenerate','Write a poem','Enter a theme…','creative');
      wire('journalGenerate','Generate journaling prompts','Enter a topic…','creative');

      // Section 6 Games
      wire('startPuzzle','Create a logic puzzle','Enter puzzle theme…','games');
      wire('startMemory','Generate a memory-match game','Enter items…','games');
      wire('startStory','Continue a story','Enter story seed…','games');

      // Section 7 Risk
      wire('enableRisk','Assess crisis risk','Describe feelings…','risk');

      // Section 8 Self-care
      wire('generatePlan','Suggest self-care activities','How have you felt…','selfcare');

      // Section 9 VR
      wire('launchPhobia','Generate VR phobia exposure script','Which phobia?','vr');
      wire('launchCalm','Generate VR calm-mind environment','Describe environment…','vr');

      // Section 10 Pro
      wire('processNotes','Summarize session notes','Paste notes…','pro');
      wire('matchTherapist','Match to therapist','Enter profile…','pro');

      // Section 11 Meds
      wire('checkInteractions','Warn of med interactions','Enter two meds…','medsafety');
      wire('setAdherence','Track adherence','Enter schedule…','medsafety');

      // Section 12 Quiz
      wire('submitQuiz','Evaluate symptoms & advise','Answer quiz q’s…','symptomQuiz');

      // Section 13 Community
      wire('enterCircle','Summarize support circle chat','Paste transcript…','community');
      wire('buddyCheckin','Buddy check-in','Enter last mood…','community');

      // ── CHARTS & CSV EXPORT ───────────────────────────────────
      const engCtx=document.getElementById('engagementChart').getContext('2d'),
            outCtx=document.getElementById('outcomeChart').getContext('2d');
      const engChart=new Chart(engCtx,{type:'line',data:{
        labels:['Mon','Tue','Wed','Thu','Fri'],
        datasets:[{label:'Sessions',data:[12,9,14,11,13],
          borderColor:getComputedStyle(document.documentElement).getPropertyValue('--primary').trim(),fill:false}]
      }});
      const outChart=new Chart(outCtx,{type:'bar',data:{
        labels:['Week 1','Week 2','Week 3'],
        datasets:[{label:'Outcome',data:[3.2,4.1,4.5],
          backgroundColor:getComputedStyle(document.documentElement).getPropertyValue('--secondary').trim()}]
      }});
      document.getElementById('exportCharts').onclick=()=>{
        let csv='Chart,Label,Value\n';
        [['Sessions',engChart],['Outcome',outChart]].forEach(([n,ch])=>{
          ch.data.labels.forEach((lab,i)=>{
            csv+=`${n},${lab},${ch.data.datasets[0].data[i]}\n`;
          });
        });
        const blob=new Blob([csv],{type:'text/csv'}),url=URL.createObjectURL(blob),
              a=document.createElement('a');
        a.href=url;a.download='analytics.csv';a.click();URL.revokeObjectURL(url);
      };
    });
  </script>
</body>
</html>
