<!DOCTYPE html>
<html lang="en" aria-theme="light">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Vitra AI â€“ Dashboard</title>

    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

  <style>
      :root {
      --primary: #4A78C4;
      --accent: #FFA500;
      --bg: #F0F4FF;
      --surface: #FFFFFF;
      --text: #1A1A1A;
      --muted: #555555;
      --shadow-light: rgba(0,0,0,0.1);
      --shadow-dark: rgba(0,0,0,0.4);
      --radius: 1rem;
      --padding: 1.5rem;
      --gap: 1rem;
      --max-width: 1200px;
        --secondary: #FFFFFF; 
        --primary-rgb: 74,120,196;  
         --sidebar-w: 280px;
  --sidebar-collapsed-w: 80px;
    }
    html.dark {
      --bg: #1F2233;
      --surface: #2B2E44;
      --text: #E0E0E0;
      --muted: #888888;
      --shadow-light: rgba(0,0,0,0.4);
      --shadow-dark: rgba(0,0,0,0.7);
       --sidebar-w: 280px;
  --sidebar-collapsed-w: 80px;
  --header-h: 64px;

    }

      *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      transition: background-color .3s ease, color .3s ease, box-shadow .3s ease;
    }
    html, body {
      height: 100%;
      width: 100%;
      background: var(--bg);
      color: var(--text);
      font-family: 'Montserrat', sans-serif;
    }
    a { text-decoration: none; color: inherit; }
    button { font: inherit; cursor: pointer; background: none; border: none; }

     body {
      display: flex;
      min-height: 100vh;
      overflow-x: hidden;
    }

  aside#sidebar {
       flex: 0 0 var(--sidebar-w);
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      background: var(--surface);
      box-shadow: 2px 0 12px var(--shadow-light);
      transition: flex 0.3s ease, background 0.3s ease, box-shadow 0.3s ease;
      overflow: hidden;
      z-index: 1000;
      display: flex;
      flex-direction: column;
    }
    aside#sidebar .logo {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 1rem;
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--primary);
   }
    aside#sidebar .logo svg {
      width: 1.8rem;
      height: 1.8rem;
      fill: var(--primary);
      transition: transform 0.3s ease;
   }
    aside#sidebar .logo:hover svg {
     transform: scale(1.1);
    }
    aside#sidebar nav {
      margin-top: 2rem;
      display: flex;
    flex-direction: column;
     flex: 1;
    }
    aside#sidebar nav a {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 0.75rem 1rem;
      border-radius: var(--radius);
      color: var(--text);
      font-weight: 500;
      transition: background 0.3s ease, padding-left 0.3s ease, color 0.3s ease;
    }
    aside#sidebar nav a i {
      font-size: 1.2rem;
      width: 1.2rem;
     text-align: center;
    }
    aside#sidebar nav a:hover,
    aside#sidebar nav a.active {
      background: var(--primary);
      color: #fff;
      padding-left: calc(1rem + 0.5rem);
    }
    aside#sidebar nav a.active {
      font-weight: 700;
    }
   aside#sidebar.collapsed {
      flex: 0 0 var(--sidebar-collapsed-w);
    }
    aside#sidebar.collapsed .logo .logo-text,
    aside#sidebar.collapsed nav a span {
      display: none;
    }
    aside#sidebar.collapsed nav a {
     justify-content: center;
    }
    aside#sidebar nav a:hover,
aside#sidebar nav a.active {
  background: var(--primary);
  color: #fff;
  padding-left: calc(1rem + 0.5rem);
}

aside#sidebar nav a.active {
  font-weight: 700;
}
    #shrinkBtn {
     position: absolute;
      bottom: 1rem;
      left: 50%;
      transform: translateX(-50%);
      width: 36px;
      height: 36px;
      aspect-ratio: 1 / 1;
      background: none;
      color: var(--primary);
      border: 2px solid var(--primary);
    border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: color 0.3s ease, border-color 0.3s ease, transform 0.3s ease;
    }
    #shrinkBtn:hover {
      color: var(--secondary);
      border-color: var(--secondary);
      transform: translateX(-50%) scale(1.1);
    }
    @media (max-width: 1024px) {
      aside#sidebar {
        position: fixed !important;
        transform: translateX(-100%);
        z-index: 900;
        flex: 0 0 280px;
      }
      aside#sidebar.open {
        transform: translateX(0);
      }
      header {
        left: 0 !important;
      }
    }
    @media (max-width: 640px) {
      aside#sidebar:not(.open) {
        display: none;
      }
    }
@media(max-width: 768px) {
    .content {
         grid-template-columns: 1fr;
         padding: 1rem;
       }
  
    .main {
        margin-left: 0;
      }
      .topbar {
        justify-content: center;
      } }
      .main {
     flex: 1;
      display: flex;
      flex-direction: column;
      background: var(--bg);
      padding-top: var(--header-h);
      margin-left: var(--sidebar-w);
      transition: margin-left 0.3s ease;
    }
  aside#sidebar.collapsed ~ .main {
      margin-left: var(--sidebar-collapsed-w);
    }
 header {
     position: fixed;
      top: 0;
      left: var(--sidebar-w);
      right: 0;
      height: var(--header-h);
      background: var(--surface);
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 var(--padding);
      z-index: 999;
      transition: left 0.3s ease, background 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 2px 8px var(--shadow-light);
    }
  html.dark header {
      box-shadow: 0 2px 8px var(--shadow-dark);
    }
  aside#sidebar.collapsed ~ header {
      left: var(--sidebar-collapsed-w);
    }
    header h1 {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text);
    }
    header .hamburger,
    header .theme-toggle {
      font-size: 1.4rem;
      color: var(--primary);
      cursor: pointer;
      transition: transform 0.3s ease, color 0.3s ease;
    }
    header .hamburger:hover,
    header .theme-toggle:hover {
     transform: scale(1.1);
      color: var(--secondary);
    }
    
      .content {
      padding: 2rem;
      max-width: var(--max-width);
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: var(--gap);
    }
    @media(max-width: 768px) {
      .content {
        grid-template-columns: 1fr;
        padding: 1rem;
      }
    }

       .card {
      background: var(--surface);
      border-radius: var(--radius);
      box-shadow: 0 2px 8px var(--shadow-light);
      padding: var(--padding);
      display: flex;
      flex-direction: column;
      transition: transform .2s ease, box-shadow .2s ease;
    }
    html.dark .card {
      box-shadow: 0 2px 8px var(--shadow-dark);
    }
    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 4px 16px var(--shadow-light);
    }
    html.dark .card:hover {
      box-shadow: 0 4px 16px var(--shadow-dark);
    }
    .card h4 {
      margin-bottom: 1rem;
      font-size: 1.25rem;
      color: var(--text);
    }
    .card p {
      margin-bottom: 1rem;
      color: var(--muted);
      flex: 1;
    }
    .card .stat {
      font-size: 2rem;
      font-weight: 600;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }
    .card a {
      margin-top: auto;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      background: var(--primary);
      color: var(--surface);
      border-radius: var(--radius);
      font-weight: 500;
      transition: background-color .2s, transform .2s;
    }
    .card a:hover {
      background: var(--accent);
      transform: translateY(-2px);
    }

       .chart-card {
      background: var(--surface);
      border-radius: var(--radius);
      box-shadow: 0 2px 8px var(--shadow-light);
      padding: var(--padding);
      transition: transform .2s, box-shadow .2s;
    }
    html.dark .chart-card {
      box-shadow: 0 2px 8px var(--shadow-dark);
    }
    .chart-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 4px 16px var(--shadow-light);
    }
    html.dark .chart-card:hover {
      box-shadow: 0 4px 16px var(--shadow-dark);
    }
    .chart-card h4 {
      margin-bottom: 1rem;
      font-size: 1.5rem;
      color: var(--text);
    }
  .chart-container {
      width: 100%;
      height: 240px;
      transition: height 0.3s ease;
    }
  @media (max-width: 768px) {
    .chart-container {
      height: 200px;
    }
  }
  @media (max-width: 480px) {
    .charts-row {
      flex-direction: column;
      gap: var(--gap);
    }
    .chart-container {
      height: 180px;
    }
  }

      .filter-bar {
      grid-column: 1 / -1;
      display: flex;
      gap: 1rem;
      align-items: center;
      background: var(--surface);
      padding: 1rem;
      border-radius: var(--radius);
      box-shadow: 0 2px 8px var(--shadow-light);
      margin-bottom: var(--gap);
    }
    html.dark .filter-bar {
      box-shadow: 0 2px 8px var(--shadow-dark);
    }
    .filter-bar label {
      font-weight: 500;
      color: var(--text);
    }
    .filter-bar input {
      padding: 0.5rem;
      border: 1px solid var(--muted);
      border-radius: var(--radius);
      background: var(--bg);
      color: var(--text);
      font-size: 1rem;
      transition: border-color .2s, box-shadow .2s;
    }
    .filter-bar input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(74,120,196,0.3);
      outline: none;
    }
    html.dark .filter-bar input {
      background: var(--surface);
      border-color: var(--muted);
      color: var(--text);
    }
    .filter-bar button {
      padding: 0.6rem 1.2rem;
      background: var(--primary);
      color: var(--surface);
      border-radius: var(--radius);
      font-weight: 500;
      box-shadow: 0 2px 8px var(--shadow-light);
      transition: background-color .2s, transform .2s;
    }
    .filter-bar button:hover {
      background: var(--accent);
      transform: translateY(-2px);
    }
    html.dark .filter-bar button {
      box-shadow: 0 2px 8px var(--shadow-dark);
    }

       .toast {
      position: fixed;
      bottom: 1.5rem;
      left: 50%;
      transform: translateX(-50%) translateY(100%);
      background: var(--primary);
      color: var(--surface);
      padding: 0.75rem 1.5rem;
      border-radius: var(--radius);
      box-shadow: 0 2px 8px var(--shadow-light);
      opacity: 0;
      pointer-events: none;
      transition: transform .3s ease, opacity .3s ease;
      z-index: 200;
      font-weight: 500;
    }
    html.dark .toast {
      box-shadow: 0 2px 8px var(--shadow-dark);
    }
    .toast.visible {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

   #profileModal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      display: none; 
      align-items: center;
      justify-content: center;
      z-index: 50;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    #profileModal:not([hidden]) {
      display: flex;   
      opacity: 1;
    }


    #profileModal .modal-content {
      background: var(--surface);
    border-radius: var(--radius);
      padding: calc(var(--padding) * 1.2);
      max-width: 400px;
      width: 90%;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      position: relative;
      transform: translateY(-20px);
      animation: slideDown 0.3s forwards;
    }

    @keyframes slideDown {
      to { transform: translateY(0); }
    }

    #profileModal h3 {
      margin-bottom: 1rem;
      font-size: 1.5rem;
      color: var(--primary);
      text-align: center;
    }

    #profileModal label {
      display: block;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--text);
    }

    #profileModal input {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 1px solid var(--muted);
      border-radius: var(--radius);
     background: var(--bg);
     color: var(--text);
      font-size: 1rem;
      margin-bottom: 1rem;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    #profileModal input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(var(--primary-rgb),0.15);
    }

    #profileModal button#saveProfileBtn {
      width: 100%;
      padding: 0.75rem;
      background: var(--primary);
      color: var(--secondary);
      font-size: 1rem;
      font-weight: 600;
     border-radius: var(--radius);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      transition: background 0.2s ease, transform 0.2s ease;
   }
     #profileModal button#saveProfileBtn:hover {
      background: #3A62A8;             
      transform: translateY(-2px);
    }

    #profileModal .btn-close {
      position: absolute;
      top: 0.75rem;
      right: 0.75rem;
      background: transparent;
      color: var(--muted);
      font-size: 1.25rem;
     border: none;
      cursor: pointer;
      transition: color 0.2s ease, transform 0.2s ease;
    }
    #profileModal .btn-close:hover {
     color: var(--primary);
      transform: scale(1.1);
    }

    html.dark #profileModal .modal-content {
      background: var(--surface);
      color: var(--text);
    }
    html.dark #profileModal input {
      background: var(--bg);
      color: var(--text);
      border-color: var(--muted);
    }
    html.dark #profileModal button#saveProfileBtn {
      background: var(--primary);
      color: #fff;
    }
    html.dark #profileModal .btn-close {
      color: var(--muted);
    }
@media screen and (max-width: 480px) {
  .main {
    margin-left: 0;
    padding-bottom: 3rem; 
  }

  .topbar {
    padding: 0.75rem 1rem;
    justify-content: center;
  }
  .topbar .controls {
    display: none; 
  }

  .content {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    padding: 0.75rem 1rem;
  }

  .filter-bar {
    flex-direction: column;
    align-items: stretch;
    gap: 0.5rem;
    padding: 0.5rem 0.75rem;
  }
  .filter-bar label {
    font-size: 0.85rem;
  }
  .filter-bar input,
  .filter-bar button {
    width: 100%;
    font-size: 0.9rem;
    padding: 0.5rem;
  }

  .card {
    padding: 1rem;
  }
  .card h4 {
    font-size: 1.1rem;
  }
  .card .stat {
    font-size: 1.75rem;
  }
  .card a {
    padding: 0.5rem;
    font-size: 0.85rem;
  }

  .chart-card {
    padding: 1rem;
  }
  .chart-container {
    height: 200px;
  }
}

@media screen and (max-width: 768px) {
  .sidebar {
    display: none;
  }

  header {
  position: fixed;
  top: 0;
  left: var(--sidebar-w);
  right: 0;
  height: var(--header-h);
  background: linear-gradient(135deg, var(--primary), var(--accent));
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 1.5rem;
  z-index: 999;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);
  border-bottom-left-radius: 0.5rem;
  border-bottom-right-radius: 0.5rem;
  color: #fff;
  transition: left 0.3s ease, background 0.3s ease;
}

aside#sidebar.collapsed ~ header {
  left: var(--sidebar-collapsed-w);
}

header .left-group {
  display: flex;
  align-items: center;
  gap: 1rem;
}

header .hamburger {
  font-size: 1.6rem;
  cursor: pointer;
  color: #fff;
  display: none; 
  transition: transform 0.2s ease;
}
header .hamburger:hover {
  transform: scale(1.1);
}

@media (max-width: 1024px) {
  header .hamburger {
    display: block;
  }
}

header h1 {
  font-size: 1.6rem;
  font-weight: 700;
  letter-spacing: 0.5px;
  margin: 0;
}

header .right-group {
  display: flex;
  align-items: center;
  gap: 1.5rem;
}

header .welcome {
  font-size: 1rem;
  font-weight: 500;
}

header .theme-toggle {
  font-size: 1.4rem;
  cursor: pointer;
  color: #fff;
  transition: transform 0.2s ease;
}
header .theme-toggle:hover {
  transform: scale(1.1);
}

header #signOutBtn {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  background: rgba(255, 255, 255, 0.2);
  color: #fff;
  font-weight: 600;
  padding: 0.6rem 1rem;
  border-radius: 0.5rem;
  border: 2px solid rgba(255, 255, 255, 0.3);
  transition: background 0.2s ease, transform 0.2s ease;
}
header #signOutBtn:hover {
  background: rgba(255, 255, 255, 0.35);
  transform: translateY(-2px);
}

@media (max-width: 480px) {
  header {
    padding: 0 1rem;
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
  }
  header h1 {
    font-size: 1.3rem;
  }
  header .welcome {
    display: none; 
  }
  header #signOutBtn {
    padding: 0.4rem 0.8rem;
    font-size: 0.9rem;
  }
}

  .main {
    margin-left: 0;
  }

  .topbar {
    padding: 0.75rem 1rem;
  }

  .content {
    grid-template-columns: 1fr !important;
    gap: 0.75rem;
    padding: 1rem;
  }

  .filter-bar {
    flex-wrap: wrap;
    gap: 0.5rem;
  }
  .filter-bar label,
  .filter-bar input,
  .filter-bar button {
    font-size: 0.9rem;
  }

  .card, .chart-card {
    padding: 1rem;
  }
  .chart-container {
    height: 250px;
  }
}
.hamburger-btn {
    background: transparent;
    border: none;
    font-size: 1.5rem;
    color: var(--text);
    cursor: pointer;
    display: none; 
    margin-right: 1rem;
  }
  @media screen and (max-width: 768px) {
    .hamburger-btn {
      display: block; 
    }
  }

@media screen and (max-width: 414px) and (orientation: portrait) {
  .card h4 {
    font-size: 1rem;
  }
  .card .stat {
    font-size: 1.5rem;
  }
  .chart-card h4 {
    font-size: 1.2rem;
  }
  .topbar .welcome {
    font-size: 1rem;
  }
  .topbar i {
    font-size: 1.25rem;
  }
}
.content {
     display: grid;
     grid-template-columns: repeat(2, 1fr); 
     gap: var(--gap);
   }
   .filter-bar {
     grid-column: 1 / -1;
   }
   .chart-card {
     grid-column: span 1;
   }
 }
  </style>
</head>

<body>
 <aside id="sidebar">
   <div class="logo">
      <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" fill="var(--secondary)">
        <polygon points="10,10 25,90 50,40 75,90 90,10 65,10 50,70 35,10"/>
     </svg>
      <span class="logo-text">Vitra AI</span>
    </div>
    <nav role="navigation">
      <a href="#" class="active">
        <i class="fas fa-chart-pie"></i>
       <span>Dashboard</span>
      </a>
      <a href="herbal.html">
       <i class="fas fa-leaf"></i>
        <span>Herbal Medicine</span>
      </a>
      <a href="psychology.html">
        <i class="fas fa-brain"></i>
       <span>Psych &amp; Mental Health</span>
      </a>
      <a href="dietetics.html">
        <i class="fas fa-utensils"></i>
        <span>Dietetics</span>
     </a>
      <a href="epharmacy.html">
        <i class="fas fa-pills"></i>
        <span>E-Pharmacy</span>
      </a>
      <a href="consult.html">
       <i class="fas fa-calendar-check"></i>
        <span>Consultation</span>
      </a>
      <a href="#" id="profileLink">
       <i class="fas fa-user-circle"></i>
        <span>Profile</span>
      </a>
    </nav>
    <button id="shrinkBtn" aria-label="Toggle sidebar">
      <i class="fas fa-angle-double-left"></i>
    </button>
  </aside>
  
   <div class="main">
  <header>
  <div class="left-group">
    <i id="hamburger" class="fas fa-bars hamburger" aria-label="Toggle navigation"></i>
    <h1>Vitra AI Dashboard</h1>
  </div>
  <div class="right-group">
    <div class="welcome">Hello, <strong id="userName">User</strong>!</div>
    <i id="themeToggle" class="fas fa-moon theme-toggle" aria-label="Toggle theme"></i>
    <button id="signOutBtn"><i class="fas fa-sign-out-alt"></i> Sign Out</button>
  </div>
</header>


     <section class="content">
      <div class="filter-bar">
        <label for="startDate">From:</label>
        <input type="date" id="startDate" value="">
        <label for="endDate">To:</label>
        <input type="date" id="endDate" value="">
        <button id="filterBtn"><i class="fas fa-filter"></i> Apply Filter</button>
      </div>

      <div class="card">
        <h4>Herbal Medicine AI</h4>
        <div class="stat" id="herbalQueries">0</div>
        <p>Total AI queries processed in Herbal Medicine</p>
        <a href="herbal.html"><i class="fas fa-seedling"></i> Go to Herbal</a>
      </div>

      <div class="card">
        <h4>Psychology & MH AI</h4>
        <div class="stat" id="psychQueries">0</div>
        <p>Total AI queries processed in Psychology & Mental Health</p>
        <a href="psychology.html"><i class="fas fa-brain"></i> Go to Psychology</a>
      </div>

      <div class="card">
        <h4>Dietetics AI</h4>
        <div class="stat" id="dietQueries">0</div>
        <p>Total AI queries processed in Dietetics</p>
        <a href="dietetics.html"><i class="fas fa-utensils"></i> Go to Dietetics</a>
      </div>

      <div class="card">
        <h4>E-Pharmacy AI</h4>
        <div class="stat" id="pharmacyQueries">0</div>
        <p>Total AI queries processed in E-Pharmacy</p>
        <a href="epharmacy.html"><i class="fas fa-pills"></i> Go to E-Pharmacy</a>
      </div>

      <div class="card">
        <h4>Consult Booking AI</h4>
        <div class="stat" id="consultQueries">0</div>
        <p>Total AI matches performed in Consult Booking</p>
        <a href="consult.html"><i class="fas fa-calendar-check"></i> Go to Consultation</a>
      </div>
     </section>
     
     <section class="charts-row" style="display: flex; gap: var(--gap); padding: var(--padding);">
     <div class="chart-card" style="flex: 1;">
        <h4>Queries Distribution by Sector</h4>
        <div class="chart-container">
          <canvas id="distributionChart"></canvas>
        </div>
      </div>
      <div class="chart-card" style="flex: 1;">
        <h4>Daily AI Queries (Last 7 Days)</h4>
        <div class="chart-container">
          <canvas id="dailyChart"></canvas>
        </div>
      </div>
    </section>
  </div>

  <div id="profileModal" class="modal" hidden>
    <div class="modal-content">
      <button class="btn-close" id="closeProfileModal"><i class="fas fa-times"></i></button>
      <h3>Update Profile</h3>
      <label for="profileName"><i class="fas fa-user"></i> Name:</label>
      <input type="text" id="profileName" placeholder="Enter your name" required/>
      <button id="saveProfileBtn" class="btn"><i class="fas fa-save"></i> Save</button>
    </div>
  </div>
  <div id="toast" class="toast"></div>


<script>
   const firebaseConfig = {
    apiKey: "AIzaSyBhaYOcLMXuobCT-vaXr-zXTZnBfaheAIY",
    authDomain: "vitra-ai-712ea.firebaseapp.com",
    projectId: "vitra-ai-712ea",
    storageBucket: "vitra-ai-712ea.appspot.com",
    messagingSenderId: "306868103753",
    appId: "1:306868103753:web:e2d7700f8ad34c1e17ed98"
  };
  firebase.initializeApp(firebaseConfig);

  document.addEventListener('DOMContentLoaded', () => {

 const sidebarLinks = document.querySelectorAll('aside#sidebar nav a');
    sidebarLinks.forEach(link => {
      const href = link.getAttribute('href') || '';
      const current = window.location.pathname.split('/').pop() || '';
      if ((href === '#' && current === '') || href === current) {
        link.classList.add('active');
      } else {
        link.classList.remove('active');
      }
    });

    
    const sidebar = document.getElementById("sidebar");
    const shrinkBtn = document.getElementById("shrinkBtn");
    const hamburger = document.getElementById("hamburger");
    const header = document.querySelector("header");

    if (localStorage.getItem("sidebar-collapsed") === "true") {
      sidebar.classList.add("collapsed");
      shrinkBtn.querySelector("i").classList.replace("fa-angle-double-left", "fa-angle-double-right");
      header.classList.add("sidebar-collapsed");
    }
    shrinkBtn.addEventListener("click", () => {
      sidebar.classList.toggle("collapsed");
      const icon = shrinkBtn.querySelector("i");
      icon.classList.toggle("fa-angle-double-left");
      icon.classList.toggle("fa-angle-double-right");
      header.classList.toggle("sidebar-collapsed");
     localStorage.setItem("sidebar-collapsed", sidebar.classList.contains("collapsed"));
    const main = document.querySelector('.main');
      if (sidebar.classList.contains('collapsed')) {
        main.style.marginLeft = getComputedStyle(document.documentElement).getPropertyValue('--sidebar-collapsed-w');
      } else {
        main.style.marginLeft = getComputedStyle(document.documentElement).getPropertyValue('--sidebar-w');
      }
    });

    function updateHamburgerVisibility() {
      hamburger.style.display = window.matchMedia("(max-width: 1024px)").matches ? "block" : "none";
    }
    window.matchMedia("(max-width: 1024px)").addListener(updateHamburgerVisibility);
    updateHamburgerVisibility();

    hamburger.addEventListener("click", e => {
      e.stopPropagation();
      sidebar.classList.toggle("open");
    });
    document.addEventListener("click", e => {
      if (!sidebar.classList.contains("open")) return;
     if (sidebar.contains(e.target) || hamburger.contains(e.target)) return;
      sidebar.classList.remove("open");
    });

      const adjustHeader = () => {
      const sidebarW = sidebar.classList.contains('collapsed')
        ? getComputedStyle(document.documentElement).getPropertyValue('--sidebar-collapsed-w')
        : getComputedStyle(document.documentElement).getPropertyValue('--sidebar-w');
      header.style.left = sidebarW;
   };
    adjustHeader();
    window.addEventListener('resize', adjustHeader);
    
    document.querySelectorAll('aside#sidebar nav a').forEach(link => {
      const linkHref = link.getAttribute("href").split("/").pop();
      const pageNow = window.location.pathname.split("/").pop();
      if (linkHref === pageNow) link.classList.add("active");
      else link.classList.remove("active");
    });
   
        const themeToggle = document.getElementById('themeToggle');
    const signOutBtn = document.getElementById('signOutBtn');
    const userNameEl = document.getElementById('userName');
    const profileLink = document.getElementById('profileLink');
    const profileModal = document.getElementById('profileModal');
    const closeProfileModal = document.getElementById('closeProfileModal');
    const profileNameInput = document.getElementById('profileName');
    const saveProfileBtn = document.getElementById('saveProfileBtn');

    const toastEl = document.getElementById('toast');
    const startDateInput = document.getElementById('startDate');
    const endDateInput = document.getElementById('endDate');
    const filterBtn = document.getElementById('filterBtn');

    const herbalQueriesEl = document.getElementById('herbalQueries');
    const psychQueriesEl = document.getElementById('psychQueries');
    const dietQueriesEl = document.getElementById('dietQueries');
    const pharmacyQueriesEl = document.getElementById('pharmacyQueries');
    const consultQueriesEl = document.getElementById('consultQueries');

    firebase.auth().onAuthStateChanged(user => {
      if (!user) return window.location.href = 'index.html';
      const display = user.displayName || "";
      userNameEl.textContent = display || "User";
      profileNameInput.value = display;
    });

    themeToggle.onclick = () => {
      document.documentElement.classList.toggle('dark');
      themeToggle.classList.toggle('fa-moon');
      themeToggle.classList.toggle('fa-sun');
    };

    signOutBtn.onclick = () => {
      firebase.auth().signOut().then(() => {
        window.location.href = 'index.html';
      });
    };

    function showToast(message) {
      toastEl.textContent = message;
      toastEl.classList.add('visible');
      setTimeout(() => toastEl.classList.remove('visible'), 3000);
    }

    function varColor(name) {
      return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
    }

       let statsData = {
      herbal: 0,
      psych: 0,
      diet: 0,
      pharmacy: 0,
      consult: 0,
      daily: [0, 0, 0, 0, 0, 0, 0],
      labels: []
    };

    function generateLast7Days() {
      const labels = [];
      for (let i = 6; i >= 0; i--) {
        const d = new Date();
        d.setDate(d.getDate() - i);
        labels.push(d.toLocaleDateString('default', { month: 'short', day: 'numeric' }));
      }
      return labels;
    }
    statsData.labels = generateLast7Days();

    function displayStats() {
      statsData.herbal   = parseInt(localStorage.getItem('statHerbal'))   || 0;
      statsData.psych    = parseInt(localStorage.getItem('statPsych'))    || 0;
      statsData.diet     = parseInt(localStorage.getItem('statDiet'))     || 0;
      statsData.pharmacy = parseInt(localStorage.getItem('statPharmacy')) || 0;
      statsData.consult  = parseInt(localStorage.getItem('statConsult'))  || 0;

      herbalQueriesEl.textContent   = statsData.herbal;
      psychQueriesEl.textContent    = statsData.psych;
      dietQueriesEl.textContent     = statsData.diet;
      pharmacyQueriesEl.textContent = statsData.pharmacy;
      consultQueriesEl.textContent  = statsData.consult;
    }
    displayStats();



    const distCtx = document.getElementById('distributionChart').getContext('2d');
   const distributionChart = new Chart(distCtx, {
  type: 'doughnut',
  data: {
    labels: ['Herbal', 'Psych', 'Diet', 'Pharmacy', 'Consult'],
    datasets: [{
      data: [statsData.herbal, statsData.psych, statsData.diet, statsData.pharmacy, statsData.consult],
      backgroundColor: [
        'rgba(74,120,196,0.8)',      
        'rgba(255,165,0,0.8)',      
        'rgba(139,195,74,0.8)',     
        'rgba(255,87,34,0.8)',      
        'rgba(63,81,181,0.8)'      
      ],
      borderColor: 'rgba(255,255,255,0.9)',
      borderWidth: 2
    }]
  },
  options: {
    responsive: true,
    cutout: '50%',  
    plugins: {
      legend: {
        position: 'bottom',
        labels: {
          color: varColor('--text'),
          padding: 20,
          boxWidth: 12
        }
      },
      tooltip: {
        backgroundColor: varColor('--surface'),
        titleColor: varColor('--text'),
        bodyColor: varColor('--text'),
        borderColor: varColor('--muted'),
        borderWidth: 1
      }
    }
  }
});


    const dailyCtx = document.getElementById('dailyChart').getContext('2d');
    const dailyChart = new Chart(dailyCtx, {
  type: 'line',
  data: {
    labels: statsData.labels, 
    datasets: [{
      label: 'Daily Queries',
      data: [], 
      borderColor: 'rgba(74,120,196,1)',
      backgroundColor: 'rgba(74,120,196,0.2)',
      pointBackgroundColor: 'rgba(74,120,196,1)',
      pointBorderColor: varColor('--surface'),
      pointBorderWidth: 2,
      tension: 0.3,
      fill: true,
      borderWidth: 3,
      pointRadius: 5,
      pointHoverRadius: 7
    }]
  },
  options: {
    responsive: true,
    scales: {
      x: {
        ticks: { color: varColor('--text'), maxRotation: 0, minRotation: 0 },
        grid: { color: varColor('--muted'), drawBorder: false }
      },
      y: {
        beginAtZero: true,
        ticks: { color: varColor('--text') },
        grid: { color: varColor('--muted'), borderDash: [5, 5] }
      }
    },
    plugins: {
      legend: { display: false },
      tooltip: {
        backgroundColor: varColor('--surface'),
        titleColor: varColor('--text'),
        bodyColor: varColor('--text'),
        borderColor: varColor('--muted'),
        borderWidth: 1,
        cornerRadius: 4
      }
    }
  }
});

  const dailyCounts = [];
for (let i = 6; i >= 0; i--) {
  const dayStart = new Date();
  dayStart.setHours(0, 0, 0, 0);
  dayStart.setDate(dayStart.getDate() - i);

  const dayEnd = new Date(dayStart);
  dayEnd.setHours(23, 59, 59, 999);

  function countDay(key) {
    const raw = localStorage.getItem(key) || '[]';
    const arr = JSON.parse(raw);
    return arr.filter(ts => {
      const d = new Date(ts);
      return d >= dayStart && d <= dayEnd;
    }).length;
  }

  const sumForDay =
    countDay('timestampsHerbal') +
    countDay('timestampsPsych') +
    countDay('timestampsDiet') +
    countDay('timestampsPharmacy') +
    countDay('timestampsConsult');

  dailyCounts.push(sumForDay);
}

dailyChart.data.datasets[0].data = dailyCounts;
dailyChart.update();
    
    filterBtn.onclick = () => {
      const start = startDateInput.value;
      const end   = endDateInput.value;
      if (!start || !end) {
        showToast('Please pick both dates');
        return;
      }
      const startDate = new Date(start);
      const endDate   = new Date(end);
      endDate.setHours(23, 59, 59, 999);
      if (startDate > endDate) {
        showToast('Start date cannot be after end date');
        return;
      }

      function countInRange(key) {
        const raw = localStorage.getItem(key) || '[]';
        const arr = JSON.parse(raw);
        return arr.filter(ts => {
          const d = new Date(ts);
          return d >= startDate && d <= endDate;
        }).length;
      }

      statsData.herbal   = countInRange('timestampsHerbal');
      statsData.psych    = countInRange('timestampsPsych');
      statsData.diet     = countInRange('timestampsDiet');
      statsData.pharmacy = countInRange('timestampsPharmacy');
      statsData.consult  = countInRange('timestampsConsult');

      const last7Counts = [];
      const labels      = [];
      for (let i = 6; i >= 0; i--) {
        const dayStart = new Date();
        dayStart.setHours(0, 0, 0, 0);
        dayStart.setDate(dayStart.getDate() - i);
        const dayEnd = new Date(dayStart);
        dayEnd.setHours(23, 59, 59, 999);

        function countForDay(key) {
          const raw = localStorage.getItem(key) || '[]';
          const arr = JSON.parse(raw);
          return arr.filter(ts => {
            const d = new Date(ts);
            return d >= dayStart && d <= dayEnd;
          }).length;
        }

        const countHerbal   = countForDay('timestampsHerbal');
        const countPsych    = countForDay('timestampsPsych');
        const countDiet     = countForDay('timestampsDiet');
        const countPharma   = countForDay('timestampsPharmacy');
        const countConsult  = countForDay('timestampsConsult');

        last7Counts.push(countHerbal + countPsych + countDiet + countPharma + countConsult);
        labels.push(dayStart.toLocaleDateString('default', { month: 'short', day: 'numeric' }));
      }
      statsData.daily  = last7Counts;
      statsData.labels = labels;

      herbalQueriesEl.textContent   = statsData.herbal;
      psychQueriesEl.textContent    = statsData.psych;
      dietQueriesEl.textContent     = statsData.diet;
      pharmacyQueriesEl.textContent = statsData.pharmacy;
      consultQueriesEl.textContent  = statsData.consult;

      distributionChart.data.datasets[0].data = [
        statsData.herbal,
        statsData.psych,
        statsData.diet,
        statsData.pharmacy,
        statsData.consult
      ];
      distributionChart.update();

      dailyChart.data.labels           = statsData.labels;
      dailyChart.data.datasets[0].data = statsData.daily;
      dailyChart.update();

      showToast('Statistics updated for selected range');
    };

    profileLink.onclick = () => {
      profileModal.hidden = false;
      profileNameInput.focus();
    };

    closeProfileModal.onclick = () => {
      profileModal.hidden = true;
    };

    saveProfileBtn.onclick = async () => {
      const newName = profileNameInput.value.trim();
      if (!newName) {
        showToast('Name cannot be empty');
        return;
      }
      const user = firebase.auth().currentUser;
      if (user) {
        try {
          await user.updateProfile({ displayName: newName });
          userNameEl.textContent = newName;
          localStorage.setItem('displayName', newName);
          showToast('Profile updated');
          profileModal.hidden = true;
        } catch (err) {
          console.error(err);
          showToast('Could not update profile');
        }
      }
    };

    const storedName = localStorage.getItem('displayName');
    if (storedName) {
      userNameEl.textContent = storedName;
    }
  });
</script>

  
</body>
</html>
