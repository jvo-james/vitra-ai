<!DOCTYPE html>
<html lang="en" aria-theme="light">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Vitra AI – Herbal Medicine Hub</title>
  
<!-- Montserrat + FontAwesome -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet"/>
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet"/>
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet"/>
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
  /*────────────────── RESET & BASE ──────────────────*/
  *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
  html { font-family:'Montserrat',sans-serif; font-size:16px; scroll-behavior:smooth; }
  body { display:flex; min-height:100vh; background:var(--bg); color:var(--text); overflow-x:hidden; }

  /*────────────────── THEME VARIABLES ──────────────────*/
  :root {
    --primary: #2a6f4e;            /* deep green */
    --secondary: #8e6c4b;          /* earthy brown */
    --accent: #d4c5a2;             /* light gold/ivory */
    --bg: #f8f6f0;                 /* ivory */
    --surface: #ffffff;
    --text: #333333;
    --muted: #6b6b6b;
    --bg-dark: #1f1f1f;
    --surface-dark: #2a2a2a;
    --text-dark: #ececec;
    --muted-dark: #888888;
    --radius: 0.75rem;
    --padding: 1rem;
    --transition: 0.3s ease;
    --sidebar-w: 280px;
    --sidebar-collapsed-w: 80px;
    --header-h: 64px;
  }
  html.dark {
    --bg: var(--bg-dark);
    --surface: var(--surface-dark);
    --text: var(--text-dark);
    --muted: var(--muted-dark);
  }

  /*────────────────── LAYOUT ──────────────────*/
  aside {
    flex: 0 0 var(--sidebar-w);
    position:sticky; top:0; height:100vh;
    background:var(--surface); box-shadow:2px 0 12px rgba(0,0,0,0.05);
    transition:flex var(--transition);
    overflow:hidden;
    z-index:1000;
  }
  aside.collapsed { flex:0 0 var(--sidebar-collapsed-w); }
  aside .brand {
    display:flex; align-items:center; gap:.75rem;
    padding:var(--padding); font-size:1.4rem; font-weight:700; color:var(--primary);
  }
  aside nav { margin-top:2rem; }
  aside nav a {
    display:flex; align-items:center; gap:1rem;
    padding:.75rem var(--padding); border-radius:var(--radius);
    color:var(--text); font-weight:500; text-decoration:none;
    transition: background var(--transition), padding-left var(--transition);
  }
  aside nav a i { font-size:1.2rem; }
  aside nav a:hover, aside nav a.active {
    background:var(--primary); color:#fff;
    padding-left:calc(var(--padding)+0.5rem);
  }
  aside.collapsed nav a span { display:none; }
  #shrinkBtn {
    position:absolute; bottom:var(--padding); left:-18px;
    width:36px; height:36px; background:var(--primary);
    color:#fff; border:none; border-radius:50%; cursor:pointer;
    box-shadow:0 3px 8px rgba(0,0,0,0.15);
    transition:transform var(--transition);
  }
  #shrinkBtn:hover { transform:scale(1.1); }

  header {
    position:fixed; top:0; left:var(--sidebar-w); right:0;
    height:var(--header-h); background:var(--surface);
    border-bottom:1px solid #e1e8ed; display:flex;
    align-items:center; justify-content:space-between;
    padding:0 var(--padding); z-index:999; transition:left var(--transition);
  }
  aside.collapsed ~ header { left:var(--sidebar-collapsed-w); }
  header h1 { font-size:1.5rem; font-weight:600; color:var(--text); }
  header .hamburger, header .theme-toggle {
    font-size:1.4rem; color:var(--primary); cursor:pointer;
    transition:transform var(--transition);
  }
  header .hamburger:hover, header .theme-toggle:hover { transform:scale(1.1); }

  main {
    flex:1; padding:calc(var(--header-h)+var(--padding)) var(--padding) var(--padding);
    background:var(--bg);
  }

  /*────────────────── MODULES ──────────────────*/
  .module {
    background:var(--surface); border-radius:var(--radius);
    padding:var(--padding); box-shadow:0 2px 8px rgba(0,0,0,0.03);
    margin-bottom:1.5rem; transition:transform var(--transition), box-shadow var(--transition);
  }
  .module:hover { transform:translateY(-4px); box-shadow:0 4px 16px rgba(0,0,0,0.06); }
  .module h2 {
    display:flex; align-items:center; gap:.75rem; margin-bottom:.75rem;
    font-size:1.25rem; color:var(--primary);
  }
  .module p.desc { font-size:.95rem; color:var(--muted); margin-bottom:1rem; }

  form { display:flex; flex-wrap:wrap; gap:1rem; align-items:flex-end; }
  input, select, textarea, button {
    border-radius:var(--radius); transition:border-color var(--transition), box-shadow var(--transition);
  }
  input, select, textarea {
    flex:1 1 200px; padding:.75rem; border:1.5px solid #d1dce5;
    background:var(--bg); color:var(--text); font-size:.95rem;
  }
  input:focus, select:focus, textarea:focus {
    outline:none; border-color:var(--primary); box-shadow:0 0 8px var(--primary);
  }
  button {
    background:var(--primary); color:#fff; padding:.7rem 1.4rem;
    border:none; font-size:.95rem; font-weight:600; cursor:pointer;
    box-shadow:0 3px 10px rgba(0,0,0,0.1);
  }
  button[disabled] { opacity:0.6; cursor:not-allowed; }
  button:hover:not([disabled]) { transform:scale(1.03); box-shadow:0 5px 14px rgba(0,0,0,0.12); }

  .hint { width:100%; font-size:.85rem; color:var(--muted); }

  .response {
    background:var(--secondary); background:rgba(142,108,75,0.1);
    border-left:4px solid var(--secondary);
    padding:var(--padding); border-radius:var(--radius);
    margin-top:1rem; position:relative;
  }
  .response[aria-live] { padding-right:2.5rem; }
  .close-btn {
    position:absolute; top:.5rem; right:.5rem; width:24px; height:24px;
    background:var(--secondary); color:#fff; border-radius:50%;
    display:flex; align-items:center; justify-content:center; cursor:pointer;
  }

    /* Symptom Checker Enhancements */
.symptom-module { background:linear-gradient(135deg, #e8f5f1 0%, #fbfcfb 100%); }
.sym-form .field { margin-bottom:1rem; display:flex; flex-direction:column; }
.sym-form label { font-weight:600; margin-bottom:.5rem; color:var(--secondary); }
.sym-form textarea, .sym-form input[type="date"], .sym-form input[type="range"] {
  width:100%; padding:.75rem; border:1px solid #d1dce5; border-radius:var(--radius);
}
.tags { display:flex; gap:.5rem; flex-wrap:wrap; }
.tag {
  background:var(--accent); border:1px solid var(--secondary);
  border-radius:var(--radius); padding:.4rem .8rem; cursor:pointer;
  transition:background var(--transition), color var(--transition);
}
.tag.selected { background:var(--secondary); color:#fff; }
.severity-field { align-items:center; }
#sevValue { font-weight:600; margin-left:.5rem; color:var(--secondary); }

.response.sym-response {
  border-left-color:var(--secondary);
  background:rgba(47,169,161,0.075);
}
.sym-response .result-header {
  display:flex; justify-content:space-between; align-items:center;
  margin-bottom:1rem;
}
.confidence { display:flex; align-items:center; gap:.5rem; font-size:.95rem; }
.conf-bar {
  width:100px; height:8px; background:#e1e8ed; border-radius:4px; overflow:hidden;
}
.conf-fill {
  height:100%; background:var(--secondary); width:0%;
  transition:width 0.6s ease;
}
.herb-cards {
  display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
  gap:1rem; margin-bottom:1rem;
}
.herb-card {
  background:var(--surface); border-radius:var(--radius); padding:.75rem;
  box-shadow:0 2px 8px rgba(0,0,0,0.05);
  display:flex; flex-direction:column; gap:.5rem;
}
.herb-card h4 { margin:0; color:var(--primary); }
.evidence-badge {
  align-self:flex-start; padding:.25rem .5rem; border-radius:var(--radius);
  font-size:.8rem; font-weight:600; color:#fff;
}
.evidence-badge.well { background:#2fa9a1; }
.evidence-badge.anecdotal { background:#8e6c4b; }
.disclaimer { font-size:.85rem; color:var(--muted); margin-top:.5rem; }
  /*────────────────── HERO ──────────────────*/
  #hero {
    display:flex; flex-direction:column; align-items:center; text-align:center;
    padding:4rem 1rem; background:linear-gradient(135deg,#e8f5f1 0%,#f5fafb 100%);
    margin-bottom:2rem; border-radius:var(--radius);
  }
  #hero h1 { font-size:2.5rem; color:var(--primary); margin-bottom:1rem; }
  #hero p { font-size:1.1rem; color:var(--text); margin-bottom:1.5rem; }
  #hero .cta { display:flex; gap:1rem; flex-wrap:wrap; justify-content:center; }
  #hero .cta button { min-width:160px; }
  #hero video { margin-top:2rem; max-width:600px; width:100%; border-radius:var(--radius); }

  /*────────────────── FOOTER ──────────────────*/
  footer {
    background:var(--surface); padding:var(--padding);
    text-align:center; font-size:.85rem; color:var(--muted);
    margin-top:2rem; border-top:1px solid #e1e8ed;
  }
  footer a { color:var(--primary); text-decoration:none; margin:0 .5rem; }

  /*────────────────── SPINNER ──────────────────*/
  .spinner {
    display:inline-block; width:1em; height:1em; border:2px solid var(--primary);
    border-top-color:transparent; border-radius:50%;
    animation:spin .8s linear infinite; vertical-align:middle; margin-left:.25em;
  }
  @keyframes spin { to { transform:rotate(360deg); } }

  /*────────────────── RESPONSIVE ──────────────────*/
  @media (max-width:1024px) {
    aside { position:fixed; transform:translateX(-100%); z-index:900; }
    aside.open { transform:translateX(0); }
    header { left:0!important; }
    #hero { padding:3rem 1rem; }
  }
  @media (max-width:640px) {
    form { flex-direction:column; }
    input, select, textarea, button { width:100% !important; }
    .module select[multiple] { max-height:200px; overflow-y:auto; }
    #hero { padding:2rem 0.5rem; }
    #shrinkBtn { bottom:0.5rem; }
     .sym-form textarea,
   .sym-form input[type="date"],
   .sym-form input[type="range"] {
     width: auto;
     max-width: 280px;
     padding: 0.5rem;
     font-size: 0.9rem;
   }
   .sym-form .tags {
     gap: 0.25rem;
   }
  
  }
  @media (max-width:480px) {
    input, select, textarea, button { font-size:0.9rem; }
    #hero h1 { font-size:2rem; }
  }

      button:hover:not([disabled]) { transform:scale(1.03); box-shadow:0 5px 14px rgba(0,0,0,0.12); }

 /* Enhanced Symptom Checker button */
 .btn-primary {
   background: var(--secondary);
  color: #fff;
 }
  .btn-primary:hover {
  /* example slightly darker brown */
  background: #79573d;
}

    .response {
  position: relative;
  padding-top: 2rem; /* make room for the × */
}
.response .close-btn {
  top: 0.5rem;
  right: 0.5rem;
  z-index: 10;
}

    .user-msg, .bot-msg {
  max-width:80%; margin:0.5rem; padding:0.7rem 1rem; border-radius:1rem; position:relative;
}
.user-msg { background:var(--primary); color:#fff; align-self:flex-end; }
.bot-msg  { background:var(--surface); color:var(--text); align-self:flex-start; }
.timestamp {
  font-size:0.7rem; position:absolute; bottom:-1.2rem;
  right:0.8rem; color:var(--muted);
}
    @media (max-width:640px) {
  .module { display:flex; flex-direction:column; }
  .charts { grid-template-columns:1fr !important; }
  form { flex-direction:column; }
  #chatBox { max-height:200px; }
}
    .chat-controls button { background:none; border:none; font-size:1.1rem; margin-left:0.5rem; }
.chat-box { background:var(--bg); border:1px solid #d1dce5; border-radius:var(--radius);
            padding:var(--padding); min-height:200px; max-height:300px; overflow-y:auto; }
.chat-input-row { display:flex; gap:0.5rem; margin-top:0.5rem; }
.tool-row {
  display: flex;
  gap: 0.5rem;
  margin-top: 0.5rem;
}
.tool-row button {
  background: none;
  border: none;
  font-size: 1rem;       /* smaller icons */
  color: var(--muted);
  cursor: pointer;
}
.tool-row button:hover {
  color: var(--primary);
}
    .close-btn {
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  width: 1.5rem;
  height: 1.5rem;
  background: var(--secondary);
  color: #fff;
  border: none;
  border-radius: 50%;
  font-size: 1.1rem;
  line-height: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transform: scale(0.8);
  transition: opacity 0.2s, transform 0.2s;
}
.response:hover .close-btn {
  opacity: 1;
  transform: scale(1);
}
@media (max-width:640px) {
  .close-btn {
    width: 2rem; height: 2rem; font-size: 1.2rem;
  }
}
  </style>
</head>

<body>

  <!-- ONBOARDING MODAL -->
  <div id="onboardModal" role="dialog" aria-modal="true" aria-labelledby="onboardTitle" style="position:fixed;inset:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;">
    <div style="background:var(--surface);padding:2rem;border-radius:var(--radius);max-width:400px;text-align:center;">
      <h2 id="onboardTitle" style="color:var(--primary)">Welcome to Vitra AI Herbal Hub</h2>
      <p>Empowering Traditional Healing with Artificial Intelligence.<br/>Explore plant IDs, custom blends, and more.</p>
      <button onclick="onboardClose()">Get Started</button>
    </div>
  </div>

  <!-- SIDEBAR -->
  <aside id="sidebar">
    <div class="brand"><i class="fas fa-leaf"></i><span>Vitra AI</span></div>
    <nav role="navigation">
      <!-- Links to every section -->
      <a href="#hero" class="active"><i class="fas fa-home"></i><span>Home</span></a>
      <a href="#hero–identifier"><i class="fas fa-camera"></i><span>Herb Identifier</span></a>
      <a href="#hero-symptom"><i class="fas fa-notes-medical"></i><span>Symptom Checker</span></a>
      <a href="#hero–cultural"><i class="fas fa-globe"></i><span>Cultural Knowledge</span></a>
      <a href="#hero–safety"><i class="fas fa-shield-alt"></i><span>Safety Checker</span></a>
      <a href="#hero–chat"><i class="fas fa-comments"></i><span>AI Herbalist Chat</span></a>
      <a href="#formulations"><i class="fas fa-user-shield"></i><span>Personalized Formulations</span></a>
      <a href="#research"><i class="fas fa-book-reader"></i><span>Research Summaries</span></a>
      <a href="#inventory"><i class="fas fa-warehouse"></i><span>Inventory Forecast</span></a>
      <a href="#genetics"><i class="fas fa-dna"></i><span>Genetics Match</span></a>
      <a href="#dosage"><i class="fas fa-calculator"></i><span>Dosage Calculator</span></a>
      <a href="#interaction"><i class="fas fa-exchange-alt"></i><span>Interaction Checker</span></a>
      <a href="#addons"><i class="fas fa-plus-circle"></i><span>Add-Ons</span></a>
      <a href="#analytics"><i class="fas fa-chart-line"></i><span>Analytics</span></a>
      <a href="#roi"><i class="fas fa-dollar-sign"></i><span>ROI Calculator</span></a>
      <a href="#about"><i class="fas fa-cogs"></i><span>About & Tech</span></a>
      <a href="#contact"><i class="fas fa-envelope"></i><span>Contact</span></a>
      <button id="shrinkBtn" aria-label="Toggle sidebar"><i class="fas fa-angle-double-left"></i></button>
    </nav>
  </aside>

  <!-- HEADER -->
  <header>
    <div>
      <i id="hamburger" class="fas fa-bars hamburger" aria-label="Toggle navigation"></i>
      <h1>Herbal Medicine Hub</h1>
    </div>
    <div>
      <i id="themeToggle" class="fas fa-moon theme-toggle" aria-label="Toggle theme"></i>
    </div>
  </header>

  <!-- MAIN CONTENT -->
  <main role="main">
    <!-- HERO -->
    <section id="hero">
      <h1>Empowering Traditional Healing with Artificial Intelligence</h1>
      <p>Discover, personalize, and manage herbal remedies with AI-powered tools—designed for practitioners and enthusiasts alike.</p>
      <div class="cta">
        <button onclick="scrollToSection('hero–identifier')">Try Herb Identifier</button>
        <button onclick="scrollToSection('hero–chat')">Chat with Herbalist</button>
      </div>
      <video src="path/to/intro.mp4" controls aria-label="Intro demonstration video"></video>
    </section>

    <!-- EXECUTIVE ANALYTICS DASHBOARD -->
    <section id="analytics" class="module">
  <h2><i class="fas fa-chart-line"></i> Executive Analytics & KPIs</h2>
  <p class="desc">Real‐time metrics to track adoption, efficacy, supply and ROI at a glance.</p>
  <div class="charts">
    <figure class="chart-card">
      <canvas id="chartAdoption"></canvas>
      <figcaption><strong>Adoption Over Time:</strong> How quickly new users adopt herbal AI tools each month.</figcaption>
    </figure>
    <figure class="chart-card">
      <canvas id="chartEfficacy"></canvas>
      <figcaption><strong>Efficacy Outcomes:</strong> Percentage of positive feedback per symptom category.</figcaption>
    </figure>
    <figure class="chart-card">
      <canvas id="chartSupply"></canvas>
      <figcaption><strong>Supply Impact:</strong> Inventory usage for top three herbs this quarter.</figcaption>
    </figure>
    <figure class="chart-card">
      <canvas id="chartROI"></canvas>
      <figcaption><strong>Financial ROI:</strong> Quarterly return on investment from AI automation.</figcaption>
    </figure>
  </div>
  <button onclick="exportAnalytics()">Export Full CSV</button>
</section>

    <!-- 1. Herb Identifier -->
    <section id="hero–identifier" class="module">
      <h2><i class="fas fa-camera"></i> AI Plant Scanner</h2>
      <p class="desc">Upload a photo; our AI will identify the plant (e.g. <em>Moringa oleifera</em> placeholder).</p>
      <form id="iden-form">
        <textarea id="idenDesc" rows="2" placeholder="Or describe your plant here…"></textarea>
        <input type="file" accept="image/*" aria-label="Upload plant image" onchange="previewImage(this)"/>
        <button type="submit">Identify</button>
        <div class="hint">Use a clear close-up of a leaf or flower.</div>
      </form>
      <img id="idenPreview" alt="" style="max-width:200px;margin-top:1rem;display:none;"/>
      <div id="idenResult" class="response" role="status" aria-live="polite" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
      </div>
    </section>

   <!-- ENHANCED SYMPTOM CHECKER -->
<section id="hero-symptom" class="module symptom-module">
  <h2><i class="fas fa-notes-medical"></i> Symptom Checker</h2>
  <p class="desc">Tell us your symptoms and duration, choose severity, then get AI‐powered herb recommendations.</p>
  <form id="sym-form" class="sym-form">
    <div class="field">
      <label for="symInput">Your Symptoms</label>
      <textarea id="symInput" required placeholder="e.g. headache, nausea…"></textarea>
    </div>
    <div class="field">
      <label for="symCategories">Category</label>
      <select id="symCategories" multiple>
        <option value="pain">Pain</option>
        <option value="digestive">Digestive</option>
        <option value="respiratory">Respiratory</option>
        <option value="stress">Stress</option>
      </select>
    </div>
    <div class="field range-field">
      <label for="severity">Severity</label>
      <input type="range" id="severity" min="1" max="10" value="5"/>
      <span id="sevValue">5</span>/10
    </div>
    <div class="field">
      <label for="symDuration">Duration (days)</label>
      <input type="number" id="symDuration" min="0" placeholder="e.g. 3"/>
    </div>
    <button type="submit" class="btn-primary">Get Recommendations</button>
  </form>

  <div id="symResult" class="response sym-response" hidden>
    <div class="response-header">
      <button class="close-btn">×</button>
      <h3><i class="fas fa-seedling"></i> Your Herb Recommendations</h3>
    </div>
    <div class="result-content"></div>
  </div>
</section>

    <!-- 3. Cultural Knowledge -->
 <section id="hero–cultural" class="module">
  <h2>🌍 Cultural Knowledge</h2>
  <p class="desc">Enter a region, tradition or herb name (e.g. “West African uses of moringa”) to get practices, rituals & folklore.</p>
   <textarea id="cultureQuery" rows="2" placeholder="e.g. West African herbal uses…" ></textarea>
  <button onclick="getCulture()">Get Insights</button>
  <div id="cultureResult" class="response" hidden>
    <button class="close-btn"></button>
    <div class="result-content"></div>
  </div>
</section>

    <!-- 4. Safety Checker -->
    <section id="hero–safety" class="module">
      <h2><i class="fas fa-shield-alt"></i> Safety Checker</h2>
      <p class="desc">Enter two items (herbs or medications) to check for dangerous interactions.</p>
      <form id="safety-form">
        <input id="safetyA" placeholder="Item A (e.g. Turmeric)" aria-label="Item A" required/>
        <input id="safetyB" placeholder="Item B (e.g. Warfarin)" aria-label="Item B" required/>
        <button type="submit">Check</button>
        <div class="hint">Pick two distinct items.</div>
      </form>
      <div id="safetyResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <p><strong>Moderate Interaction:</strong> Turmeric may potentiate anticoagulants.</p>
      </div>
    </section>

    <!-- 5. AI Herbalist Chat -->
    <section id="hero–chat" class="module">
      <h2><i class="fas fa-comments"></i> AI Herbalist Chat</h2>
         <div class="chat-controls">
      <button id="closeChat" title="Close Chat"><i class="fas fa-times"></i></button>
      <button id="viewHistory" title="View History"><i class="fas fa-history"></i></button>
      <button id="clearChat" title="Clear Chat"><i class="fas fa-trash-alt"></i></button>
    </div>
      <p class="desc">Ask about herbal remedies:</p>
      <div id="chatBox" role="log" aria-live="polite" style="background:var(--bg);border:1px solid #d1dce5;border-radius:var(--radius);padding:var(--padding);min-height:150px;max-height:300px;overflow-y:auto;"></div>
      <div style="display:flex;gap:.5rem;margin-top:.5rem;">
        <input id="chatInput" placeholder="What’s good for menstrual cramps?" aria-label="Type your question"/>
        <button id="sendChat" aria-label="Send message"><i class="fas fa-paper-plane"></i></button>
      </div>
      <div id="chatHint" class="hint" hidden>Bot is thinking… <span class="spinner"></span></div>
    </section>

    <!-- 6. Personalized Formulations -->
    <section id="formulations" class="module">
      <h2><i class="fas fa-user-shield"></i> Personalized Formulations</h2>
      <p class="desc">Pick herbs, age & weight for a custom blend.</p>
      <form id="pf-form">
        <select id="pfHerbs" multiple size="5" aria-label="Select herbs">
          <option>Ashwagandha</option><option>Astragalus</option><option>Basil</option><option>Chamomile</option>
          <option>Echinacea</option><option>Ginkgo Biloba</option><option>Ginseng</option><option>Lavender</option>
          <option>Licorice</option><option>Milk Thistle</option><option>Neem</option><option>Oregano</option>
          <option>Peppermint</option><option>Rosemary</option><option>St. John’s Wort</option><option>Turmeric</option>
          <option>Valerian</option><option>Holy Basil</option><option>Green Tea</option><option>Aloe Vera</option>
        </select>
        <input id="pfAge" type="number" min="1" max="120" placeholder="Age (years)" aria-label="Age" required/>
        <input id="pfWeight" type="number" min="10" max="300" placeholder="Weight (kg)" aria-label="Weight" required/>
        <button type="submit">Generate</button>
        <div class="hint">Hold Ctrl/Cmd to select multiple herbs.</div>
      </form>
      <div id="pfResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
        <p class="hint"><em>Formulation meets dosage safety limits.</em></p>
      </div>
    </section>

    <!-- 7. Research Summaries -->
    <section id="research" class="module">
      <h2><i class="fas fa-book-reader"></i> Research Summaries</h2>
      <p class="desc">Paste study titles or keywords for a concise summary.</p>
      <form id="research-form">
        <input id="researchQuery" placeholder="e.g. ‘Ashwagandha anxiety RCT’" aria-label="Research query" required/>
        <button type="submit">Summarize</button>
        <div class="hint">Include herb and focus area.</div>
      </form>
      <div id="researchResults" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
        <a href="#" target="_blank">Read Original Study</a>
      </div>
    </section>

    <!-- 8. Inventory Forecast -->
    <section id="inventory" class="module">
      <h2><i class="fas fa-warehouse"></i> Inventory Forecast</h2>
      <p class="desc">Predict stock needs weeks ahead.</p>
      <form id="inventory-form">
        <select id="forecastHerb" aria-label="Select herb for forecast">
          <option>Turmeric</option><option>Ginkgo Biloba</option><option>Ashwagandha</option><option>Echinacea</option>
          <option>Valerian</option><option>Chamomile</option><option>Lavender</option><option>Basil</option>
        </select>
        <input id="forecastPeriod" type="number" min="1" max="52" value="4" placeholder="Weeks ahead" aria-label="Forecast period"/>
        <button type="submit">Forecast</button>
        <div class="hint">Choose 1–52 weeks into the future.</div>
      </form>
      <div id="inventoryResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
      </div>
    </section>

    <!-- 9. Genetics Match -->
    <section id="genetics" class="module">
      <h2><i class="fas fa-dna"></i> Genetics Match</h2>
      <p class="desc">Upload your genetic report for tailored herb recommendations.</p>
      <form id="genetics-form">
        <input id="geneticUpload" type="file" accept=".csv,.json" aria-label="Upload genetic report"/>
        <button type="submit">Analyze</button>
        <div class="hint">CSV or JSON with SNP data is ideal.</div>
      </form>
      <div id="geneticResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
        <p class="hint"><em>Tier 1: evidence-based, Tier 2: emerging science.</em></p>
      </div>
    </section>

    <!-- 10. Dosage Calculator -->
    <section id="dosage" class="module">
      <h2><i class="fas fa-calculator"></i> Dosage Calculator</h2>
      <p class="desc">Get daily dosage advice based on weight, symptom, and extract form.</p>
      <form id="dose-form">
        <input id="weight" type="number" min="10" max="300" placeholder="Weight (kg)" aria-label="Weight" required/>
        <input id="symptom" placeholder="Symptom (e.g. headache)" aria-label="Symptom" required/>
        <select id="formType" aria-label="Select extract type">
          <option value="powder">Powder</option>
          <option value="tincture">Tincture</option>
          <option value="capsule">Capsule</option>
        </select>
        <button type="submit">Calculate</button>
        <div class="hint">Specify extract form for accuracy.</div>
      </form>
      <div id="dosageResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <div class="result-content"></div>
      </div>
    </section>

    <!-- 11. Interaction Checker -->
    <section id="interaction" class="module">
      <h2><i class="fas fa-exchange-alt"></i> Interaction Checker</h2>
      <p class="desc">Select two herbs to check for interactions.</p>
      <form id="int-form">
        <select id="herbA" aria-label="Herb A">
          <option>Turmeric</option><option>Ashwagandha</option><option>Ginkgo Biloba</option><option>St. John’s Wort</option>
        </select>
        <select id="herbB" aria-label="Herb B">
          <option>Turmeric</option><option>Ashwagandha</option><option>Ginkgo Biloba</option><option>St. John’s Wort</option>
        </select>
        <button type="submit">Check</button>
        <div class="hint">Pick two distinct herbs.</div>
      </form>
      <div id="interactionResult" class="response" role="status" hidden>
        <button class="close-btn" aria-label="Close result">×</button>
        <p><strong>Mild Interaction:</strong> St. John’s Wort may reduce efficacy of certain drugs.</p>
      </div>
    </section>

    <!-- ADD-ONS -->
    <section id="addons" class="module">
      <h2><i class="fas fa-plus-circle"></i> Additional Features</h2>
      <ul>
        <li><strong>User Login/Signup</strong> to save herb history & personalized plans.</li>
        <li><strong>Weekly AI-Generated Blog</strong> on herbal insights.</li>
        <li><strong>Voice Assistant</strong> for elderly users (click-to-talk).</li>
      </ul>
    </section>

    <!-- ROI CALCULATOR -->
   <section id="roi" class="module">
  <h2><i class="fas fa-dollar-sign"></i> Business Insights & ROI Calculator</h2>
  <p class="desc">
    Estimate your practice’s return on investment from AI-driven herbal prescription automation.
    Select your currency, enter your monthly prescription volume and herb costs, then calculate ROI.
  </p>
  <form id="roi-form">
    <div class="field">
      <label for="currency">Currency</label>
      <select id="currency">
        <option value="GHS" selected>Ghanaian Cedi (GHS)</option>
        <option value="USD">US Dollar (USD)</option>
        <option value="EUR">Euro (EUR)</option>
      </select>
    </div>
    <div class="field">
      <label for="roiRx">Monthly Prescriptions</label>
      <input type="number" id="roiRx" required placeholder="e.g. 100"/>
    </div>
    <div class="field">
      <label for="roiCost">Avg. Herb Cost (<span id="curSym">₵</span>)</label>
      <input type="number" id="roiCost" required placeholder="e.g. 25"/>
    </div>
    <button type="submit">Calculate ROI</button>
  </form>
  <div id="roiResult" class="response" hidden>
    <button class="close-btn">×</button>
    <div class="result-content"></div>
  </div>
</section>
    <!-- ARCHITECTURE / TECH -->
    <section id="about" class="module">
      <h2><i class="fas fa-cogs"></i> Architecture & Data Flow</h2>
      <p class="desc">High-level overview of our AI platform components.</p>
      <img src="path/to/architecture.svg" alt="System Architecture Diagram" style="width:100%;border-radius:var(--radius);margin-bottom:1rem;"/>
      <ol>
        <li>Client (Browser/Mobile)</li>
        <li>API Gateway</li>
        <li>AI Microservices (Diagnostics, ID, Chat)</li>
        <li>Data Lake (Herb DB, Clinical Studies, Genetics)</li>
        <li>Analytics Engine</li>
        <li>Admin Dashboard</li>
      </ol>
      <p><a href="#privacy">Privacy Policy</a> | <a href="#terms">Terms of Use</a></p>
    </section>

    <!-- CONTACT & DISCLAIMER -->
    <section id="contact" class="module">
      <h2><i class="fas fa-envelope"></i> Contact & Compliance</h2>
      <p class="desc">For partnerships, audits, or support.</p>
      <form id="contact-form">
        <input type="email" placeholder="Your email" required aria-label="Email"/>
        <textarea placeholder="Message" rows="3" required aria-label="Message"></textarea>
        <button type="submit">Send</button>
      </form>
      <p class="hint" style="margin-top:1rem;">
        <strong>Disclaimer:</strong> For informational purposes only; consult a professional.<br/>
        Genetic data is handled per our <a href="#privacy">Privacy Policy</a>.
      </p>
    </section>

    <!-- FOOTER -->
  <footer>
    <p>&copy; 2025 Vitra AI. <a href="#privacy">Privacy Policy</a> | <a href="#terms">Terms & Conditions</a></p>
  </footer>
    
  </main>

  

  <!-- JAVASCRIPT LOGIC -->
<script>
  // define this before the modal’s markup
  function onboardClose() {
    document.getElementById('onboardModal').style.display = 'none';
  }
</script>
  
<script>
  //───────────────── CONFIG & HELPERS ──────────────────

  async function callOpenAI(messages) {
    const res = await fetch('/.netlify/functions/openai-proxy', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ messages })
    });
    if (!res.ok) throw new Error(await res.text() || 'Server error');
    const data = await res.json();
    return data.choices[0].message.content.trim();
  }

  async function callVision(file) {
    const fd = new FormData();
    fd.append('file', file);
    const res = await fetch('/.netlify/functions/openai-proxy', {
      method: 'POST',
      body: fd
    });
    if (!res.ok) throw new Error(await res.text() || 'Vision API error');
    return res.json();
  }

  function stripMarkdown(text) {
    return text.replace(/^###\s+/gm, '');
  }

  function renderAI(text, container) {
    container.innerHTML = stripMarkdown(text)
      .replace(/```([\s\S]+?)```/g, '<pre><code>$1</code></pre>')
      .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
      .replace(/\*(.+?)\*/g, '<em>$1</em>');
  }

  function showError(panel, msg) {
    panel.querySelector('.result-content').textContent = '⚠️ ' + msg;
  }

  //───────────────── CHARTS & EXPORT ──────────────────

  function initCharts() {
    const dataAdopt = { labels:['Jan','Feb','Mar'], datasets:[{ data:[50,75,100] }] };
    const dataEff   = { labels:['Mild','Moderate','High'], datasets:[{ data:[30,45,25] }] };
    const dataSupp  = { labels:['Herb A','Herb B','Herb C'], datasets:[{ data:[200,150,300] }] };
    const dataROI   = { labels:['Q1','Q2','Q3','Q4'], datasets:[{ data:[5,7,6,8] }] };

    new Chart('chartAdoption', { type:'line', data:dataAdopt, options:{ responsive:true } });
    new Chart('chartEfficacy',  { type:'bar',  data:dataEff,   options:{ responsive:true } });
    new Chart('chartSupply',    { type:'pie',  data:dataSupp,  options:{ responsive:true } });
    new Chart('chartROI',       { type:'radar',data:dataROI,  options:{ responsive:true } });
  }

  function exportAnalytics() {
    const charts = [
      { id:'chartAdoption', name:'Adoption Metrics' },
      { id:'chartEfficacy',  name:'Efficacy Outcomes' },
      { id:'chartSupply',    name:'Supply Impact' },
      { id:'chartROI',       name:'Financial ROI' }
    ];
    let lines = [];
    charts.forEach(({id,name}) => {
      const ch = Chart.getChart(id);
      ch.data.datasets.forEach(ds => {
        lines.push([name, ds.label||'', ...ds.data].join(','));
      });
      lines.push('');
    });
    const blob = new Blob([lines.join('\n')], { type:'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'full_analytics.csv';
    a.click(); URL.revokeObjectURL(url);
  }

  //───────────────── PLANT SCANNER ──────────────────

  function previewImage(input) {
    const img = document.getElementById('idenPreview');
    let btn = document.getElementById('removePreview');
    if (input.files[0]) {
      const reader = new FileReader();
      reader.onload = e => {
        img.src = e.target.result;
        img.style.display = 'block';
        if (!btn) {
          btn = document.createElement('button');
          btn.id = 'removePreview';
          btn.type = 'button';
          btn.textContent = 'Remove Image';
          btn.onclick = () => {
            img.style.display = 'none';
            input.value = '';
            btn.remove();
          };
          input.after(btn);
        }
      };
      reader.readAsDataURL(input.files[0]);
    }
  }

  document.getElementById('iden-form').onsubmit = async e => {
    e.preventDefault();
    const panel = document.getElementById('idenResult');
    panel.hidden = false;
    panel.innerHTML = '<button class="close-btn">×</button><div class="result-content">Processing… <span class="spinner"></span></div>';
    panel.querySelector('.close-btn').onclick = () => panel.hidden = true;

    const file = e.target.querySelector('input[type=file]').files[0];
    const desc = document.getElementById('idenDesc').value.trim();
    if (!file && !desc) return showError(panel, 'Please upload an image or enter a description.');

    let reply = '';
    try {
      if (file) {
        const data = await callVision(file);
        if (data.name) {
          reply += `
            <strong>Scientific Name:</strong> ${data.name}<br/>
            <strong>Uses:</strong> ${data.uses}<br/>
            <strong>Cautions:</strong> ${data.cautions}<br/>
            <strong>Regions:</strong> ${data.regions.join(', ')}<br/><hr/>
          `;
        } else {
          reply += (data.description || 'No vision output.') + '<hr/>';
        }
      }
      if (desc) {
        const textReply = await callOpenAI([
          { role:'system', content:'You are a plant expert.' },
          { role:'user', content:`Describe plant from text: ${desc}` }
        ]);
        reply += textReply;
      }
      panel.querySelector('.result-content').innerHTML = reply;
      addResponseTools(panel);
    } catch(err) {
      showError(panel, err.message);
    }
  };

  //───────────────── SYMPTOM CHECKER ──────────────────

  document.querySelectorAll('#sym-form .tag').forEach(btn =>
    btn.addEventListener('click', ()=> btn.classList.toggle('selected'))
  );
  const severity = document.getElementById('severity');
  const sevVal = document.getElementById('sevValue');
  severity.addEventListener('input', ()=> sevVal.textContent = severity.value);

  document.getElementById('sym-form').onsubmit = async e => {
    e.preventDefault();
    const panel = document.getElementById('symResult');
    panel.hidden = false;
    panel.querySelector('.conf-fill').style.width = '0%';
    panel.querySelector('.conf-percent').textContent = '0%';
    panel.querySelector('.herb-cards').innerHTML = '';

    const text = document.getElementById('symInput').value;
    const cats = [...document.querySelectorAll('#sym-form .tag.selected')].map(t=>t.dataset.cat);
    const dur = document.getElementById('symDuration')?.value || 'unknown';
    const confPrompt = `Symptoms: ${text}; Categories: ${cats.join(',')}; Duration: ${dur} days; Severity: ${severity.value}`;

    try {
      const reply = await callOpenAI([
        { role:'system', content: `You are a herbal diagnostician. Output JSON: [{"name":"","evidence":"","conf":0,"uses":""},…]` },
        { role:'user', content: confPrompt }
      ]);
      const recs = JSON.parse(reply);
      recs.forEach((h,i) => {
        if (i===0) setTimeout(() => {
          panel.querySelector('.conf-fill').style.width = h.conf+'%';
          panel.querySelector('.conf-percent').textContent = h.conf+'%';
        }, 200);
        const card = document.createElement('div');
        card.className = 'herb-card';
        card.innerHTML = `
          <h4>${h.name}</h4>
          <span class="evidence-badge ${h.evidence}">
            ${h.evidence==='well'?'Well-studied':'Anecdotal'}
          </span>
          <p>${h.uses}</p>
        `;
        panel.querySelector('.herb-cards').append(card);
      });
      addResponseTools(panel);
    } catch(err) {
      panel.querySelector('.herb-cards').textContent = '⚠️ ' + err.message;
    }
  };

  //───────────────── CULTURAL KNOWLEDGE ──────────────────

  async function getCulture() {
    const q = document.getElementById('cultureQuery').value.trim();
    const panel = document.getElementById('cultureResult');
    panel.hidden = false;
    panel.innerHTML = '<button class="close-btn">×</button><div class="result-content">Loading…</div>';
    panel.querySelector('.close-btn').onclick = () => panel.hidden = true;
    try {
      const reply = await callOpenAI([
        { role:'system', content:'You are a cultural herbalist.' },
        { role:'user', content:`Region query: ${q}` }
      ]);
      renderAI(reply, panel.querySelector('.result-content'));
      addResponseTools(panel);
    } catch(err) {
      showError(panel, err.message);
    }
  }

  //───────────────── CHATBOT ──────────────────

  function appendChat(who, html) {
    const box = document.getElementById('chatBox');
    const div = document.createElement('div');
    div.className = who === 'user' ? 'user-msg' : 'bot-msg';
    div.innerHTML = html + `<div class="timestamp">${new Date().toLocaleTimeString()}</div>`;
    box.append(div);
    box.scrollTop = box.scrollHeight;
  }

  document.getElementById('sendChat').onclick = async () => {
    const input = document.getElementById('chatInput');
    const txt = input.value.trim();
    if (!txt) return;
    appendChat('user', txt);
    input.value = '';
    const hint = document.getElementById('chatHint');
    hint.hidden = false;

    try {
      const reply = await callOpenAI([
        { role:'system', content:'You are a friendly herbalist.' },
        { role:'user', content: txt }
      ]);
      appendChat('bot', stripMarkdown(reply).replace(/\n/g,'<br/>'));
    } catch(err) {
      appendChat('bot', '⚠️ ' + err.message);
    } finally {
      document.getElementById('chatHint').hidden = true;
    }
  };
document.getElementById('closeChat').onclick = () => document.getElementById('hero-chat').hidden = true;
document.getElementById('viewHistory').onclick = () => showHistory();    // implement modal or side-panel
document.getElementById('clearChat').onclick = () => {
  document.getElementById('chatBox').innerHTML = '';
};
  //───────────────── GENETICS & ROI ──────────────────

  document.getElementById('genetics-form').onsubmit = async e => {
    e.preventDefault();
    const panel = document.getElementById('geneticResult');
    const file = document.getElementById('geneticUpload').files[0];
    if (!file) {
      panel.hidden = false;
      return showError(panel, 'Please upload a CSV or JSON.');
    }
    panel.hidden = false;
    panel.querySelector('.result-content').textContent = 'Processing…';
    try {
      const text = await file.text();
      const reply = await callOpenAI([
        { role:'system', content:'You interpret genetic SNP data for herb recommendations.' },
        { role:'user', content: text }
      ]);
      renderAI(reply, panel.querySelector('.result-content'));
      addResponseTools(panel);
    } catch(err) {
      showError(panel, err.message);
    }
  };

  document.getElementById('roi-form').onsubmit = e => {
    e.preventDefault();
    const panel = document.getElementById('roiResult');
    const rx   = +document.getElementById('roiRx').value;
    const cost = +document.getElementById('roiCost').value;
    const inc  = +prompt('Income per prescription?','100');
    const totalInc  = rx * inc;
    const totalCost = rx * cost;
    const net       = totalInc - totalCost;
    const roiPct    = ((net / totalCost) * 100).toFixed(2);

    panel.hidden = false;
    panel.querySelector('.result-content').innerHTML = `
      <p><strong>Prescriptions:</strong> ${rx}</p>
      <p><strong>Income per Rx:</strong> $${inc}</p>
      <p><strong>Total Income:</strong> $${totalInc}</p>
      <p><strong>Total Cost:</strong> $${totalCost}</p>
      <p><strong>Net Profit:</strong> $${net}</p>
      <p><strong>ROI:</strong> ${roiPct}%</p>
    `;
    addResponseTools(panel);
  };
document.getElementById('currency').onchange = e => {
  const sym = { GHS: '₵', USD: '$', EUR: '€' }[e.target.value];
  document.getElementById('curSym').textContent = sym;
};
  //───────────────── COPY & DOWNLOAD TOOLBAR ──────────────────

  function addResponseTools(panel) {
    if (panel.querySelector('.copy-btn')) return;
    const toolbar = document.createElement('div');
    toolbar.style.position = 'absolute';
    toolbar.style.top = '0.5rem';
    toolbar.style.right = '2.5rem';
    toolbar.innerHTML = `
      <button class="copy-btn" title="Copy"><i class="fas fa-copy"></i></button>
      <button class="dl-btn"   title="Download"><i class="fas fa-download"></i></button>
    `;
    panel.append(toolbar);
    toolbar.querySelector('.copy-btn').onclick = () => {
      navigator.clipboard.writeText(panel.querySelector('.result-content').innerText);
    };
    toolbar.querySelector('.dl-btn').onclick = () => {
      const text = panel.querySelector('.result-content').innerText;
      const blob = new Blob([text], { type:'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'response.txt';
      a.click(); URL.revokeObjectURL(url);
    };
  }

  //───────────────── DARK MODE & SIDEBAR ──────────────────

  document.getElementById('themeToggle').onclick = () => {
    document.documentElement.classList.toggle('dark');
    const ico = document.getElementById('themeToggle');
    ico.classList.toggle('fa-moon'); ico.classList.toggle('fa-sun');
  };

  document.getElementById('shrinkBtn').onclick = () => {
    document.getElementById('sidebar').classList.toggle('collapsed');
    const i = document.querySelector('#shrinkBtn i');
    i.classList.toggle('fa-angle-double-left'); i.classList.toggle('fa-angle-double-right');
  };

  document.getElementById('hamburger').onclick = () => {
    document.getElementById('sidebar').classList.toggle('open');
  };

  //───────────────── GENERIC FORM WIRING & STARTUP ──────────────────

  function wireForm(id, prompt, extract, outId) {
    document.getElementById(id).onsubmit = async e => {
      e.preventDefault();
      const panel = document.getElementById(outId);
      panel.hidden = false;
      panel.innerHTML = '<button class="close-btn">×</button><div class="result-content">Processing…</div>';
      panel.querySelector('.close-btn').onclick = () => panel.hidden = true;
      try {
        const rep = await callOpenAI([
          { role:'system', content: prompt },
          { role:'user',   content: extract() }
        ]);
        renderAI(rep, panel.querySelector('.result-content'));
        addResponseTools(panel);
      } catch(err) {
        showError(panel, err.message);
      }
    };
  }

  document.addEventListener('DOMContentLoaded', () => {
    initCharts();
    document.querySelector('button[onclick="exportAnalytics()"]').onclick = exportAnalytics;
    wireForm('pf-form',
      'You are an expert at formulating personalized herbal blends with dosage safety.',
      () => {
        const h = [...document.getElementById('pfHerbs').selectedOptions].map(o=>o.value).join(', ');
        const a = document.getElementById('pfAge').value;
        const w = document.getElementById('pfWeight').value;
        return `Herbs: ${h}; Age: ${a}; Weight: ${w}kg`;
      }, 'pfResult'
    );
    wireForm('research-form',
      'You summarize clinical research findings with citations.',
      () => document.getElementById('researchQuery').value, 'researchResults'
    );
    wireForm('inventory-form',
      'You forecast weekly herb demand with trends & buffer stock.',
      () => `Herb: ${document.getElementById('forecastHerb').value}; Weeks ahead: ${document.getElementById('forecastPeriod').value}`, 'inventoryResult'
    );
    wireForm('int-form',
      'You check interactions between two herbs with severity descriptions.',
      () => {
        const a=document.getElementById('herbA').value, b=document.getElementById('herbB').value;
        if(a===b) throw new Error('Pick two distinct herbs.');
        return `${a} & ${b}`;
      }, 'interactionResult'
    );
    wireForm('safety-form',
      'You warn of dangerous combinations between herbs & meds, color-coded.',
      () => {
        const a=document.getElementById('safetyA').value, b=document.getElementById('safetyB').value;
        if(a===b) throw new Error('Pick two distinct items.');
        return `${a} & ${b}`;
      }, 'safetyResult'
    );
    wireForm('dose-form',
      'You calculate daily herbal dosages based on weight, symptom, extract.',
      () => `Weight:${document.getElementById('weight').value}kg; Symptom:${document.getElementById('symptom').value}; Form:${document.getElementById('formType').value}`, 'dosageResult'
    );
    // Culture button
    document.querySelector('#hero–cultural button').onclick = getCulture;
  });
</script>
</body>
</html>
